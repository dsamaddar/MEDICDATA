USE [WEBMEDIC]
GO
/****** Object:  UserDefinedFunction [dbo].[GetMonthName]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<RASIK JOSHI>
-- Create date: <07 July 2019>
-- Description:	<omtechsoft.com>
-- =============================================
CREATE FUNCTION [dbo].[GetMonthName]
(
	@Month int
)
RETURNS Nvarchar(100)
AS
BEGIN
	Declare @MonthName Nvarchar(100)
	SELECT  @MonthName= CASE @Month
            WHEN 1 THEN 'January'
            WHEN 2 THEN 'February'
            WHEN 3 THEN 'March'
            WHEN 4 THEN 'April'
            WHEN 5 THEN 'May'
            WHEN 6 THEN 'June'
            WHEN 7 THEN 'July'
            WHEN 8 THEN 'August'
            WHEN 9 THEN 'September'
            WHEN 10 THEN 'October'
            WHEN 11 THEN 'November'
            WHEN 12 THEN 'December' 
            ELSE ''
            END 
			
	RETURN @MonthName

END
GO
/****** Object:  Table [dbo].[MonthDays31]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[MonthDays31](
	[SrNo] [bigint] IDENTITY(1,1) NOT NULL,
	[RecId] [bigint] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[CaseDetail]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CaseDetail](
	[RecId] [bigint] IDENTITY(1,1) NOT NULL,
	[ServiceId] [bigint] NULL,
	[HType] [int] NULL,
	[CaseType] [int] NULL,
	[Gender] [int] NULL,
	[CMonth] [int] NULL,
	[CYear] [int] NULL,
	[StateId] [bigint] NULL,
	[Date1] [int] NULL,
	[Date2] [int] NULL,
	[Date3] [int] NULL,
	[Date4] [int] NULL,
	[Date5] [int] NULL,
	[Date6] [int] NULL,
	[Date7] [int] NULL,
	[Date8] [int] NULL,
	[Date9] [int] NULL,
	[Date10] [int] NULL,
	[Date11] [int] NULL,
	[Date12] [int] NULL,
	[Date13] [int] NULL,
	[Date14] [int] NULL,
	[Date15] [int] NULL,
	[Date16] [int] NULL,
	[Date17] [int] NULL,
	[Date18] [int] NULL,
	[Date19] [int] NULL,
	[Date20] [int] NULL,
	[Date21] [int] NULL,
	[Date22] [int] NULL,
	[Date23] [int] NULL,
	[Date24] [int] NULL,
	[Date25] [int] NULL,
	[Date26] [int] NULL,
	[Date27] [int] NULL,
	[Date28] [int] NULL,
	[Date29] [int] NULL,
	[Date30] [int] NULL,
	[Date31] [int] NULL,
	[CreatedBy] [bigint] NULL,
	[CreateDate] [datetime] NULL,
	[CompanyId] [bigint] NULL,
	[Machine] [nvarchar](120) NULL,
	[RefRecId] [bigint] NULL
) ON [PRIMARY]
GO
/****** Object:  View [dbo].[CaseDetailDateWise]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


CREATE VIEW [dbo].[CaseDetailDateWise]
AS
SELECT 
	ServiceId, 
	HType, 
	CaseType, 
	Gender, 
	CMonth, 
	CYear, 
	StateId, 
	CreatedBy, 
	CreateDate, 
	CompanyId, 
	Machine, 
	RefRecId,	
	G.SrNo AS CDay,
	CAST(CAST(CD.CYear AS varchar) + '-' + CAST(CD.CMonth AS varchar) + '-' + CAST(G.SrNo AS varchar) AS DATETIME) AS DateVal,
	(CASE G.SrNo WHEN 1 THEN Date1 
	WHEN 2 THEN Date2
	WHEN 3 THEN Date3 
	WHEN 4 THEN Date4 
	WHEN 5 THEN Date5 
	WHEN 6 THEN Date6 
	WHEN 7 THEN Date7 
	WHEN 8 THEN Date8 
	WHEN 9 THEN Date9 
	WHEN 10 THEN Date10
	WHEN 11 THEN Date11 
	WHEN 12 THEN Date12 
	WHEN 13 THEN Date13 
	WHEN 14 THEN Date14 
	WHEN 15 THEN Date15 
	WHEN 16 THEN Date16 
	WHEN 17 THEN Date17 
	WHEN 18 THEN Date18 
	WHEN 19 THEN Date19 
	WHEN 20 THEN Date20 
	WHEN 21 THEN Date21 
	WHEN 22 THEN Date22 
	WHEN 23 THEN Date23 
	WHEN 24 THEN Date24 
	WHEN 25 THEN Date25 
	WHEN 26 THEN Date26 
	WHEN 27 THEN Date27 
	WHEN 28 THEN Date28 
	WHEN 29 THEN Date29 
	WHEN 30 THEN Date30 
	WHEN 31 THEN Date31 ELSE 0 END) AS DayVal	
FROM dbo.CaseDetail AS CD
CROSS APPLY [dbo].[MonthDays31] as g
GO
/****** Object:  UserDefinedFunction [dbo].[Fn_GetMonthDates]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
-- SELECT * FROM dbo.Fn_GetMonthDates('2020/02/01','2020/02/29')
CREATE FUNCTION [dbo].[Fn_GetMonthDates]
(	
@StartDate DATETIME, 
@EndDate DATETIME
)
RETURNS TABLE 
AS
RETURN 
(
	SELECT DATEADD(DAY,NBR - 1, @StartDate) AS DateVal
	FROM
	(
		SELECT ROW_NUMBER() OVER (ORDER BY C.object_id) AS NBR
		FROM sys.columns C
	) AS NBRS
	WHERE NBR - 1 <= DATEDIFF(DAY, @StartDate, @EndDate)
)
GO
/****** Object:  UserDefinedFunction [dbo].[fn_CaseDetailDateWise]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
-- SELECT * FROM dbo.fn_CaseDetailDateWise('2019/01/01','2019/12/31')
CREATE FUNCTION [dbo].[fn_CaseDetailDateWise]
(	
@StartDate DATETIME, 
@EndDate DATETIME
)
RETURNS TABLE 
AS
RETURN 
(
	SELECT CD.RecId
		  ,CD.ServiceId
		  ,CD.HType
		  ,CD.CaseType
		  ,CD.Gender
		  ,CD.CMonth
		  ,CD.CYear
		  ,CD.StateId
		  ,CD.CreatedBy
		  ,CD.CreateDate
		  ,CD.CompanyId
		  ,CD.Machine
		  ,CD.RefRecId
		  ,G.DateVal AS DateVal
		  ,(CASE DAY(G.DateVal)
			WHEN 1 THEN CD.Date1
			WHEN 2 THEN CD.Date2
			WHEN 3 THEN CD.Date3
			WHEN 4 THEN CD.Date4
			WHEN 5 THEN CD.Date5
			WHEN 6 THEN CD.Date6
			WHEN 7 THEN CD.Date7
			WHEN 8 THEN CD.Date8
			WHEN 9 THEN CD.Date9
			WHEN 10 THEN CD.Date10
			WHEN 11 THEN CD.Date11
			WHEN 12 THEN CD.Date12
			WHEN 13 THEN CD.Date13
			WHEN 14 THEN CD.Date14
			WHEN 15 THEN CD.Date15
			WHEN 16 THEN CD.Date16
			WHEN 17 THEN CD.Date17
			WHEN 18 THEN CD.Date18
			WHEN 19 THEN CD.Date19
			WHEN 20 THEN CD.Date20
			WHEN 21 THEN CD.Date21
			WHEN 22 THEN CD.Date22
			WHEN 23 THEN CD.Date23
			WHEN 24 THEN CD.Date24
			WHEN 25 THEN CD.Date25
			WHEN 26 THEN CD.Date26
			WHEN 27 THEN CD.Date27
			WHEN 28 THEN CD.Date28
			WHEN 29 THEN CD.Date29
			WHEN 30 THEN CD.Date30
			WHEN 31 THEN CD.Date31
			ELSE 0 END) AS DayVal	
	FROM dbo.CaseDetail AS CD
	INNER JOIN dbo.Fn_GetMonthDates(@StartDate,@EndDate) AS G
	ON YEAR(G.DateVal) = CD.CYear
	AND MONTH(G.DateVal) = CD.CMonth
)
GO
/****** Object:  Table [dbo].[Blindness]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Blindness](
	[SrNo] [bigint] IDENTITY(1,1) NOT NULL,
	[RefSrNo] [bigint] NULL,
	[SERVICEID] [bigint] NULL,
	[COMPANTID] [bigint] NULL,
	[STATEID] [bigint] NULL,
	[MACHINE] [nvarchar](120) NULL,
	[CMonth] [int] NULL,
	[CYear] [int] NULL,
	[M019] [int] NULL,
	[F019] [int] NULL,
	[M2039] [int] NULL,
	[F2039] [int] NULL,
	[M4059] [int] NULL,
	[F4059] [int] NULL,
	[M6079] [int] NULL,
	[F6079] [int] NULL,
	[M80] [int] NULL,
	[F80] [nchar](10) NULL,
	[CREATEDDATE] [datetime] NULL,
	[CREATEDBY] [bigint] NULL,
	[Htype] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[BlindnessMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[BlindnessMaster](
	[SrNo] [bigint] IDENTITY(1,1) NOT NULL,
	[INTERVENSIONS] [nvarchar](500) NULL,
	[M019] [int] NULL,
	[F019] [int] NULL,
	[M2039] [int] NULL,
	[F2039] [int] NULL,
	[M4059] [int] NULL,
	[F4059] [int] NULL,
	[M6079] [int] NULL,
	[F6079] [int] NULL,
	[M80] [int] NULL,
	[F80] [nchar](10) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[CausesDetails]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CausesDetails](
	[RecId] [bigint] IDENTITY(1,1) NOT NULL,
	[Causes] [nvarchar](250) NULL,
	[IsActive] [int] NULL,
	[CreatedBy] [bigint] NULL,
	[CreateDate] [datetime] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[CompanyMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CompanyMaster](
	[RecId] [bigint] IDENTITY(1,1) NOT NULL,
	[CName] [nvarchar](100) NULL,
	[City] [nvarchar](100) NULL,
	[State] [bigint] NULL,
	[Contact] [nvarchar](50) NULL,
	[Email] [nvarchar](50) NULL,
	[CGuid] [nvarchar](50) NULL,
	[Logo] [ntext] NULL,
	[IsActive] [int] NULL,
	[CreatedBy] [bigint] NULL,
	[CreateDate] [datetime] NULL,
	[Header1] [nvarchar](500) NULL,
	[Header2] [nvarchar](500) NULL,
	[Header3] [nvarchar](500) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Deaes]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Deaes](
	[DName] [nvarchar](500) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DeathsDetails]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DeathsDetails](
	[RecId] [bigint] IDENTITY(1,1) NOT NULL,
	[Htype] [int] NULL,
	[StateId] [bigint] NULL,
	[CompanyId] [bigint] NULL,
	[Decease] [nvarchar](200) NULL,
	[Sex] [int] NULL,
	[RefNo] [nvarchar](150) NULL,
	[Age] [int] NULL,
	[Address] [nvarchar](250) NULL,
	[DOA] [datetime] NULL,
	[DOD] [datetime] NULL,
	[CausesDeath] [nvarchar](500) NULL,
	[Machine] [nvarchar](250) NULL,
	[CreatedBy] [bigint] NULL,
	[CreateDate] [datetime] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[Dental]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[Dental](
	[SrNo] [bigint] IDENTITY(1,1) NOT NULL,
	[RefSrNo] [bigint] NULL,
	[ServiceId] [bigint] NULL,
	[CompanyId] [bigint] NULL,
	[StateId] [bigint] NULL,
	[Machine] [nvarchar](120) NULL,
	[CMonth] [int] NULL,
	[CYear] [int] NULL,
	[M012] [int] NULL,
	[F012] [int] NULL,
	[M1359] [int] NULL,
	[F1359] [int] NULL,
	[M60] [int] NULL,
	[F60] [int] NULL,
	[Mtot] [int] NULL,
	[Ftot] [int] NULL,
	[CreatedBy] [bigint] NULL,
	[CreatedDate] [datetime] NULL,
	[Htype] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DentalMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DentalMaster](
	[SrNo] [bigint] IDENTITY(1,1) NOT NULL,
	[DProcedure] [nvarchar](500) NULL,
	[M012] [int] NULL,
	[F012] [int] NULL,
	[M1359] [int] NULL,
	[F1359] [int] NULL,
	[M60] [int] NULL,
	[F60] [int] NULL,
	[Mtot] [int] NULL,
	[Ftot] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[HospitalBedMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[HospitalBedMaster](
	[SrNo] [bigint] IDENTITY(1,1) NOT NULL,
	[DepartMent] [nvarchar](250) NULL,
	[Beds] [int] NULL,
	[Cradles] [int] NULL,
	[Cots] [int] NULL,
	[Incubator] [int] NULL,
	[Total] [int] NULL,
	[Admission] [int] NULL,
	[Dicharge] [int] NULL,
	[Deaths] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[HospitalBeds]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[HospitalBeds](
	[SrNo] [bigint] IDENTITY(1,1) NOT NULL,
	[RefSrNo] [bigint] NULL,
	[ServiceId] [bigint] NULL,
	[CompanyId] [bigint] NULL,
	[StateId] [bigint] NULL,
	[Machine] [nvarchar](120) NULL,
	[CMonth] [int] NULL,
	[CYear] [int] NULL,
	[Beds] [int] NULL,
	[Cradles] [int] NULL,
	[Cots] [int] NULL,
	[Incubator] [int] NULL,
	[Total] [int] NULL,
	[Admission] [int] NULL,
	[Dicharge] [int] NULL,
	[Deaths] [int] NULL,
	[CreatedDate] [datetime] NULL,
	[CreatedBy] [bigint] NULL,
	[Htype] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[IPDOutcome]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[IPDOutcome](
	[SRNO] [bigint] IDENTITY(1,1) NOT NULL,
	[RefSrNo] [bigint] NULL,
	[CompanyId] [bigint] NULL,
	[StateId] [bigint] NULL,
	[ServiceId] [bigint] NULL,
	[Machine] [nvarchar](120) NULL,
	[MALE] [int] NULL,
	[FEMALE] [int] NULL,
	[TOTAL] [numeric](18, 2) NULL,
	[CMonth] [int] NULL,
	[CYear] [int] NULL,
	[CreatedBy] [bigint] NULL,
	[CreatedDate] [datetime] NULL,
	[Htype] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[IPDOutcomeMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[IPDOutcomeMaster](
	[SRNO] [bigint] IDENTITY(1,1) NOT NULL,
	[BEDCOMPLEMENT] [nvarchar](250) NULL,
	[MALE] [int] NULL,
	[FEMALE] [int] NULL,
	[TOTAL] [numeric](18, 2) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[LiveBirthWeight]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[LiveBirthWeight](
	[SrNo] [bigint] IDENTITY(1,1) NOT NULL,
	[RefSrno] [bigint] NULL,
	[CompanyId] [bigint] NULL,
	[StateId] [bigint] NULL,
	[ServiceId] [bigint] NULL,
	[Machine] [nvarchar](120) NULL,
	[Male] [int] NULL,
	[Female] [int] NULL,
	[CMonth] [int] NULL,
	[CYear] [int] NULL,
	[CreatedBy] [bigint] NULL,
	[CreatedDate] [datetime] NULL,
	[Htype] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[LiveBirthWeightMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[LiveBirthWeightMaster](
	[SrNo] [bigint] IDENTITY(1,1) NOT NULL,
	[LiveBirthWeight] [nvarchar](500) NULL,
	[Male] [nvarchar](50) NULL,
	[Female] [nvarchar](50) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[MaternalHealth]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[MaternalHealth](
	[SerNo] [bigint] IDENTITY(1,1) NOT NULL,
	[RefSrNo] [bigint] NULL,
	[ServiceId] [bigint] NULL,
	[CompanyId] [bigint] NULL,
	[StateId] [bigint] NULL,
	[Machine] [nvarchar](120) NULL,
	[Description] [nvarchar](500) NULL,
	[CMonth] [int] NULL,
	[CYear] [int] NULL,
	[Result] [int] NULL,
	[CreatedBy] [bigint] NULL,
	[CreatedDate] [datetime] NULL,
	[Htype] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[MaternalHealthMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[MaternalHealthMaster](
	[SrNo] [bigint] IDENTITY(1,1) NOT NULL,
	[Description] [nvarchar](500) NULL,
	[Result] [int] NULL,
	[SortOrder] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[MenuMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[MenuMaster](
	[RecId] [bigint] IDENTITY(1,1) NOT NULL,
	[MenuName] [nvarchar](500) NULL,
	[MenuId] [bigint] NULL,
	[PMenuId] [bigint] NULL,
	[IsActive] [int] NULL,
	[CreatedBy] [bigint] NULL,
	[CreateDate] [datetime] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[MonthDays]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[MonthDays](
	[SrNo] [bigint] IDENTITY(1,1) NOT NULL,
	[MonthId] [int] NULL,
	[MonthTotalDays] [int] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[OTPMASTER]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[OTPMASTER](
	[RECID] [bigint] IDENTITY(1,1) NOT NULL,
	[USERID] [nvarchar](20) NULL,
	[USERNAME] [nvarchar](50) NULL,
	[OTP] [nvarchar](100) NULL,
	[MACHINENAME] [nvarchar](50) NULL,
	[ISSUCCESS] [int] NULL,
	[EMAILID] [nvarchar](70) NULL,
	[CREATEDDATE] [datetime] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[PermissionMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[PermissionMaster](
	[RecId] [bigint] IDENTITY(1,1) NOT NULL,
	[MenuId] [bigint] NULL,
	[TypeId] [bigint] NULL,
	[IsActive] [int] NULL,
	[CreatedBy] [bigint] NULL,
	[CreateDate] [datetime] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ServiceData]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ServiceData](
	[SrNo] [float] NULL,
	[ParentId] [float] NULL,
	[Code] [nvarchar](255) NULL,
	[Details] [nvarchar](2000) NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ServicesMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ServicesMaster](
	[RecId] [bigint] IDENTITY(1,1) NOT NULL,
	[GroupId] [int] NULL,
	[ParentId] [bigint] NULL,
	[ServiceName] [nvarchar](500) NULL,
	[Description] [nvarchar](500) NULL,
	[SortOrd] [int] NULL,
	[IsActive] [int] NULL,
	[CreatedBy] [bigint] NULL,
	[CreateDate] [datetime] NULL,
	[RefRecid] [bigint] NULL,
	[RefParentId] [bigint] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[ServicesMaster_Bak]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[ServicesMaster_Bak](
	[RecId] [bigint] IDENTITY(1,1) NOT NULL,
	[GroupId] [int] NULL,
	[ParentId] [bigint] NULL,
	[ServiceName] [nvarchar](500) NULL,
	[Description] [nvarchar](500) NULL,
	[SortOrd] [int] NULL,
	[IsActive] [int] NULL,
	[CreatedBy] [bigint] NULL,
	[CreateDate] [datetime] NULL,
	[RefRecid] [bigint] NULL,
	[RefParentId] [bigint] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[StateMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[StateMaster](
	[RecId] [bigint] IDENTITY(1,1) NOT NULL,
	[StateName] [nvarchar](200) NULL,
	[Description] [nvarchar](500) NULL,
	[IsActive] [int] NULL,
	[CreatedBy] [bigint] NULL,
	[CreateDate] [datetime] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[UserMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[UserMaster](
	[RecId] [bigint] IDENTITY(1,1) NOT NULL,
	[UserId] [nvarchar](50) NULL,
	[PWD] [nvarchar](50) NULL,
	[UserName] [nvarchar](100) NULL,
	[DOB] [datetime] NULL,
	[Gender] [int] NULL,
	[EmailId] [nvarchar](50) NULL,
	[Contact] [nvarchar](50) NULL,
	[Address] [nvarchar](500) NULL,
	[City] [nvarchar](50) NULL,
	[State] [bigint] NULL,
	[ZipCode] [nvarchar](10) NULL,
	[ProfilePic] [nvarchar](100) NULL,
	[UserType] [int] NULL,
	[CompanyId] [bigint] NULL,
	[IsActive] [int] NULL,
	[CreatedBy] [bigint] NULL,
	[CreateDate] [datetime] NULL
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[UserTypeMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[UserTypeMaster](
	[RecId] [bigint] IDENTITY(1,1) NOT NULL,
	[TypeName] [nvarchar](100) NULL,
	[TypeId] [bigint] NULL,
	[IsActive] [int] NULL,
	[CreatedBy] [bigint] NULL,
	[CreateDate] [datetime] NULL
) ON [PRIMARY]
GO
ALTER TABLE [dbo].[Blindness] ADD  CONSTRAINT [DF_Blindness_CREATEDDATE]  DEFAULT (getdate()) FOR [CREATEDDATE]
GO
ALTER TABLE [dbo].[CaseDetail] ADD  CONSTRAINT [DF_CaseDetail_CreateDate]  DEFAULT (getdate()) FOR [CreateDate]
GO
ALTER TABLE [dbo].[CausesDetails] ADD  CONSTRAINT [DF_CausesDetails_CreateDate]  DEFAULT (getdate()) FOR [CreateDate]
GO
ALTER TABLE [dbo].[CompanyMaster] ADD  CONSTRAINT [DF_CompanyMaster_CGuid]  DEFAULT (newid()) FOR [CGuid]
GO
ALTER TABLE [dbo].[CompanyMaster] ADD  CONSTRAINT [DF_CompanyMaster_CreateDate]  DEFAULT (getdate()) FOR [CreateDate]
GO
ALTER TABLE [dbo].[DeathsDetails] ADD  CONSTRAINT [DF_DeathsDetails_CreateDate]  DEFAULT (getdate()) FOR [CreateDate]
GO
ALTER TABLE [dbo].[Dental] ADD  CONSTRAINT [DF_Dental_CreatedDate]  DEFAULT (getdate()) FOR [CreatedDate]
GO
ALTER TABLE [dbo].[HospitalBeds] ADD  CONSTRAINT [DF_HospitalBeds_CreatedDate]  DEFAULT (getdate()) FOR [CreatedDate]
GO
ALTER TABLE [dbo].[IPDOutcome] ADD  CONSTRAINT [DF_IPDOutcome_CreatedDate]  DEFAULT (getdate()) FOR [CreatedDate]
GO
ALTER TABLE [dbo].[LiveBirthWeight] ADD  CONSTRAINT [DF_LiveBirthWeight_CreatedDate]  DEFAULT (getdate()) FOR [CreatedDate]
GO
ALTER TABLE [dbo].[MaternalHealth] ADD  CONSTRAINT [DF_MaternalHealth_CreatedDate]  DEFAULT (getdate()) FOR [CreatedDate]
GO
ALTER TABLE [dbo].[MenuMaster] ADD  CONSTRAINT [DF_MenuMaster_CreateDate]  DEFAULT (getdate()) FOR [CreateDate]
GO
ALTER TABLE [dbo].[OTPMASTER] ADD  CONSTRAINT [DF_OTPMASTER_MODIFIEDDATE]  DEFAULT (getdate()) FOR [CREATEDDATE]
GO
ALTER TABLE [dbo].[PermissionMaster] ADD  CONSTRAINT [DF_Report_CreateDate]  DEFAULT (getdate()) FOR [CreateDate]
GO
ALTER TABLE [dbo].[ServicesMaster] ADD  CONSTRAINT [DF_ServicesMaster1_CreateDate1]  DEFAULT (getdate()) FOR [CreateDate]
GO
ALTER TABLE [dbo].[ServicesMaster_Bak] ADD  CONSTRAINT [DF_ServicesMaster_CreateDate1]  DEFAULT (getdate()) FOR [CreateDate]
GO
ALTER TABLE [dbo].[StateMaster] ADD  CONSTRAINT [DF_StateMaster_CreateDate]  DEFAULT (getdate()) FOR [CreateDate]
GO
ALTER TABLE [dbo].[UserMaster] ADD  CONSTRAINT [DF_UserMaster_CreateDate]  DEFAULT (getdate()) FOR [CreateDate]
GO
ALTER TABLE [dbo].[UserTypeMaster] ADD  CONSTRAINT [DF_UserTypeMaster_CreateDate]  DEFAULT (getdate()) FOR [CreateDate]
GO
/****** Object:  StoredProcedure [dbo].[RptGetAandSComplex]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <06 August 19>
-- Description:	<omtechsoft.com>
-- =============================================
-- execute RptGetAandSComplex 7,2019,1,'',1,10,11,12,13,12
CREATE PROCEDURE [dbo].[RptGetAandSComplex]	
	@CMonth Int,
	@CYear Int,
	@StateId int,
	@ReffNo Nvarchar(100),
	@CompanyId Bigint,
	@HType Int, 
	@HType1 Int,
	@HType2 Int,
	@HType3 Int,
	@EMonth Int
AS
BEGIN
	SET NOCOUNT ON;
	Declare @CompanyName as Nvarchar(500)
	Declare @CAdd as Nvarchar(500)
	Declare @SubTitle as Nvarchar(100)
	
	SELECT @CompanyName =C.CName,@CAdd =C.City +', ' + S.StateName FROM DBO.CompanyMaster AS C
	INNER JOIN DBO.StateMaster AS S ON C.State = S.RecId 
	WHERE C.RecId = @CompanyId 	
	
	SELECT @SubTitle = 'AGE SEX DISTRIBUTION BY ADMISSION COMPLEX' + ' (' + [dbo].[GetMonthName](@CMonth) +' - '+ Convert(nvarchar(4),@CYear) + ')'
	
	;with cte as (
	SELECT 
		SM.RecId ,
		SM.ServiceName,
		(SELECT SM1.ServiceName FROM dbo.ServicesMaster AS SM1 WHERE SM1.RecId =SM.ParentId) AS PServiceName
	FROM dbo.ServicesMaster AS SM
	WHERE SM.ParentId >0 and GroupId = 4)
	
  
   SELECT 
		(ROW_NUMBER() OVER(PARTITION BY SMT.PServiceName ORDER BY SMT.RecId ASC)) as SrNo,
		@CompanyName as CompanyName,
		@CAdd AS CAdd,
		CD.ServiceId,
		SMT.ServiceName,
		SMT.PServiceName,
		SUM(CASE WHEN (CD.HType = @HType OR CD.HType = @HType1) AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS Male,
		SUM(CASE WHEN (CD.HType = @HType OR CD.HType = @HType1) AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS FeMale,
		SUM(CASE WHEN (CD.HType = @HType2 OR CD.HType = @HType3) AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS DeathMale,
		SUM(CASE WHEN (CD.HType = @HType2 OR CD.HType = @HType3) AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS DeathFeMale,
		@SubTitle as SubTitle,
		'COMPLEX' AS HType,		
		@ReffNo AS ReffNo
	FROM cte SMT
	LEFT OUTER JOIN CaseDetail AS CD
	ON SMT.RecId =CD.ServiceId 
	AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)	
	AND CD.CYear =@CYear 
	AND (CD.HType = @HType OR CD.HType = @HType1 OR CD.HType = @HType2 OR CD.HType = @HType3)
	AND CD.CompanyId =@CompanyId
	GROUP BY CD.ServiceId ,SMT.RecId,SMT.ServiceName,SMT.PServiceName 
	ORDER BY SMT.RecId   	
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetAandSGeneral]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <06 August 19>
-- Description:	<omtechsoft.com>
-- =============================================
-- Execute RptGetAandSGeneral 7,2019,1,'',1,10,13,12
CREATE PROCEDURE [dbo].[RptGetAandSGeneral]	
	@CMonth Int,
	@CYear Int,
	@StateId int,
	@ReffNo Nvarchar(100),
	@CompanyId Bigint,
	@HType Int, 
	@HType1 Int,
	@EMonth Int
AS
BEGIN
	SET NOCOUNT ON;
	Declare @CompanyName as Nvarchar(500)
	Declare @CAdd as Nvarchar(500)
	Declare @SubTitle as Nvarchar(100)
	
	SELECT @CompanyName =C.CName,@CAdd =C.City +', ' + S.StateName FROM DBO.CompanyMaster AS C
	INNER JOIN DBO.StateMaster AS S ON C.State = S.RecId 
	WHERE C.RecId = @CompanyId 	
	
	select @SubTitle = CASE WHEN @HType = 10 THEN 'AGE SEX DISTRIBUTION BY ADMISSION GENERAL' WHEN @HType = 12 THEN  'AGE SEX DISTRIBUTION BY ADMISSION MCC' ELSE '' END + ' (' + [dbo].[GetMonthName](@CMonth) +' - '+ Convert(nvarchar(4),@CYear) + ')'
	;with cte as (
	SELECT 
		SM.RecId ,
		SM.ServiceName,
		(SELECT SM1.ServiceName FROM dbo.ServicesMaster AS SM1 WHERE SM1.RecId =SM.ParentId) AS PServiceName
	FROM dbo.ServicesMaster AS SM
	WHERE SM.ParentId >0 and GroupId = 4)
	
  
   SELECT 
		(ROW_NUMBER() OVER(PARTITION BY SMT.PServiceName ORDER BY SMT.RecId ASC)) as SrNo,
		@CompanyName as CompanyName,
		@CAdd AS CAdd,
		CD.ServiceId,
		SMT.ServiceName,
		SMT.PServiceName,
		SUM(CASE WHEN CD.HType = @HType AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS Male,
		SUM(CASE WHEN CD.HType = @HType AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS FeMale,
		SUM(CASE WHEN CD.HType = @HType1 AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS DeathMale,
		SUM(CASE WHEN CD.HType = @HType1 AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS DeathFeMale,
		@SubTitle as SubTitle,
		(CASE WHEN @HType=10 THEN 'GENERAL' WHEN @HType=12 THEN 'MCC' WHEN @HType1=14 THEN 'COMPLEX' ELSE '' END) AS HType,		
		@ReffNo AS ReffNo
	FROM cte SMT
	LEFT OUTER JOIN CaseDetail AS CD
	ON SMT.RecId =CD.ServiceId 
	AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
	AND CD.CYear =@CYear 
	AND (CD.HType = @HType OR CD.HType = @HType1)
	AND CD.CompanyId =@CompanyId
	GROUP BY CD.ServiceId ,SMT.RecId,SMT.ServiceName,SMT.PServiceName 
	ORDER BY SMT.RecId

END
GO
/****** Object:  StoredProcedure [dbo].[RptGetAllHosptBEDS]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <04 OCt 2019>
-- Description:	<Get All Data For Report.>
-- =============================================
-- Execute RptGetAllHosptBEDS 1,1,'OMIT-1-PC',12,2019,152,'',12
CREATE PROCEDURE [dbo].[RptGetAllHosptBEDS]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int,
	@RefNum nvarchar(20),
	@EMonth int
AS
BEGIN
	DECLARE @DayCount AS INT
	SELECT @DayCount = SUM(MonthTotalDays)
	FROM dbo.MonthDays
	WHERE MonthId >= @CMonth
	AND MonthId <= @EMonth
	
	IF(@Htype=152) 
    BEGIN
		SELECT HM.SrNo As RecId
			,8 AS SMRecId
			,HM.DepartMent As ServiceName
			,SUM(HB.Beds) AS Beds
			,SUM(HB.Cradles) AS Cradles
			,SUM(HB.Cots) AS Cots 
			,SUM(HB.Incubator) AS Incubator
			,(isnull(sum(HM.Beds),0) + isnull(sum(HM.Cradles),0) + isnull(sum(HM.Cots),0) + isnull(sum(HM.Incubator),0)) AS Total
			,SUM(HB.Admission) AS Admission
			,SUM(HB.Dicharge) AS Dicharge
			,SUM(HB.Deaths) AS Deaths
			,@RefNum As RefNum
			,(Case When @Htype=150 Then 'ALLOCATION OF HOSPITAL BEDS GENERAL' When @Htype=151 Then 'ALLOCATION OF HOSPITAL BEDS MCC' When @Htype=152 Then 'ALLOCATION OF HOSPITAL BEDS COMPLEX' Else '' End) AS RptTitle
			,@DayCount AS DayCount
		FROM HospitalBedMaster AS HM
		LEFT OUTER JOIN dbo.HospitalBeds   AS HB
		ON HB.RefSrNo = HM.SrNo 
		AND (HB.CompanyId = @CompanyId)
		--And (HB.StateId = @StateId)
		--And (HB.Machine = @Machine)
		AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
		And (HB.CYear = @CYear)
		AND (HM.DepartMent<>'TOTAL')
		AND ((@Htype=152 AND (Htype=150 OR Htype=151))OR (Htype=@Htype))
		GROUP BY HM.SrNo,HM.DepartMent, CMonth ,CYear ,RefSrNo 
        UNION ALL
		SELECT 8 AS RecId
			,0 AS SMRecId
			,'TOTAL' As ServiceName
			,SUM(isnull(HB.Beds,0)) AS Beds
			,SUM(isnull(HB.Cradles,0)) AS Cradles
			,SUM(isnull(HB.Cots,0)) AS Cots
			,SUM(isnull(HB.Incubator,0)) AS Incubator
			,SUM(isnull(HB.Beds,0) + isnull(HB.Cradles,0) + isnull(HB.Cots,0) + isnull(HB.Incubator,0)) AS Total
			,SUM(isnull(HB.Admission,0)) AS Admission
			,SUM(isnull(HB.Dicharge,0)) AS Dicharge
			,SUM(isnull(HB.Deaths,0)) AS Deaths
			,@RefNum As RefNum
			,(Case When @Htype=150 Then 'ALLOCATION OF HOSPITAL BEDS GENERAL' When @Htype=151 Then 'ALLOCATION OF HOSPITAL BEDS MCC' When @Htype=152 Then 'ALLOCATION OF HOSPITAL BEDS COMPLEX' Else '' End) AS RptTitle
			,@DayCount AS DayCount
		FROM dbo.HospitalBeds   AS HB
		WHERE (HB.CompanyId = 1)
		And (HB.StateId = 1)
		--And (HB.Machine = @Machine)
		AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
		And (HB.CYear = @CYear)	
		AND ((@Htype=152 AND (Htype=150 OR Htype=151))OR (Htype=@Htype))
    END
   ELSE
    BEGIN
		SELECT HM.SrNo AS RecId
			,0 AS SMRecId
			,DepartMent As ServiceName
			,HB.Beds
			,HB.Cradles
			,HB.Cots
			,HB.Incubator
			,(isnull(HB.Beds,0) + isnull(HB.Cradles,0) + isnull(HB.Cots,0) + isnull(HB.Incubator,0)) AS Total
			,HB.Admission
			,HB.Dicharge
			,HB.Deaths
			,@RefNum As RefNum
			,(Case When @Htype=150 Then 'ALLOCATION OF HOSPITAL BEDS GENERAL' When @Htype=151 Then 'ALLOCATION OF HOSPITAL BEDS MCC' When @Htype=152 Then 'ALLOCATION OF HOSPITAL BEDS COMPLEX' Else '' End) AS RptTitle
			,@DayCount AS DayCount
		FROM dbo.HospitalBedMaster AS HM
		LEFT OUTER JOIN dbo.HospitalBeds   AS HB
		ON HB.RefSrNo = HM.SrNo 
		AND (HB.CompanyId = @CompanyId)
		--And (HB.StateId = @StateId)
		--And (HB.Machine = @Machine)
		AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
		And (HB.CYear = @CYear)
		AND (HM.DepartMent<>'TOTAL')
		AND (HB.Htype = @Htype) 
		union all 
		SELECT 8 AS RecId
			,0 AS SMRecId
			,'TOTAL' As ServiceName
			,SUM(isnull(HB.Beds,0)) AS Beds
			,SUM(isnull(HB.Cradles,0)) AS Cradles
			,SUM(isnull(HB.Cots,0)) AS Cots
			,SUM(isnull(HB.Incubator,0)) AS Incubator
			,SUM(isnull(HB.Beds,0) + isnull(HB.Cradles,0) + isnull(HB.Cots,0) + isnull(HB.Incubator,0)) AS Total
			,SUM(isnull(HB.Admission,0)) AS Admission
			,SUM(isnull(HB.Dicharge,0)) AS Dicharge
			,SUM(isnull(HB.Deaths,0)) AS Deaths
			,@RefNum As RefNum
			,(Case When @Htype=150 Then 'ALLOCATION OF HOSPITAL BEDS GENERAL' When @Htype=151 Then 'ALLOCATION OF HOSPITAL BEDS MCC' When @Htype=152 Then 'ALLOCATION OF HOSPITAL BEDS COMPLEX' Else '' End) AS RptTitle
			,@DayCount AS DayCount
		FROM dbo.HospitalBeds   AS HB
		WHERE (HB.CompanyId = @CompanyId)
		--And (HB.StateId = @StateId)
		--And (HB.Machine = @Machine)
		AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
		And (HB.CYear = @CYear)	
		AND (HB.Htype = @Htype)
		--GROUP BY DepartMent
	END
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetAllHosptOutCome]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <04 OCt 2019>
-- Description:	<Get All Data For Report.>
-- =============================================
-- Execute RptGetAllHosptOutCome 1,1,'OMIT-1-PC',2,2019,150,'',2
-- Execute RptGetAllHosptOutCome 1,1,'OMIT-1-PC',0,2020,151,'',0
-- Execute RptGetAllHosptOutCome 1,1,'OMIT-1-PC',0,2020,152,'',0

-- Execute RptGetAllHosptOutCome 1,1,'OMIT-1-PC',1,2020,150,'',1
-- Execute RptGetAllHosptOutCome 1,1,'OMIT-1-PC',1,2020,151,'',1
-- Execute RptGetAllHosptOutCome 1,1,'OMIT-1-PC',1,2020,152,'',1

CREATE PROCEDURE [dbo].[RptGetAllHosptOutCome]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int,
	@RefNum nvarchar(20),
	@EMonth int
AS
BEGIN
	DECLARE @DayCount AS INT	
	SELECT @DayCount = SUM(MonthTotalDays)
	FROM dbo.MonthDays
	WHERE (MonthId >= @CMonth AND MonthId <= @EMonth)
	OR (@CMonth = 0 AND @EMonth = 0)

	DECLARE @BEDCOMPLEMENTM DECIMAL(28,2),@BEDCOMPLEMENTF DECIMAL(28,2),@BEDCOMPLEMENTT DECIMAL(28,2),
		    @ADMISSIONSM DECIMAL(28,2),@ADMISSIONSF DECIMAL(28,2),@ADMISSIONST DECIMAL(28,2),
			@DISCHARGESM DECIMAL(28,2),@DISCHARGESF DECIMAL(28,2),@DISCHARGEST DECIMAL(28,2),
			@DEATHSM DECIMAL(28,2),@DEATHSF DECIMAL(28,2),@DEATHST DECIMAL(28,2),
			@CUMMULATIVEDAYSM DECIMAL(28,2),@CUMMULATIVEDAYSF DECIMAL(28,2),@CUMMULATIVEDAYST DECIMAL(28,2),
			@AVAILABLEBEDM DECIMAL(28,2),@AVAILABLEBEDF DECIMAL(28,2),@AVAILABLEBEDT DECIMAL(28,2),
			@AVGLENGTHM DECIMAL(28,2),@AVGLENGTHF DECIMAL(28,2),@AVGLENGTHT DECIMAL(28,2),
			@BEDOCCUPANCYM DECIMAL(28,2),@BEDOCCUPANCYF DECIMAL(28,2),@BEDOCCUPANCYT DECIMAL(28,2),
			@AVGTURNOVERM DECIMAL(28,2),@AVGTURNOVERF DECIMAL(28,2),@AVGTURNOVERT DECIMAL(28,2),
			@FATALITYRATEM DECIMAL(28,2),@FATALITYRATEF DECIMAL(28,2),@FATALITYRATET DECIMAL(28,2),
			@ABD BIGINT,@VBD BIGINT
	

	IF(@Htype=152) 
		BEGIN
			SELECT @BEDCOMPLEMENTM=SUM(CASE WHEN HB.RefSrNo=1 THEN ISNULL(HB.MALE,0) ELSE 0 END)
				  ,@BEDCOMPLEMENTF=SUM(CASE WHEN HB.RefSrNo=1 THEN ISNULL(HB.FEMALE,0) ELSE 0 END)
				  ,@BEDCOMPLEMENTT=SUM(CASE WHEN HB.RefSrNo=1 THEN ISNULL(HB.MALE,0)+ISNULL(HB.FEMALE,0) ELSE 0 END)
			  
				  ,@ADMISSIONSM=SUM(CASE WHEN HB.RefSrNo=2 THEN ISNULL(HB.MALE,0) ELSE 0 END)
				  ,@ADMISSIONSF=SUM(CASE WHEN HB.RefSrNo=2 THEN ISNULL(HB.FEMALE,0) ELSE 0 END)
				  ,@ADMISSIONST=SUM(CASE WHEN HB.RefSrNo=2 THEN ISNULL(HB.MALE,0)+ISNULL(HB.FEMALE,0) ELSE 0 END)
			  
				  ,@DISCHARGESM=SUM(CASE WHEN HB.RefSrNo=3 THEN ISNULL(HB.MALE,0) ELSE 0 END)
				  ,@DISCHARGESF=SUM(CASE WHEN HB.RefSrNo=3 THEN ISNULL(HB.FEMALE,0) ELSE 0 END)
				  ,@DISCHARGEST=SUM(CASE WHEN HB.RefSrNo=3 THEN ISNULL(HB.MALE,0)+ISNULL(HB.FEMALE,0) ELSE 0 END)
			  
				  ,@DEATHSM=SUM(CASE WHEN HB.RefSrNo=4 THEN ISNULL(HB.MALE,0) ELSE 0 END)
				  ,@DEATHSF=SUM(CASE WHEN HB.RefSrNo=4 THEN ISNULL(HB.FEMALE,0) ELSE 0 END)
				  ,@DEATHST=SUM(CASE WHEN HB.RefSrNo=4 THEN ISNULL(HB.MALE,0)+ISNULL(HB.FEMALE,0) ELSE 0 END)
			  
				  ,@CUMMULATIVEDAYSM=SUM(CASE WHEN HB.RefSrNo=5 THEN ISNULL(HB.MALE,0) ELSE 0 END)
				  ,@CUMMULATIVEDAYSF=SUM(CASE WHEN HB.RefSrNo=5 THEN ISNULL(HB.FEMALE,0) ELSE 0 END)
				  ,@CUMMULATIVEDAYST=SUM(CASE WHEN HB.RefSrNo=5 THEN ISNULL(HB.MALE,0)+ISNULL(HB.FEMALE,0) ELSE 0 END)
			  
				  ,@AVAILABLEBEDM=SUM(CASE WHEN HB.RefSrNo=6 THEN ISNULL(HB.MALE,0) ELSE 0 END)
				  ,@AVAILABLEBEDF=SUM(CASE WHEN HB.RefSrNo=6 THEN ISNULL(HB.FEMALE,0) ELSE 0 END)
				  ,@AVAILABLEBEDT=SUM(CASE WHEN HB.RefSrNo=6 THEN ISNULL(HB.MALE,0)+ISNULL(HB.FEMALE,0) ELSE 0 END)
			FROM IPDOutcomeMaster AS HM
			INNER JOIN dbo.IPDOutcome   AS HB
			ON HB.RefSrNo = HM.SrNo 
			AND (HB.CompanyId = @CompanyId)
			AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
			And (HB.CYear = @CYear)
			AND ((@Htype=152 AND (Htype=150 OR Htype=151))OR (Htype=@Htype))

			SELECT @AVGLENGTHM=0,@AVGLENGTHF=0,@AVGLENGTHT=@CUMMULATIVEDAYST / (CASE WHEN (@DISCHARGEST+@DEATHST) > 0 THEN (@DISCHARGEST+@DEATHST) ELSE 1 END)
			SELECT @BEDOCCUPANCYM=0,@BEDOCCUPANCYF=0,@BEDOCCUPANCYT=(@CUMMULATIVEDAYST*100)/((CASE WHEN @AVAILABLEBEDT > 0 THEN @AVAILABLEBEDM ELSE 1 END) * @DayCount)
			SELECT @AVGTURNOVERM=0,@AVGTURNOVERF=0,@AVGTURNOVERT=((CASE WHEN @AVAILABLEBEDM>0 THEN @AVAILABLEBEDM * @DayCount ELSE 0 END) - (@CUMMULATIVEDAYST))/(CASE WHEN (@DISCHARGEST+@DEATHST) > 0 THEN (@DISCHARGEST+@DEATHST) ELSE 1 END)
			SELECT @FATALITYRATEM=0,@FATALITYRATEF=0,@FATALITYRATET=(@DISCHARGEST*100)/(CASE WHEN @ADMISSIONST > 0 THEN @ADMISSIONST ELSE 1 END)

			SELECT @ABD = ISNULL((CASE WHEN @AVAILABLEBEDT > 0 THEN @AVAILABLEBEDM ELSE 0 END) * @DayCount,0)
			SELECT @VBD = ISNULL(((CASE WHEN @AVAILABLEBEDM > 0 THEN @AVAILABLEBEDM ELSE 0 END) * @DayCount) - @CUMMULATIVEDAYST,0)

			--SELECT HM.SrNo As RecId
			--	  ,10 AS SMRecId
			--	  ,HM.BEDCOMPLEMENT As ServiceName
			--	  ,SUM(ISNULL(HB.MALE,0)) AS MALE
			--	  ,SUM(ISNULL(HB.FEMALE,0)) AS FEMALE
			--	  ,ISNULL(SUM(HB.MALE) + SUM(HB.FEMALE),0) AS TOTAL
			--	  ,@RefNum As RefNum
			--	  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
			--	  ,@DayCount AS DayCount
			--FROM IPDOutcomeMaster AS HM
			--LEFT OUTER JOIN dbo.IPDOutcome   AS HB
			--ON HB.RefSrNo = HM.SrNo 
			--AND (HB.CompanyId = @CompanyId)
			--AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
			--And (HB.CYear = @CYear)
			--AND ((@Htype=152 AND (Htype=150 OR Htype=151))OR (Htype=@Htype))
			--WHERE HM.SRNO <> 6 AND HB.RefSrNo <> 6
			--GROUP BY HM.SrNo,HM.BEDCOMPLEMENT

			SELECT 1 AS RecId
				  ,10 AS SMRecId
				  ,'BED COMPLEMENT' AS ServiceName
				  ,ISNULL(@BEDCOMPLEMENTM,0) AS MALE
				  ,ISNULL(@BEDCOMPLEMENTM,0) AS FEMALE
				  ,ISNULL(@BEDCOMPLEMENTT,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			UNION ALL
			SELECT 2 AS RecId
				  ,10 AS SMRecId
				  ,'ADMISSIONS' AS ServiceName
				  ,ISNULL(@ADMISSIONSM,0) AS MALE
				  ,ISNULL(@ADMISSIONSF,0) AS FEMALE
				  ,ISNULL(@ADMISSIONST,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			UNION ALL
			SELECT 3 AS RecId
				  ,10 AS SMRecId
				  ,'DISCHARGES' AS ServiceName
				  ,ISNULL(@DISCHARGESM,0) AS MALE
				  ,ISNULL(@DISCHARGESF,0) AS FEMALE
				  ,ISNULL(@DISCHARGEST,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			UNION ALL
			SELECT 4 AS RecId
				  ,10 AS SMRecId
				  ,'DEATHS' AS ServiceName
				  ,ISNULL(@DEATHSM,0) AS MALE
				  ,ISNULL(@DEATHSF,0) AS FEMALE
				  ,ISNULL(@DEATHST,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			UNION ALL
			SELECT 5 AS RecId
				  ,10 AS SMRecId
				  ,'CUMMULATIVE PATIENT DAYS' AS ServiceName
				  ,ISNULL(@CUMMULATIVEDAYSM,0) AS MALE
				  ,ISNULL(@CUMMULATIVEDAYSF,0) AS FEMALE
				  ,ISNULL(@CUMMULATIVEDAYST,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			UNION ALL
			SELECT 6 AS RecId
				  ,10 AS SMRecId
				  ,'AVERAGE LENGTH OF STAY' AS ServiceName
				  ,ISNULL(@AVGLENGTHM,0) AS MALE
				  ,ISNULL(@AVGLENGTHF,0) AS FEMALE
				  ,ISNULL(@AVGLENGTHT,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			UNION ALL
			SELECT 7 AS RecId
				  ,10 AS SMRecId
				  ,'PERCENTAGE BED OCCUPANCY' AS ServiceName
				  ,ISNULL(@BEDOCCUPANCYM,0) AS MALE
				  ,ISNULL(@BEDOCCUPANCYF,0) AS FEMALE
				  ,ISNULL(@BEDOCCUPANCYT,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			UNION ALL
			SELECT 8 AS RecId
				  ,10 AS SMRecId
				  ,'AVERAGE TURN-OVER INTERNAL' AS ServiceName
				  ,ISNULL(@AVGTURNOVERM,0) AS MALE
				  ,ISNULL(@AVGTURNOVERF,0) AS FEMALE
				  ,ISNULL(@AVGTURNOVERT,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount	 
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			UNION ALL
			SELECT 9 AS RecId
				  ,10 AS SMRecId
				  ,'CASE FATALITY RATE(%)' AS ServiceName
				  ,ISNULL(@FATALITYRATEM,0) AS MALE
				  ,ISNULL(@FATALITYRATEF,0) AS FEMALE
				  ,ISNULL(@FATALITYRATET,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount	
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			ORDER BY RecId
			/*UNION ALL
			SELECT 8 AS RecId
				,0 AS SMRecId
				,'TOTAL' As ServiceName
				,SUM(HB.MALE) AS MALE
				,SUM(HB.FEMALE) AS FEMALE
				,@RefNum As RefNum
				,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				,@DayCount AS DayCount
			FROM dbo.IPDOutcome   AS HB
			WHERE (HB.CompanyId = 1)
			--And (HB.StateId = 1)
			--And (HB.Machine = @Machine)
			AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
			And (HB.CYear = @CYear)	
			AND ((@Htype=152 AND (Htype=150 OR Htype=151))OR (Htype=@Htype))*/
		END
	ELSE
		BEGIN
			SELECT @BEDCOMPLEMENTM=SUM(CASE WHEN HB.RefSrNo=1 THEN ISNULL(HB.MALE,0) ELSE 0 END)
				  ,@BEDCOMPLEMENTF=SUM(CASE WHEN HB.RefSrNo=1 THEN ISNULL(HB.FEMALE,0) ELSE 0 END)
				  ,@BEDCOMPLEMENTT=SUM(CASE WHEN HB.RefSrNo=1 THEN ISNULL(HB.MALE,0)+ISNULL(HB.FEMALE,0) ELSE 0 END)
			  
				  ,@ADMISSIONSM=SUM(CASE WHEN HB.RefSrNo=2 THEN ISNULL(HB.MALE,0) ELSE 0 END)
				  ,@ADMISSIONSF=SUM(CASE WHEN HB.RefSrNo=2 THEN ISNULL(HB.FEMALE,0) ELSE 0 END)
				  ,@ADMISSIONST=SUM(CASE WHEN HB.RefSrNo=2 THEN ISNULL(HB.MALE,0)+ISNULL(HB.FEMALE,0) ELSE 0 END)
			  
				  ,@DISCHARGESM=SUM(CASE WHEN HB.RefSrNo=3 THEN ISNULL(HB.MALE,0) ELSE 0 END)
				  ,@DISCHARGESF=SUM(CASE WHEN HB.RefSrNo=3 THEN ISNULL(HB.FEMALE,0) ELSE 0 END)
				  ,@DISCHARGEST=SUM(CASE WHEN HB.RefSrNo=3 THEN ISNULL(HB.MALE,0)+ISNULL(HB.FEMALE,0) ELSE 0 END)
			  
				  ,@DEATHSM=SUM(CASE WHEN HB.RefSrNo=4 THEN ISNULL(HB.MALE,0) ELSE 0 END)
				  ,@DEATHSF=SUM(CASE WHEN HB.RefSrNo=4 THEN ISNULL(HB.FEMALE,0) ELSE 0 END)
				  ,@DEATHST=SUM(CASE WHEN HB.RefSrNo=4 THEN ISNULL(HB.MALE,0)+ISNULL(HB.FEMALE,0) ELSE 0 END)
			  
				  ,@CUMMULATIVEDAYSM=SUM(CASE WHEN HB.RefSrNo=5 THEN ISNULL(HB.MALE,0) ELSE 0 END)
				  ,@CUMMULATIVEDAYSF=SUM(CASE WHEN HB.RefSrNo=5 THEN ISNULL(HB.FEMALE,0) ELSE 0 END)
				  ,@CUMMULATIVEDAYST=SUM(CASE WHEN HB.RefSrNo=5 THEN ISNULL(HB.MALE,0)+ISNULL(HB.FEMALE,0) ELSE 0 END)
			  
				  ,@AVAILABLEBEDM=SUM(CASE WHEN HB.RefSrNo=6 THEN ISNULL(HB.MALE,0) ELSE 0 END)
				  ,@AVAILABLEBEDF=SUM(CASE WHEN HB.RefSrNo=6 THEN ISNULL(HB.FEMALE,0) ELSE 0 END)
				  ,@AVAILABLEBEDT=SUM(CASE WHEN HB.RefSrNo=6 THEN ISNULL(HB.MALE,0)+ISNULL(HB.FEMALE,0) ELSE 0 END)
			FROM IPDOutcomeMaster AS HM
			INNER JOIN dbo.IPDOutcome   AS HB
			ON HB.RefSrNo = HM.SrNo 
			AND (HB.CompanyId = @CompanyId)		
			AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
			And (HB.CYear = @CYear)
			AND (HB.Htype = @Htype)

			SELECT @AVGLENGTHM=0,@AVGLENGTHF=0,@AVGLENGTHT=@CUMMULATIVEDAYST / (CASE WHEN (@DISCHARGEST+@DEATHST) > 0 THEN (@DISCHARGEST+@DEATHST) ELSE 1 END)
			SELECT @BEDOCCUPANCYM=0,@BEDOCCUPANCYF=0,@BEDOCCUPANCYT=(@CUMMULATIVEDAYST*100)/((CASE WHEN @AVAILABLEBEDT > 0 THEN @AVAILABLEBEDM ELSE 1 END) * @DayCount)
			SELECT @AVGTURNOVERM=0,@AVGTURNOVERF=0,@AVGTURNOVERT=((CASE WHEN @AVAILABLEBEDM>0 THEN @AVAILABLEBEDM * @DayCount ELSE 0 END) - (@CUMMULATIVEDAYST))/(CASE WHEN (@DISCHARGEST+@DEATHST) > 0 THEN (@DISCHARGEST+@DEATHST) ELSE 1 END)
			SELECT @FATALITYRATEM=0,@FATALITYRATEF=0,@FATALITYRATET=(@DISCHARGEST*100)/(CASE WHEN @ADMISSIONST > 0 THEN @ADMISSIONST ELSE 1 END)

			SELECT @ABD = ISNULL((CASE WHEN @AVAILABLEBEDT > 0 THEN @AVAILABLEBEDM ELSE 0 END) * @DayCount,0)
			SELECT @VBD = ISNULL(((CASE WHEN @AVAILABLEBEDM > 0 THEN @AVAILABLEBEDM ELSE 0 END) * @DayCount) - @CUMMULATIVEDAYST,0)
			
			--SELECT HM.SrNo As RecId
			--	  ,10 AS SMRecId
			--	  ,HM.BEDCOMPLEMENT As ServiceName
			--	  ,SUM(ISNULL(HB.MALE,0)) AS MALE
			--	  ,SUM(ISNULL(HB.FEMALE,0)) AS FEMALE
			--	  ,ISNULL(SUM(HB.MALE) + SUM(HB.FEMALE),0) AS TOTAL
			--	  ,@RefNum As RefNum
			--	  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
			--	  ,@DayCount AS DayCount
			--FROM IPDOutcomeMaster AS HM
			--LEFT OUTER JOIN dbo.IPDOutcome AS HB
			--ON HB.RefSrNo = HM.SrNo 
			--AND (HB.CompanyId = @CompanyId)		
			--AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
			--And (HB.CYear = @CYear)
			--AND (HB.Htype = @Htype)
			--WHERE HM.SRNO <> 6 AND HB.RefSrNo <> 6
			--GROUP BY HM.SrNo,HM.BEDCOMPLEMENT

			SELECT 1 AS RecId
				  ,10 AS SMRecId
				  ,'BED COMPLEMENT' AS ServiceName
				  ,ISNULL(@BEDCOMPLEMENTM,0) AS MALE
				  ,ISNULL(@BEDCOMPLEMENTM,0) AS FEMALE
				  ,ISNULL(@BEDCOMPLEMENTT,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			UNION ALL
			SELECT 2 AS RecId
				  ,10 AS SMRecId
				  ,'ADMISSIONS' AS ServiceName
				  ,ISNULL(@ADMISSIONSM,0) AS MALE
				  ,ISNULL(@ADMISSIONSF,0) AS FEMALE
				  ,ISNULL(@ADMISSIONST,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			UNION ALL
			SELECT 3 AS RecId
				  ,10 AS SMRecId
				  ,'DISCHARGES' AS ServiceName
				  ,ISNULL(@DISCHARGESM,0) AS MALE
				  ,ISNULL(@DISCHARGESF,0) AS FEMALE
				  ,ISNULL(@DISCHARGEST,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			UNION ALL
			SELECT 4 AS RecId
				  ,10 AS SMRecId
				  ,'DEATHS' AS ServiceName
				  ,ISNULL(@DEATHSM,0) AS MALE
				  ,ISNULL(@DEATHSF,0) AS FEMALE
				  ,ISNULL(@DEATHST,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount	
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			UNION ALL
			SELECT 5 AS RecId
				  ,10 AS SMRecId
				  ,'CUMMULATIVE PATIENT DAYS' AS ServiceName
				  ,ISNULL(@CUMMULATIVEDAYSM,0) AS MALE
				  ,ISNULL(@CUMMULATIVEDAYSF,0) AS FEMALE
				  ,ISNULL(@CUMMULATIVEDAYST,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount	
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			UNION ALL
			SELECT 6 AS RecId
				  ,10 AS SMRecId
				  ,'AVERAGE LENGTH OF STAY' AS ServiceName
				  ,ISNULL(@AVGLENGTHM,0) AS MALE
				  ,ISNULL(@AVGLENGTHF,0) AS FEMALE
				  ,ISNULL(@AVGLENGTHT,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			UNION ALL
			SELECT 7 AS RecId
				  ,10 AS SMRecId
				  ,'PERCENTAGE BED OCCUPANCY' AS ServiceName
				  ,ISNULL(@BEDOCCUPANCYM,0) AS MALE
				  ,ISNULL(@BEDOCCUPANCYF,0) AS FEMALE
				  ,ISNULL(@BEDOCCUPANCYT,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			UNION ALL
			SELECT 8 AS RecId
				  ,10 AS SMRecId
				  ,'AVERAGE TURN-OVER INTERNAL' AS ServiceName
				  ,ISNULL(@AVGTURNOVERM,0) AS MALE
				  ,ISNULL(@AVGTURNOVERF,0) AS FEMALE
				  ,ISNULL(@AVGTURNOVERT,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			UNION ALL
			SELECT 9 AS RecId
				  ,10 AS SMRecId
				  ,'CASE FATALITY RATE(%)' AS ServiceName
				  ,ISNULL(@FATALITYRATEM,0) AS MALE
				  ,ISNULL(@FATALITYRATEF,0) AS FEMALE
				  ,ISNULL(@FATALITYRATET,0) AS TOTAL
				  ,@RefNum As RefNum
				  ,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				  ,@DayCount AS DayCount
				  ,@ABD AS ABD
				  ,@VBD AS VBD
			ORDER BY RecId
			/*union all 
			SELECT 6 AS RecId
				,0 AS SMRecId
				,'TOTAL' As ServiceName
				,SUM(CASE WHEN HB.RefSrNo =6 THEN 0 ELSE HB.MALE END) AS MALE
				,SUM(CASE WHEN HB.RefSrNo =6 THEN 0 ELSE HB.FEMALE END) AS FEMALE
				,@RefNum As RefNum
				,(CASE WHEN @Htype=150 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME GENERAL' WHEN @Htype=151 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME MCC' WHEN @Htype=152 THEN 'IN-PATIENT ADMISSION AND THEIR OUTCOME COMPLEX' ELSE '' END) AS RptTitle
				,@DayCount AS DayCount
			FROM dbo.IPDOutcome   AS HB
			WHERE (HB.CompanyId = @CompanyId)		
			AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
			And (HB.CYear = @CYear)	
			AND (HB.Htype = @Htype)*/ 
		END
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetBlindnessPrevProg]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <05 OCt 2019>
-- Description:	<Report Get Blindess Patient Details.>
-- =============================================
-- execute RptGetBlindnessPrevProg 1,1,'OMIT-1-PC',7,2019,155,'',12
-- execute RptGetBlindnessPrevProg 1,1,'OMIT-1-PC',7,2019,156,'',12
-- execute RptGetBlindnessPrevProg 1,1,'OMIT-1-PC',7,2019,157,'',12
CREATE PROCEDURE [dbo].[RptGetBlindnessPrevProg]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int,
	@RefNum As nvarchar(20),
	@EMonth int
AS
BEGIN
		IF(@Htype = 157)
		BEGIN
			SELECT BM.SrNo AS RecId
			,INTERVENSIONS AS ServiceName
			,SUM(isnull(B.M019,0)) AS M019
			,SUM(isnull(B.F019,0)) AS F019
			,SUM(isnull(B.M2039,0)) AS M2039
			,SUM(isnull(B.F2039,0)) AS F2039
			,SUM(isnull(B.M4059,0)) AS M4059
			,SUM(isnull(B.F4059,0)) AS F4059
			,SUM(isnull(B.M6079,0)) AS M6079 
			,SUM(isnull(B.F6079,0)) AS F6079
			,SUM(isnull(B.M80,0)) AS M80
			,SUM(isnull(CONVERT(int,B.F80),0)) AS F80
			,(Isnull(SUM(B.M019),0)+Isnull(SUM(B.M2039),0)+Isnull(SUM(B.M4059),0)+Isnull(SUM(B.M6079),0)+Isnull(SUM(B.M80),0)) AS MTOTAL
			,(Isnull(SUM(B.F019),0)+Isnull(SUM(B.F2039),0)+Isnull(SUM(B.F4059),0)+Isnull(SUM(B.F6079),0)+Isnull(SUM(Convert(int,B.F80)),0)) AS FTOTAL
			,(Isnull(SUM(B.M019),0)+Isnull(SUM(B.F019),0)+Isnull(SUM(B.M2039),0)+Isnull(SUM(B.F2039),0)+Isnull(SUM(B.M4059),0)+Isnull(SUM(B.F4059),0)+Isnull(SUM(B.M6079),0)+Isnull(SUM(B.F6079),0)+Isnull(SUM(B.M80),0)+Isnull(SUM(Convert(Int,B.F80)),0)) AS TOTAL
			,'BLINDNESS PREVENTION DATA COMPLEX' AS RptTitle
			,@RefNum AS RefNum
			,'COMPLEX' AS SubTitle
			,('PERIOD...' + [dbo].[GetMonthName](@CMonth) +' - '+ Convert(nvarchar(4),@CYear)) AS PeridFrom
		FROM dbo.BlindnessMaster AS BM
		LEFT OUTER JOIN dbo.Blindness AS B
		ON B.RefSrNo = BM.SrNo 
		AND(B.COMPANTID = @CompanyId)
		--AND(B.StateId = @StateId)
		--And (HB.Machine = @Machine)
		AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
		AND(B.CYear = @CYear)
		AND(B.Htype=155 OR B.Htype=156)
		AND(B.Htype <>  157)
		Group by B.RefSrNo,BM.SrNo, BM.INTERVENSIONS
		order by BM.SrNo
		END
	ELSE
		BEGIN
			SELECT BM.SrNo AS RecId
				,INTERVENSIONS AS ServiceName
				,B.M019
				,B.F019
				,B.M2039
				,B.F2039
				,B.M4059
				,B.F4059
				,B.M6079
				,B.F6079
				,B.M80
				,B.F80
				,(Isnull(B.M019,0)+Isnull(B.M2039,0)+Isnull(B.M4059,0)+Isnull(B.M6079,0)+Isnull(B.M80,0)) AS MTOTAL
				,(Isnull(B.F019,0)+Isnull(B.F2039,0)+Isnull(B.F4059,0)+Isnull(B.F6079,0)+Isnull(B.F80,0)) AS FTOTAL
				,(Isnull(B.M019,0)+Isnull(B.F019,0)+Isnull(B.M2039,0)+Isnull(B.F2039,0)+Isnull(B.M4059,0)+Isnull(B.F4059,0)+Isnull(B.M6079,0)+Isnull(B.F6079,0)+Isnull(B.M80,0)+Isnull(B.F80,0)) AS TOTAL
				,(Case When @Htype=155 Then 'BLINDNESS PREVENTION DATA GENERAL' When @Htype=156 Then 'BLINDNESS PREVENTION DATA MCC' Else '' End) AS RptTitle
				,@RefNum AS RefNum
				,(Case When @Htype=155 Then 'GENERAL' When @Htype=156 Then 'MCC' ELSE '' END) AS SubTitle
			    ,('PERIOD...' + [dbo].[GetMonthName](@CMonth) +' - '+ Convert(nvarchar(4),@CYear)) AS PeridFrom
			FROM dbo.BlindnessMaster AS BM
			LEFT OUTER JOIN dbo.Blindness   AS B
			ON B.RefSrNo = BM.SrNo 
			AND(B.COMPANTID = @CompanyId)
			--AND(B.StateId = @StateId)
			--And (HB.Machine = @Machine)
			AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
			AND(B.CYear = @CYear)
			AND(B.Htype = @Htype)
		END
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetBoughtPatientDeathComplex]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <08 August 19>
-- Description:	<Report - Display All Details.>
-- =============================================
-- execute RptGetBoughtPatientDeathComplex 7,2019,25,1,'',1,22,25,25,12
CREATE PROCEDURE [dbo].[RptGetBoughtPatientDeathComplex]
	@CMonth Int,
	@CYear Int,
	@HType Int, 
	@StateId int,
	@ReffNo Nvarchar(100),
	@CompanyId Bigint,
	@HType1 Int,
	@HType2 Int,
	@HType3 Int,
	@EMonth Int	
AS
BEGIN
	
  SELECT (ROW_NUMBER() OVER(ORDER BY [RecId] ASC)) as SrNo
	  ,'BROUGHT DEATH COMPLEX' + ' (' + [dbo].[GetMonthName](@CMonth) +' - '+ Convert(nvarchar(4),@CYear) + ')' AS  SubTitle
      ,[Htype]
      ,[StateId]
      ,[CompanyId]
      ,[Decease] AS NameOfDeases
      ,(Case When [Sex] = 1 Then 'Male' Else 'Female' End) AS Sex
      ,CONVERT(Nvarchar(3),[Age] )+ ' yrs' AS Age
      ,@ReffNo AS 'RefNo'
	  ,RefNo AS RegNo
      ,[Address] AS HomeAddress
      ,CONVERT(Nvarchar(10),[DOA],101) AS DateOfAdmission
      ,CONVERT(Nvarchar(10),[DOD],101) AS DateOfDeath
      ,DATEDIFF(DAY, [DOA], [DOD]) AS NoOfDay
      ,[CausesDeath] AS CausesOfDeath
      ,[Machine]
      ,[CreateDate]
      ,(SELECT C.CName FROM DBO.CompanyMaster AS C INNER JOIN DBO.StateMaster AS S ON C.State =S.RecId WHERE C.RecId = @CompanyId) as CompanyName 	 
      ,(SELECT C1.City +', ' + S1.StateName FROM DBO.CompanyMaster AS C1 INNER JOIN DBO.StateMaster AS S1 ON C1.State =S1.RecId WHERE C1.RecId = @CompanyId) as CAdd 	
  FROM [dbo].[DeathsDetails]
  WHERE (YEAR(CreateDate) = @CYear)  
  AND ((MONTH(CreateDate) >=@CMonth AND MONTH(CreateDate) <=@EMonth) OR @CMonth+@EMonth=0)
  AND (Htype = @HType OR HType = @HType1 OR HType = @HType2 OR HType = @HType3)
  --AND (@StateId = 0 OR StateId = @StateId)
  AND (CompanyId = @CompanyId)
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetBoughtPatientDeathDetails]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <08 August 19>
-- Description:	<Report - Display All Details.>
-- =============================================
-- execute RptGetBoughtPatientDeathDetails 7,2019,25,1,'',1,22,12
CREATE PROCEDURE [dbo].[RptGetBoughtPatientDeathDetails]
	@CMonth Int,
	@CYear Int,
	@HType Int, 
	@StateId int,
	@ReffNo Nvarchar(100),
	@CompanyId Bigint,
	@HType1 Int,
	@EMonth Int	
AS
BEGIN
	
  SELECT (ROW_NUMBER() OVER(ORDER BY [RecId] ASC)) as SrNo
	  ,(CASE WHEN @HType = 22 THEN 'BROUGHT IN DEATH GENERAL' WHEN @HType=25 THEN 'BROUGHT IN DEATH MCC' ELSE ' ' END) + ' (' + [dbo].[GetMonthName](@CMonth) +' - '+ Convert(nvarchar(4),@CYear) + ')' AS  SubTitle
      ,[Htype]
      ,[StateId]
      ,[CompanyId]
      ,[Decease] AS NameOfDeases
      ,(Case When [Sex] = 1 Then 'Male' Else 'Female' End) AS Sex
      ,CONVERT(Nvarchar(3),[Age] )+ ' yrs' AS Age
      ,@ReffNo AS 'RefNo'
	  ,RefNo AS RegNo
      ,[Address] AS HomeAddress
      ,CONVERT(Nvarchar(10),[DOA],101) AS DateOfAdmission
      ,CONVERT(Nvarchar(10),[DOD],101) AS DateOfDeath
      ,DATEDIFF(DAY, [DOA], [DOD]) AS NoOfDay
      ,[CausesDeath] AS CausesOfDeath
      ,[Machine]
      ,[CreateDate]
      ,(SELECT C.CName FROM DBO.CompanyMaster AS C INNER JOIN DBO.StateMaster AS S ON C.State =S.RecId WHERE C.RecId = @CompanyId) as CompanyName 	 
      ,(SELECT C1.City +', ' + S1.StateName FROM DBO.CompanyMaster AS C1 INNER JOIN DBO.StateMaster AS S1 ON C1.State =S1.RecId WHERE C1.RecId = @CompanyId) as CAdd 	
  FROM [dbo].[DeathsDetails]
  WHERE (YEAR(CreateDate) = @CYear)
  AND ((MONTH(CreateDate) >=@CMonth AND MONTH(CreateDate) <=@EMonth) OR @CMonth+@EMonth=0)
  AND (Htype = @HType OR HType = @HType1)
  AND (CompanyId = @CompanyId)
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetCasualty]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <06 August 19>
-- Description:	<omtechsoft.com>
-- =============================================
-- execute RptGetCasualty 7,2019,1,'',1,16,17,11
CREATE PROCEDURE [dbo].[RptGetCasualty]	
	@CMonth Int,
	@CYear Int,
	@StateId int,
	@ReffNo Nvarchar(100),
	@CompanyId Bigint,
	@HType Int, 
	@HType1 Int,
	@EMonth Int	
AS
BEGIN
	SET NOCOUNT ON;
	Declare @CompanyName as Nvarchar(500)
	Declare @CAdd as Nvarchar(500)
	Declare @SubTitle as Nvarchar(100)
	
	SELECT @CompanyName =C.CName,@CAdd =C.City +', ' + S.StateName FROM DBO.CompanyMaster AS C
	INNER JOIN DBO.StateMaster AS S ON C.State = S.RecId 
	WHERE C.RecId = @CompanyId 	
	select @SubTitle = (CASE WHEN @HType = 16 THEN 'OUT-PATIENT CASUALITY NEW CASES AND DEATH BY AGE GROUP AND SEX GENERAL' WHEN @HType=18 THEN 'OUT-PATIENT CASUALITY NEW CASES AND DEATH BY AGE GROUP AND SEX MCC' ELSE ' ' END) + '(' + [dbo].[GetMonthName](@CMonth) +' - '+ Convert(nvarchar(4),@CYear) + ')'
			
	;with cte as (
	SELECT 
		SM.RecId ,
		SM.ServiceName,
		(SELECT SM1.ServiceName FROM dbo.ServicesMaster AS SM1 WHERE SM1.RecId =SM.ParentId) AS PServiceName
	FROM dbo.ServicesMaster AS SM
	WHERE SM.ParentId >0 and GroupId = 4)
	
  
   SELECT 
		(ROW_NUMBER() OVER(PARTITION BY SMT.PServiceName ORDER BY SMT.RecId ASC)) as SrNo,
		@CompanyName as CompanyName,
		@CAdd AS CAdd,
		CD.ServiceId,
		SMT.ServiceName,
		SMT.PServiceName,
		SUM(CASE WHEN CD.HType = @HType AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS Male,
		SUM(CASE WHEN CD.HType = @HType AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS FeMale,
		SUM(CASE WHEN CD.HType = @HType1 AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS DeathMale,
		SUM(CASE WHEN CD.HType = @HType1 AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS DeathFeMale,
		@SubTitle as SubTitle,
		(CASE WHEN @HType=16 THEN 'GENERAL' WHEN @HType=18 THEN 'MCC' ELSE '' END) AS HType,		
		@ReffNo AS ReffNo
	FROM cte SMT
	LEFT OUTER JOIN CaseDetail AS CD
	ON SMT.RecId =CD.ServiceId 
	AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
	AND CD.CYear =@CYear 
	AND (CD.HType = @HType OR CD.HType = @HType1)
	AND CD.CompanyId =@CompanyId
	GROUP BY CD.ServiceId ,SMT.RecId,SMT.ServiceName,SMT.PServiceName 
	ORDER BY SMT.RecId
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetCasualtyComplex]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <06 August 19>
-- Description:	<omtechsoft.com>
-- =============================================
-- execute RptGetCasualtyComplex 7,2019,1,'',1,16,17,18,19,12
CREATE PROCEDURE [dbo].[RptGetCasualtyComplex]	
	@CMonth Int,
	@CYear Int,
	@StateId int,
	@ReffNo Nvarchar(100),
	@CompanyId Bigint,
	@HType Int, 
	@HType1 Int,
	@HType2 Int,
	@HType3 Int,
	@EMonth Int	
AS
BEGIN
	SET NOCOUNT ON;
	Declare @CompanyName as Nvarchar(500)
	Declare @CAdd as Nvarchar(500)
	Declare @SubTitle as Nvarchar(100)
	
	SELECT @CompanyName =C.CName,@CAdd =C.City +', ' + S.StateName FROM DBO.CompanyMaster AS C
	INNER JOIN DBO.StateMaster AS S ON C.State = S.RecId 
	WHERE C.RecId = @CompanyId 	
	
	SELECT @SubTitle = 'OUT-PATIENT CASUALITY NEW CASES AND DEATH BY AGE GROUP AND SEX COMPLEX' + ' (' + [dbo].[GetMonthName](@CMonth) +' - '+ Convert(nvarchar(4),@CYear) + ')'
	
	;with cte as (
	SELECT 
		SM.RecId ,
		SM.ServiceName,
		(SELECT SM1.ServiceName FROM dbo.ServicesMaster AS SM1 WHERE SM1.RecId =SM.ParentId) AS PServiceName
	FROM dbo.ServicesMaster AS SM
	WHERE SM.ParentId >0 and GroupId = 4)
	
  
   SELECT 
		(ROW_NUMBER() OVER(PARTITION BY SMT.PServiceName ORDER BY SMT.RecId ASC)) as SrNo,
		@CompanyName as CompanyName,
		@CAdd AS CAdd,
		CD.ServiceId,
		SMT.ServiceName,
		SMT.PServiceName,
		SUM(CASE WHEN (CD.HType = @HType OR CD.HType = @HType1) AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS Male,
		SUM(CASE WHEN (CD.HType = @HType OR CD.HType = @HType1) AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS FeMale,
		SUM(CASE WHEN (CD.HType = @HType2 OR CD.HType = @HType3) AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS DeathMale,
		SUM(CASE WHEN (CD.HType = @HType2 OR CD.HType = @HType3) AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS DeathFeMale,
		@SubTitle as SubTitle,
		'COMPLEX' AS HType,		
		@ReffNo AS ReffNo
	FROM cte SMT
	LEFT OUTER JOIN CaseDetail AS CD
	ON SMT.RecId =CD.ServiceId 
	AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
	AND CD.CYear =@CYear 
	AND (CD.HType = @HType OR CD.HType = @HType1 OR CD.HType = @HType2 OR CD.HType = @HType3)
	AND CD.CompanyId =@CompanyId
	GROUP BY CD.ServiceId ,SMT.RecId,SMT.ServiceName,SMT.PServiceName 
	ORDER BY SMT.RecId   	
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetCMF]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute RptGetCMF 12,2019,101,110,1,'',1,0
CREATE PROCEDURE [dbo].[RptGetCMF]
	@CMonth Int,
	@CYear Int,
	@HType Int,
	@HType1 Int, 
	@StateId int,
	@ReffNo Nvarchar(100),
	@CompanyId Bigint,
	@EMonth Int
AS
BEGIN
	--DECLARE @DayDate as datetime
	--SELECT @DayDate= convert(nvarchar(4),@CYear) +'-'+ convert(nvarchar(4),@CMonth) + '-1'
	--Declare @NoOfDay as int
	--SELECT @NoOfDay=Day(DATEADD(day,-1,DATEADD(month,1,@DayDate)))


	SELECT SM.recid AS ServiceId
		  ,SUBSTRING(SM.ServiceName,0, CHARINDEX(' - ', SM.ServiceName,0))  AS ServiceCode
		  ,SUBSTRING(SM.ServiceName, CHARINDEX(' - ', SM.ServiceName) + 2, 500)  AS ServiceText
		  ,SM.ServiceName 
		  ,(CASE WHEN SM.ParentId=0 THEN SM.RecId ELSE SM.ParentId END) AS ParentId
		  ,(SELECT TOP 1 SUBSTRING(SM1.ServiceName, CHARINDEX(' - ', SM1.ServiceName) + 2, 500) FROM DBO.ServicesMaster AS SM1 WHERE SM1.GroupId =3 AND SM1.RecId =(CASE WHEN SM.ParentId=0 THEN SM.RecId ELSE SM.ParentId END)) AS ParentName
		  ,SUM(CASE WHEN (CD.HType = 101 OR CD.HType = 102) AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS CMale04
		  ,SUM(CASE WHEN (CD.HType = 106 OR CD.HType = 107) AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS CFeMale04
		  ,SUM(CASE WHEN CD.HType = 103 AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS CMale514
		  ,SUM(CASE WHEN CD.HType = 108 AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS CFeMale514
		  ,SUM(CASE WHEN CD.HType = 104 AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS CMale1549
		  ,SUM(CASE WHEN CD.HType = 109 AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS CFeMale1549
		  ,SUM(CASE WHEN CD.HType = 105 AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS CMale50
		  ,SUM(CASE WHEN CD.HType = 110 AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS CFeMale50

		  ,SUM(CASE WHEN (CD.HType = 101 OR CD.HType = 102) AND CD.CaseType =2 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS DMale04
		  ,SUM(CASE WHEN (CD.HType = 106 OR CD.HType = 107) AND CD.CaseType =2 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS DFeMale04
		  ,SUM(CASE WHEN CD.HType = 103 AND CD.CaseType =2 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS DMale514
		  ,SUM(CASE WHEN CD.HType = 108 AND CD.CaseType =2 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS DFeMale514
		  ,SUM(CASE WHEN CD.HType = 104 AND CD.CaseType =2 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS DMale1549
		  ,SUM(CASE WHEN CD.HType = 109 AND CD.CaseType =2 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS DFeMale1549
		  ,SUM(CASE WHEN CD.HType = 105 AND CD.CaseType =2 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS DMale50
		  ,SUM(CASE WHEN CD.HType = 110 AND CD.CaseType =2 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS DFeMale50


		  ,@ReffNo AS ReffNo
		  ,'IN PATIENT / OUT PATIENT' AS RptTitle
	FROM dbo.ServicesMaster AS SM
	LEFT OUTER JOIN CaseDetail AS CD
	ON SM.RecId =CD.ServiceId 
	AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)	
	AND CD.CYear =@CYear 
	AND (CD.HType >= @HType AND CD.HType <= @HType1)
	AND CD.CompanyId =@CompanyId
	WHERE SM.GroupId =3
	--AND (SM.ParentId =1752 OR SM.RecId =1752)
	GROUP BY CD.ServiceId,SM.RecId,SM.SortOrd ,SM.ParentId,SM.ServiceName
	ORDER BY SM.SortOrd 

END
GO
/****** Object:  StoredProcedure [dbo].[RptGetDentalProcedure]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <23 Sept 2019>
-- Description:	<GET DENTAL PROCEDURE>
-- =============================================
-- execute [RptGetDentalProcedure] 1,1,'OMIT-1-PC',7,2019,160,'',12
CREATE PROCEDURE [dbo].[RptGetDentalProcedure]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int,
	@RefNum As nvarchar(20),
	@EMonth int
AS
BEGIN
	IF(@Htype = 162)
	BEGIN	
		SELECT DM.SrNo As RecId
	   ,[DProcedure] As ServiceName
       ,SUM(isnull(D.[M012],0)) AS M012
       ,SUM(isnull(D.[F012],0)) AS F012
       ,SUM(isnull(D.[M1359],0)) AS M1359
       ,SUM(isnull(D.[F1359],0)) AS F1359
       ,SUM(isnull(D.[M60],0)) AS M60
       ,SUM(isnull(D.[F60],0)) AS F60
       ,SUM(IsNull(D.[M012],0)) + SUM(IsNull(D.[M1359],0)) + SUM(IsNull(D.[M60],0)) AS [Mtot]
       ,SUM(IsNull(D.[F012],0)) + SUM(IsNull(D.[F1359],0)) + SUM(IsNull(D.[F60],0)) AS [Ftot]
       ,SUM(IsNull(D.[M012],0)) + SUM(IsNull(D.[F012],0)) + SUM(IsNull(D.[M1359],0)) + SUM(IsNull(D.[F1359],0)) + SUM(IsNull(D.[M60],0)) + SUM (IsNull(D.[F60],0)) AS Total
	   ,'DENTAL PROCEDURE - COMPLEX' AS RptTitle
	   ,@RefNum AS RefNum
     FROM dbo.DentalMaster AS DM
     LEFT OUTER JOIN Dental AS D
     ON D.RefSrNo = DM.SrNo
     AND(D.CompanyId = @CompanyId)
	 --AND(D.StateId = @StateId)
	 --And (HB.Machine = @Machine)
	 AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
	 AND(D.CYear = @CYear)
	 AND(D.Htype = 160 OR D.Htype = 161) 
	 AND(D.Htype <> 162)
	 Group by D.RefSrNo, DM.SrNo, DProcedure
	 Order By DM.SrNo
	END
ELSE
	BEGIN
		SELECT DM.SrNo As RecId
		   ,[DProcedure] As ServiceName
		   ,D.[M012]
		   ,D.[F012]
		   ,D.[M1359]
		   ,D.[F1359]
		   ,D.[M60]
		   ,D.[F60]
		   ,(IsNull(D.[M012],0) +IsNull(D.[M1359],0)+IsNull(D.[M60],0)) AS [Mtot]
		   ,(IsNull(D.[F012],0)+IsNull(D.[F1359],0)+IsNull(D.[F60],0)) AS [Ftot]
		   ,(IsNull(D.[M012],0) +IsNull(D.[F012],0)+IsNull(D.[M1359],0)+IsNull(D.[F1359],0)+IsNull(D.[M60],0)+IsNull(D.[F60],0)) AS Total
		   ,(Case When @Htype=160 Then 'DENTAL PROCEDURE - GENERAL' When @Htype=161 Then 'DENTAL PROCEDURE - MCC' Else '' End) AS RptTitle
		   ,@RefNum AS RefNum
		 FROM dbo.DentalMaster AS DM
		 LEFT OUTER JOIN Dental AS D
		 ON D.RefSrNo = DM.SrNo
		 AND(D.CompanyId = @CompanyId)
		 --AND(D.StateId = @StateId)
		 --And (HB.Machine = @Machine)
		 AND D.CMonth >=@CMonth AND D.CMonth <=@EMonth 
		 AND(D.CYear = @CYear)
		 AND(D.Htype = @Htype)
	 END
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetHeaderDetails]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <10 August 2019>
-- Description:	<Get Header For Report.>
-- =============================================
-- EXECUTE RptGetHeaderDetails 1,1,'',''
CREATE PROCEDURE [dbo].[RptGetHeaderDetails]
	@CompanyId Bigint,
	@HType int,
	@RefNum Nvarchar(100),
	@Period Nvarchar(150)
AS
BEGIN
	
	SELECT C.Header1 AS CName
		   ,C.City +', ' + S.StateName  AS CAdd
		   ,C.Header2 AS Title1
		   ,C.Header3 As Title2
		   ,(CASE WHEN @HType IN (1,4,7,10,16,22,155,160,150,170,165) THEN 'GENERAL'
				  WHEN @HType IN (2,5,8,12,18,23,25,156,161,151,171,166) THEN 'MCC'
				  WHEN @HType IN (3,6,14,27,157,162,152,172,167) THEN 'COMPLEX'
				  ELSE '' END) As Title3
		   ,CASE WHEN @RefNum <> '' THEN 'RefNum : ' + @RefNum ELSE '' END AS RefNum
		   ,'Period : ' + @Period AS Period
		   ,C.Logo
	FROM DBO.CompanyMaster AS C
	INNER JOIN DBO.StateMaster AS S ON C.State = S.RecId 
	WHERE C.RecId = @CompanyId 		
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetHeaderDetailsV1]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <10 August 2019>
-- Description:	<Get Header For Report.>
-- =============================================
-- Execute RptGetHeaderDetailsV1 '','',''
CREATE PROCEDURE [dbo].[RptGetHeaderDetailsV1]
@ReportTitle Nvarchar(200),
@RefNum Nvarchar(100),
@Period Nvarchar(150)
AS
BEGIN
	SELECT 'LAGOS STATE GOVERNMENT' AS Header1
		  ,'HEALTH SERVICE COMMISSION' AS Header2
		  ,'MEDICAL RECORDS AND STATISTICAL DIVISION' AS Header3
		  ,@ReportTitle AS ReportTitle
		  ,CASE WHEN @RefNum <> '' THEN 'RefNum : ' + @RefNum ELSE '' END AS RefNum
		  ,'Period : ' + @Period AS Period
		  ,'' AS Logo
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetLiveBirthWeight]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <28 Sept 2019>
-- Description:	<Get Live Birth Weight Data.>
-- =============================================
-- execute [RptGetLiveBirthWeight] 1,1,'OMIT-2',7,2019,170,'',12
CREATE PROCEDURE [dbo].[RptGetLiveBirthWeight]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int,
	@RefNum As nvarchar(20),
	@EMonth int
AS
BEGIN
	IF(@Htype = 172)
		BEGIN
			SELECT LM.SrNo As RecId
				,LM.LiveBirthWeight As ServiceName
				,SUM(isnull(LW.Male,0)) AS Male
				,SUM(isnull(LW.Female,0)) AS Female 
				,'LIVE BIRTH WEIGHT BY SEX COMPLEX' AS RptTitle
				,@RefNum AS RefNum
			FROM dbo.LiveBirthWeightMaster AS LM
			LEFT OUTER JOIN LiveBirthWeight AS LW
			ON LW.RefSrno = LM.SrNo
			AND(LW.CompanyId = @CompanyId)
			--AND(LW.StateId = @StateId)
			--AND LW.CMonth >=@CMonth AND LW.CMonth <=@EMonth 
			AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
			AND(LW.CYear = @CYear)
			AND(LW.Htype = 170 OR LW.Htype = 171) 
			AND(LW.Htype <> 172)
			GROUP BY LW.RefSrno,LM.SrNo,LM.LiveBirthWeight
			
			UNION ALL
			SELECT 14 As RecId
				,'TOTAL' As ServiceName
				,SUM(isnull(LW.Male,0)) AS Male
				,SUM(isnull(LW.Female,0)) AS Female
				,'LIVE BIRTH WEIGHT BY SEX COMPLEX' AS RptTitle
				,@RefNum AS RefNum
			FROM dbo.LiveBirthWeight AS LW
			WHERE (LW.CompanyId = @CompanyId)
			--AND(LW.StateId = @StateId)
			--AND LW.CMonth >=@CMonth AND LW.CMonth <=@EMonth 
			AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
			AND(LW.CYear = @CYear)
			AND(LW.Htype = 170 OR LW.Htype = 171) 
			AND(LW.Htype <> 172)
			Order by  RecId
			--GROUP BY LW.RefSrno,LM.SrNo,LM.LiveBirthWeight
		END
	ELSE
		BEGIN
			SELECT LM.SrNo As RecId
				,LM.LiveBirthWeight As ServiceName
				,sum(isnull(LW.Male,0)) AS Male
				,sum(isnull(LW.Female ,0)) AS Female
				,(Case When @Htype=170 Then 'LIVE BIRTH WEIGHT BY SEX GENERAL' When @Htype=171 Then 'LIVE BIRTH WEIGHT BY SEX MCC' Else '' End) AS RptTitle
		        ,@RefNum AS RefNum
			FROM dbo.LiveBirthWeightMaster AS LM
			LEFT OUTER JOIN LiveBirthWeight AS LW
			ON LW.RefSrno = LM.SrNo
			AND(LW.CompanyId = @CompanyId)
			--AND(LW.StateId = @StateId)
			--And (HB.Machine = @Machine)
			--AND LW.CMonth >=@CMonth AND LW.CMonth <=@EMonth 
			AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
			AND(LW.CYear = @CYear)
			AND(LW.Htype = @Htype) 
			GROUP BY LW.RefSrno,LM.SrNo,LM.LiveBirthWeight
			UNION ALL
			SELECT 14 As RecId
				,'TOTAL' As ServiceName
				,SUM(isnull(LW.Male,0)) AS Male
				,SUM(isnull(LW.Female,0)) AS Female
				,(Case When @Htype=170 Then 'LIVE BIRTH WEIGHT BY SEX GENERAL' When @Htype=171 Then 'LIVE BIRTH WEIGHT BY SEX MCC' Else '' End) AS RptTitle
		        ,@RefNum AS RefNum
			FROM dbo.LiveBirthWeight AS LW
			WHERE (LW.CompanyId = @CompanyId)
			--AND(LW.StateId = @StateId)
			--AND LW.CMonth >=@CMonth AND LW.CMonth <=@EMonth 
			AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
			AND(LW.CYear = @CYear)
			AND(LW.Htype = @Htype)
			
		END
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetMaternalHealth]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <05 OCt 2019>
-- Description:	<Report Get Maternal Health Data.>
-- =============================================
-- execute [RptGetMaternalHealth] 7,1,'',10,2019,167,'',12
CREATE PROCEDURE [dbo].[RptGetMaternalHealth]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int,
	@RefNum As nvarchar(20),
	@EMonth int
AS
BEGIN
	IF(@Htype = 167)
	BEGIN
		SELECT MM.[SrNo] As RecId
		  ,MM.[Description] AS ServiceName
		  ,SUM(isnull(MH.[Result],0)) AS Result
		  ,'MATERNAL HEALTH SERVICES INFORMATION - COMPLEX' AS RptTitle
		  ,@RefNum AS RefNum
		  ,MM.SortOrder
		FROM [dbo].[MaternalHealthMaster] AS MM
		LEFT OUTER JOIN  MaternalHealth AS MH
		ON MH.RefSrNo = MM.SrNo
		AND(MH.CompanyId = @CompanyId)
		AND(MH.StateId = @StateId)
		--And (HB.Machine = @Machine)
		--AND MH.CMonth >=@CMonth AND MH.CMonth <=@EMonth 
		AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
		AND(MH.CYear = @CYear)
		AND(MH.Htype = 165 OR MH.Htype=166)
		AND(MH.Htype <> 167)
		GROUP BY MH.RefSrNo,MM.SrNo,MM.Description,MM.SortOrder
		--ORDER BY MM.SrNo
		UNION ALL
		SELECT 36 As RecId
		  ,'Total' AS ServiceName
		  ,SUM(isnull(MH.[Result],0)) AS Result
		  ,'MATERNAL HEALTH SERVICES INFORMATION - COMPLEX' AS RptTitle
		  ,@RefNum AS RefNum
		  ,36 AS SortOrder
		FROM MaternalHealth AS MH    
		WHERE (MH.CompanyId = @CompanyId)
		--AND(MH.StateId = @StateId)	
		--AND MH.CMonth >=@CMonth AND MH.CMonth <=@EMonth 
		AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
		AND(MH.CYear = @CYear)
		AND(MH.Htype = 165 OR MH.Htype=166)
		AND(MH.Htype <> 167)
		order by SortOrder
	END
ELSE
	BEGIN
	SELECT MM.[SrNo] As RecId
		  ,MM.[Description] AS ServiceName
		  ,isnull(MH.[Result],0) AS Result
		  ,(Case When @Htype=165 Then 'MATERNAL HEALTH SERVICES INFORMATION - GENERAL' When @Htype=166 Then 'MATERNAL HEALTH SERVICES INFORMATION- MCC' Else '' End) AS RptTitle
		  ,@RefNum AS RefNum
		  ,MM.SortOrder
		FROM [dbo].[MaternalHealthMaster] AS MM
		LEFT OUTER JOIN  MaternalHealth AS MH
		ON MH.RefSrNo = MM.SrNo
		AND(MH.CompanyId = @CompanyId)
		AND(MH.StateId = @StateId)
		--And (HB.Machine = @Machine)
		--AND MH.CMonth >=@CMonth AND MH.CMonth <=@EMonth 
		AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
		AND(MH.CYear = @CYear)
		AND(MH.Htype = @Htype)
		UNION ALL
		SELECT 36 As RecId
		  ,'Total' AS ServiceName
		  ,SUM(isnull(MH.[Result],0)) AS Result
		  ,(Case When @Htype=165 Then 'MATERNAL HEALTH SERVICES INFORMATION - GENERAL' When @Htype=166 Then 'MATERNAL HEALTH SERVICES INFORMATION- MCC' Else '' End) AS RptTitle
		  ,@RefNum AS RefNum
		  ,36 AS SortOrder
		FROM MaternalHealth AS MH    
		WHERE (MH.CompanyId = @CompanyId)
		--AND(MH.StateId = @StateId)	
		--AND MH.CMonth >=@CMonth AND MH.CMonth <=@EMonth 
		AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
		AND(MH.CYear = @CYear)
		AND(MH.Htype = @Htype)
		order by SortOrder
	END
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetMonthDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <30 June 2019>
-- =============================================
-- Execute Win_GetMonthDrp
CREATE PROCEDURE [dbo].[RptGetMonthDrp]

AS
BEGIN
	SELECT 'Year' AS MontName,0 AS MonthId
	UNION ALL
	SELECT 'January' AS MontName,1 AS MonthId
	UNION ALL
	SELECT 'February' AS MontName,2 AS MonthId
	UNION ALL
	SELECT 'March' AS MontName,3 AS MonthId
	UNION ALL
	SELECT 'April' AS MontName,4 AS MonthId
	UNION ALL
	SELECT 'May' AS MontName,5 AS MonthId
	UNION ALL
	SELECT 'June' AS MontName,6 AS MonthId
	UNION ALL
	SELECT 'July' AS MontName,7 AS MonthId
	UNION ALL
	SELECT 'August' AS MontName,8 AS MonthId
	UNION ALL
	SELECT 'September' AS MontName,9 AS MonthId
	UNION ALL
	SELECT 'October' AS MontName,10 AS MonthId
	UNION ALL
	SELECT 'November' AS MontName,11 AS MonthId
	UNION ALL
	SELECT 'December' AS MontName,12 AS MonthId
	UNION ALL
	SELECT 'Quarter1 (Jan-Mar)' AS MontName,13 AS MonthId
	UNION ALL
	SELECT 'Quarter2 (Apr-Jun)' AS MontName,14 AS MonthId
	UNION ALL
	SELECT 'Quarter3 (Jul-Sept)' AS MontName,15 AS MonthId
	UNION ALL
	SELECT 'Quarter4 (Oct-Dec)' AS MontName,16 AS MonthId
	UNION ALL
	SELECT 'Bi-annual (Jan-Jun)' AS MontName,17 AS MonthId
	UNION ALL
	SELECT 'Bi-annual (Jul-Dec)' AS MontName,18 AS MonthId
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetPatientAdmitOutcomes]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <10 Oct 2019>
-- Description:	<Report Patient Hospital InCome - Outcome>
-- =============================================
-- EXECUTE [RptGetPatientAdmitOutcomes] 7,1,'',10,2019,150,'J12300',12
CREATE PROCEDURE [dbo].[RptGetPatientAdmitOutcomes]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int,
	@RefNum As nvarchar(20),
	@EMonth int
AS
BEGIN
	IF(@Htype = 152)
		BEGIN
			SELECT IM.SRNO AS RecId
				  ,0 AS SMRecId	
				  ,IM.BEDCOMPLEMENT As ServiceName
				  ,SUM(isnull(IC.MALE,0)) AS Male
				  ,SUM(isnull(IC.FEMALE,0)) As Female
				  ,(isnull(SUM(IC.MALE),0) + isnull(SUM(IC.FEMALE),0)) AS TOTAL 
				  ,'IN-PATIENT ADMISSION AND THEIR OUTCOME - COMPLEX' AS RptTitle
				  ,@RefNum AS RefNum
			FROM dbo.IPDOutcomeMaster AS IM
			LEFT OUTER JOIN dbo.IPDOutcome AS IC
			ON IC.RefSrNo = IM.SrNo 
			AND (IC.CompanyId = @CompanyId)
			--And (IC.StateId = @StateId)
			--AND IC.CMonth >=@CMonth AND IC.CMonth <=@EMonth 
			AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
			And (IC.CYear = @CYear)
			AND (Htype=150 OR Htype=151)
			AND (Htype <> 152)
			Group by RefSrNo,IM.SRNO,Im.BEDCOMPLEMENT
		END
	ELSE
		BEGIN
			SELECT IM.SRNO AS RecId
				  ,0 AS SMRecId	
				  ,IM.BEDCOMPLEMENT As ServiceName
				  ,isnull(IC.MALE,0) As Male
				  ,isnull(IC.FEMALE,0) As Female
				  ,(isnull(IC.MALE,0) + isnull(IC.FEMALE,0)) AS TOTAL 
				  ,(Case When @Htype=150 Then 'IN-PATIENT ADMISSION AND THEIR OUTCOME - GENERAL' When @Htype=151 Then 'IN-PATIENT ADMISSION AND THEIR OUTCOME - MCC' Else '' End) AS RptTitle
				  ,@RefNum AS RefNum
			FROM dbo.IPDOutcomeMaster AS IM
			LEFT OUTER JOIN dbo.IPDOutcome AS IC
			ON IC.RefSrNo = IM.SrNo 
			AND (IC.CompanyId = @CompanyId)
			--And (IC.StateId = @StateId)
			--AND IC.CMonth >=@CMonth AND IC.CMonth <=@EMonth 
			AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
			And (IC.CYear = @CYear)
			AND (IC.Htype = @Htype)
		END
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetPatientDeathComplex]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <08 August 19>
-- Description:	<Report - Display All Details.>
-- =============================================
-- execute RptGetPatientDeathDetails 7,2019,22,1,'',1,12
CREATE PROCEDURE [dbo].[RptGetPatientDeathComplex]
	@CMonth Int,
	@CYear Int,
	@HType Int, 
	@StateId int,
	@ReffNo Nvarchar(100),
	@CompanyId Bigint,
	@HType1 Int,
	@EMonth Int	
AS
BEGIN
 --   Declare @CompanyName as Nvarchar(500)
	--Declare @CAdd as Nvarchar(500)
 --   SELECT @CompanyName =C.CName,@CAdd =C.City +', ' + S.StateName FROM DBO.CompanyMaster AS C
	--INNER JOIN DBO.StateMaster AS S ON C.State =S.RecId 
	--WHERE C.RecId =@CompanyId 	
	
  SELECT (ROW_NUMBER() OVER(ORDER BY [RecId] ASC)) as SrNo
	  ,(CASE WHEN @HType = 22 THEN 'OUT-PATIENT DEATH COMPLEX' WHEN @HType=23 THEN 'IN-PATIENT DEATH COMPLEX' WHEN @HType = 25 THEN 'OUT-PATIENT DEATH MCC' WHEN @HType = 26 THEN 'IN-PATIENT DEATH MCC' ELSE ' ' END) + '(' + [dbo].[GetMonthName](@CMonth) +' - '+ Convert(nvarchar(4),@CYear) + ')' AS  SubTitle
      ,[Htype]
      ,[StateId]
      ,[CompanyId]
      ,[Decease] AS NameOfDeases
      ,(Case When [Sex] = 1 Then 'Male' Else 'Female' End) AS Sex
      ,CONVERT(Nvarchar(3),[Age] )+ ' yrs' AS Age
      ,[RefNo]
      ,[Address] AS HomeAddress
      ,CONVERT(Nvarchar(10),[DOA],101) AS DateOfAdmission
      ,CONVERT(Nvarchar(10),[DOD],101) AS DateOfDeath
      ,[CausesDeath] AS CausesOfDeath
      ,[Machine]
      ,[CreateDate]
      ,(SELECT C.CName FROM DBO.CompanyMaster AS C INNER JOIN DBO.StateMaster AS S ON C.State =S.RecId WHERE C.RecId = @CompanyId) as CompanyName 	 
      ,(SELECT C1.City +', ' + S1.StateName FROM DBO.CompanyMaster AS C1 INNER JOIN DBO.StateMaster AS S1 ON C1.State =S1.RecId WHERE C1.RecId = @CompanyId) as CAdd 	
  FROM [dbo].[DeathsDetails]
  WHERE (@CYear = 0 OR YEAR(CreateDate) = @CYear)
  --AND MONTH(CreateDate) >=@CMonth AND MONTH(CreateDate) <=@EMonth
  AND ((MONTH(CreateDate) >=@CMonth AND MONTH(CreateDate) <=@EMonth) OR @CMonth+@EMonth=0)
  AND (Htype = @HType OR Htype =@HType1)
  --AND (@StateId = 0 OR StateId = @StateId)
  --AND (@ReffNo = '' OR RefNo = @ReffNo)
  AND (@CompanyId = 0 OR CompanyId = @CompanyId)
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetPatientDeathDetails]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <08 August 19>
-- Description:	<Report - Display All Details.>
-- =============================================
-- execute RptGetPatientDeathDetails 7,2019,22,1,'',1,12
CREATE PROCEDURE [dbo].[RptGetPatientDeathDetails]
	@CMonth Int,
	@CYear Int,
	@HType Int, 
	@StateId int,
	@ReffNo Nvarchar(100),
	@CompanyId Bigint,
	@EMonth Int	
AS
BEGIN
 --   Declare @CompanyName as Nvarchar(500)
	--Declare @CAdd as Nvarchar(500)
 --   SELECT @CompanyName =C.CName,@CAdd =C.City +', ' + S.StateName FROM DBO.CompanyMaster AS C
	--INNER JOIN DBO.StateMaster AS S ON C.State =S.RecId 
	--WHERE C.RecId =@CompanyId 	
	
  SELECT (ROW_NUMBER() OVER(ORDER BY [RecId] ASC)) as SrNo
	  ,(CASE WHEN @HType = 22 THEN 'OUT-PATIENT DEATH GENERAL' WHEN @HType=23 THEN 'IN-PATIENT DEATH GENERAL' WHEN @HType = 25 THEN 'OUT-PATIENT DEATH MCC' WHEN @HType = 26 THEN 'IN-PATIENT DEATH MCC' ELSE ' ' END) + '(' + [dbo].[GetMonthName](@CMonth) +' - '+ Convert(nvarchar(4),@CYear) + ')' AS  SubTitle
      ,[Htype]
      ,[StateId]
      ,[CompanyId]
      ,[Decease] AS NameOfDeases
      ,(Case When [Sex] = 1 Then 'Male' Else 'Female' End) AS Sex
      ,CONVERT(Nvarchar(3),[Age] )+ ' yrs' AS Age
      ,[RefNo]
      ,[Address] AS HomeAddress
      ,CONVERT(Nvarchar(10),[DOA],101) AS DateOfAdmission
      ,CONVERT(Nvarchar(10),[DOD],101) AS DateOfDeath
      ,[CausesDeath] AS CausesOfDeath
      ,[Machine]
      ,[CreateDate]
      ,(SELECT C.CName FROM DBO.CompanyMaster AS C INNER JOIN DBO.StateMaster AS S ON C.State =S.RecId WHERE C.RecId = @CompanyId) as CompanyName 	 
      ,(SELECT C1.City +', ' + S1.StateName FROM DBO.CompanyMaster AS C1 INNER JOIN DBO.StateMaster AS S1 ON C1.State =S1.RecId WHERE C1.RecId = @CompanyId) as CAdd 	
  FROM [dbo].[DeathsDetails]
  WHERE (YEAR(CreateDate) = @CYear)
  --AND MONTH(CreateDate) >=@CMonth AND MONTH(CreateDate) <=@EMonth
  AND ((MONTH(CreateDate) >=@CMonth AND MONTH(CreateDate) <=@EMonth) OR @CMonth+@EMonth=0)
  AND (Htype = @HType)
  AND (CompanyId = @CompanyId)
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetSOOComplex]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <08 August 19>
-- Description:	<omtechsoft.com>
-- =============================================
-- execute [dbo].[RptGetSOOComplex] 7,2019,1,'',1,7,29,8,31,12
CREATE PROCEDURE [dbo].[RptGetSOOComplex]	
	@CMonth Int,
	@CYear Int,
	@StateId int,
	@ReffNo Nvarchar(100),
	@CompanyId Bigint,
	@HType int,
	@HType1 int,
	@HType2 int,
	@HType3 int,
	@EMonth Int
AS
BEGIN
	SET NOCOUNT ON;
	Declare @CompanyName as Nvarchar(500)
	Declare @CAdd as Nvarchar(500)
	Declare @SubTitle as Nvarchar(100)
	Declare @PeridFrom as Nvarchar(100)
	
	SELECT @CompanyName =C.CName,@CAdd =C.City +', ' + S.StateName FROM DBO.CompanyMaster AS C
	INNER JOIN DBO.StateMaster AS S ON C.State =S.RecId 
	WHERE C.RecId =@CompanyId 	
	
	select @SubTitle = 'COMPLEX' 
	select @PeridFrom = ('PERIOD...' + [dbo].[GetMonthName](@CMonth) +' - '+ Convert(nvarchar(4),@CYear)) 
	;with cte as (
	SELECT 
		SM.RecId ,
		SM.GroupId,
		SM.ServiceName,
		(SELECT SM1.ServiceName FROM dbo.ServicesMaster AS SM1 WHERE SM1.RecId =SM.ParentId) AS PServiceName
	FROM dbo.ServicesMaster AS SM
	WHERE SM.ParentId > 0 and GroupId=2)
	
	SELECT 
		(ROW_NUMBER() OVER(PARTITION BY SMT.PServiceName ORDER BY SMT.RecId ASC)) as SrNo,
		@CompanyName as CompanyName,
		@CAdd AS CAdd,
		CD.ServiceId,
		SMT.ServiceName,
		SMT.PServiceName ,
		'OUT-PATIENT CASES' AS OPDCases,
		SUM(CASE WHEN (CD.HType = @HType OR CD.HType = @HType2) AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS OPDMale,
		SUM(CASE WHEN (CD.HType = @HType OR CD.HType = @HType2)AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS OPDFeMale,
		'IN-PATIENT ADMISSION' AS IPDCases,
		SUM(CASE WHEN (CD.HType = @HType1 OR CD.HType = @HType3) AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS IPDMale,
		SUM(CASE WHEN (CD.HType = @HType1 OR CD.HType = @HType3) AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS IPDFeMale,
		@SubTitle as SubTitle,
		'ATTENDANCE BY STATE OF ORIGIN (SOO)' AS SubTitle2,
		@PeridFrom AS PeridFrom,
		@ReffNo AS ReffNo
	FROM cte SMT
	LEFT OUTER JOIN CaseDetail AS CD
	ON SMT.RecId =CD.ServiceId 
	--AND CD.CMonth >=@CMonth AND CD.CMonth <=@EMonth
	AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
	AND CD.CYear =@CYear 
	AND CD.CompanyId =@CompanyId
	AND (CD.HType = @HType1 OR CD.HType = @HType OR CD.HType = @HType2 OR CD.HType = @HType3)
	GROUP BY CD.ServiceId, SMT.RecId,SMT.ServiceName, SMT.PServiceName 
	ORDER BY SMT.RecId
END
GO
/****** Object:  StoredProcedure [dbo].[RptGetSOOGeneral]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <08 August 19>
-- Description:	<omtechsoft.com>
-- =============================================
-- execute [RptGetSOOGeneral] 10,2019,1,'',1,7,29
-- execute [RptGetSOOGeneral] 7,2019,1,'',1,7,29,12
CREATE PROCEDURE [dbo].[RptGetSOOGeneral]	
	@CMonth Int,
	@CYear Int,
	@StateId int,
	@ReffNo Nvarchar(100),
	@CompanyId Bigint,
	@HType int,
	@HType1 int,
	@EMonth Int
AS
BEGIN
	SET NOCOUNT ON;
	Declare @CompanyName as Nvarchar(500)
	Declare @CAdd as Nvarchar(500)
	Declare @SubTitle as Nvarchar(100)
	Declare @PeridFrom as Nvarchar(100)
	SELECT @CompanyName =C.CName,@CAdd =C.City +', ' + S.StateName FROM DBO.CompanyMaster AS C
	INNER JOIN DBO.StateMaster AS S ON C.State =S.RecId 
	WHERE C.RecId =@CompanyId 	
	
	--select @SubTitle = case WHEN @HType=7 THEN 'GENERAL' ELSE 'MCC' END + ' (' + [dbo].[GetMonthName](@CMonth) +' - '+ Convert(nvarchar(4),@CYear) + ')'
	select @SubTitle = case WHEN @HType=7 THEN 'GENERAL' ELSE 'MCC' END 
	select @PeridFrom = ('PERIOD...' + [dbo].[GetMonthName](@CMonth) +' - '+ Convert(nvarchar(4),@CYear)) 
	;with cte as (
	SELECT 
		SM.RecId ,
		SM.GroupId,
		SM.ServiceName,
		(SELECT SM1.ServiceName FROM dbo.ServicesMaster AS SM1 WHERE SM1.RecId =SM.ParentId) AS PServiceName
	FROM dbo.ServicesMaster AS SM
	WHERE SM.ParentId > 0 and GroupId=2)
	
	SELECT 
		(ROW_NUMBER() OVER(PARTITION BY SMT.PServiceName ORDER BY SMT.RecId ASC)) as SrNo,
		@CompanyName as CompanyName,
		@CAdd AS CAdd,
		CD.ServiceId,
		SMT.ServiceName,
		SMT.PServiceName ,
		'OUT-PATIENT CASES' AS OPDCases,
		SUM(CASE WHEN CD.HType = @HType AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS OPDMale,
		SUM(CASE WHEN CD.HType = @HType AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS OPDFeMale,
		'IN-PATIENT ADMISSION' AS IPDCases,
		SUM(CASE WHEN CD.HType = @HType1 AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS IPDMale,
		SUM(CASE WHEN CD.HType = @HType1 AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS IPDFeMale,
		@SubTitle as SubTitle,
		'ATTENDANCE BY STATE OF ORIGIN (SOO)' AS SubTitle2,
		@PeridFrom As PeridFrom,
		@ReffNo AS ReffNo
	FROM cte SMT
	LEFT OUTER JOIN CaseDetail AS CD
	ON SMT.RecId =CD.ServiceId 
	--AND CD.CMonth >=@CMonth AND CD.CMonth <=@EMonth
	AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
	AND CD.CYear =@CYear 
	AND CD.CompanyId =@CompanyId
	AND (CD.HType = @HType1 OR CD.HType = @HType)
	GROUP BY CD.ServiceId, SMT.RecId,SMT.ServiceName, SMT.PServiceName 
	ORDER BY SMT.RecId
END
GO
/****** Object:  StoredProcedure [dbo].[RptGovABAG]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <18 Jan 2020>
-- Htype 10 For GENERAL
-- Htype 12 For MCC
-- Htype -100 For COMPLEX
-- DateMode 1 For Get Data For Month and Year
-- DateMode 2 For Get Data For FromDate ToDate
-- =============================================
-- Execute RptGovABAG 0,0,2019,0,10,'1900/01/01','1900/01/01',1
-- Execute RptGovABAG 0,0,2019,0,12,'1900/01/01','1900/01/01',1
-- Execute RptGovABAG 0,0,2019,0,-100,'1900/01/01','1900/01/01',1
-- Execute RptGovABAG 0,0,2019,0,10,'2019/01/01','2019/12/31',2
-- Execute RptGovABAG 0,0,2019,0,12,'2019/01/01','2019/12/31',2
-- Execute RptGovABAG 0,0,2019,0,-100,'2019/01/01','2019/12/31',2
CREATE PROCEDURE [dbo].[RptGovABAG]
@CMonth Int,
@EMonth Int,
@CYear Int,
@CompanyId Bigint,
@HType Int,
@FromDate Datetime,
@ToDate Datetime,
@DateMode Int
AS
BEGIN
	IF (@DateMode = 1)
		BEGIN
			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName
				  ,SUM(CASE WHEN SM.ServiceName = 'UNDER 1 MONTHS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS UNDER_1_MTH
				  ,SUM(CASE WHEN SM.ServiceName = '1-11 MONTHS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'MTHS_1_11'
				  ,SUM(CASE WHEN SM.ServiceName = '1- 2 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_1_2'
				  ,SUM(CASE WHEN SM.ServiceName = '3 - 4 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_3_4'
				  ,SUM(CASE WHEN SM.ServiceName = '5 - 9 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_5_9'
				  ,SUM(CASE WHEN SM.ServiceName = '10 - 14 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_10_14'
				  ,SUM(CASE WHEN SM.ServiceName = '15 - 19 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_15_19'
				  ,SUM(CASE WHEN SM.ServiceName = '20 - 24 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_20_24'
				  ,SUM(CASE WHEN SM.ServiceName = '25 - 29 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_25_29'
				  ,SUM(CASE WHEN SM.ServiceName = '30 - 34 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_30_34'
				  ,SUM(CASE WHEN SM.ServiceName = '35 - 39 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_35_39'
				  ,SUM(CASE WHEN SM.ServiceName = '40 - 44 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_40_44'
				  ,SUM(CASE WHEN SM.ServiceName = '45 - 49 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_45_49'
				  ,SUM(CASE WHEN SM.ServiceName = '50 - 54 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_50_54'
				  ,SUM(CASE WHEN SM.ServiceName = ' 55- 59 YEARS ' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_55_59'
				  ,SUM(CASE WHEN SM.ServiceName = '60 - 64 YEARS ' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_60_64'
				  ,SUM(CASE WHEN SM.ServiceName = '65 - 69 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_65_69'
				  ,SUM(CASE WHEN SM.ServiceName = '70 - 74 YEARS ' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_70_74'
				  ,SUM(CASE WHEN SM.ServiceName = '75 - 79 YEARS ' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_75_79'
				  ,SUM(CASE WHEN SM.ServiceName = '80 - 84 YEARS ' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_80_84'
				  ,SUM(CASE WHEN SM.ServiceName = '85 YEARS & ABOVE' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_85_ABOVE'
				  ,SUM(CASE WHEN SM.ServiceName = 'UNKNOWN' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS UNKNOWN
				  ,SUM(CASE WHEN SM.ServiceName IN ('UNDER 1 MONTHS','1-11 MONTHS','1- 2 YEARS','3 - 4 YEARS','5 - 9 YEARS','10 - 14 YEARS','15 - 19 YEARS','20 - 24 YEARS','25 - 29 YEARS','30 - 34 YEARS','35 - 39 YEARS','40 - 44 YEARS','45 - 49 YEARS','50 - 54 YEARS',' 55- 59 YEARS ','60 - 64 YEARS ','65 - 69 YEARS','70 - 74 YEARS ','75 - 79 YEARS ','80 - 84 YEARS ','85 YEARS & ABOVE','UNKNOWN')
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.CaseDetail AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE ((CD.CMonth >= @CMonth AND CD.CMonth <= @EMonth) OR (@CMonth + @EMonth = 0))
			AND (CD.CYear = @CYear)
			AND (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.HType = @HType OR (@HType = -100 AND CD.HType IN (10,12)))
			AND (CD.CaseType = 1)
			GROUP BY CM.CName
		END
	ELSE IF (@DateMode = 2)
		BEGIN
			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName
				  ,SUM(CASE WHEN SM.ServiceName = 'UNDER 1 MONTHS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS UNDER_1_MTH
				  ,SUM(CASE WHEN SM.ServiceName = '1-11 MONTHS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'MTHS_1_11'
				  ,SUM(CASE WHEN SM.ServiceName = '1- 2 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_1_2'
				  ,SUM(CASE WHEN SM.ServiceName = '3 - 4 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_3_4'
				  ,SUM(CASE WHEN SM.ServiceName = '5 - 9 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_5_9'
				  ,SUM(CASE WHEN SM.ServiceName = '10 - 14 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_10_14'
				  ,SUM(CASE WHEN SM.ServiceName = '15 - 19 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_15_19'
				  ,SUM(CASE WHEN SM.ServiceName = '20 - 24 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_20_24'
				  ,SUM(CASE WHEN SM.ServiceName = '25 - 29 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_25_29'
				  ,SUM(CASE WHEN SM.ServiceName = '30 - 34 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_30_34'
				  ,SUM(CASE WHEN SM.ServiceName = '35 - 39 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_35_39'
				  ,SUM(CASE WHEN SM.ServiceName = '40 - 44 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_40_44'
				  ,SUM(CASE WHEN SM.ServiceName = '45 - 49 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_45_49'
				  ,SUM(CASE WHEN SM.ServiceName = '50 - 54 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_50_54'
				  ,SUM(CASE WHEN SM.ServiceName = ' 55- 59 YEARS ' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_55_59'
				  ,SUM(CASE WHEN SM.ServiceName = '60 - 64 YEARS ' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_60_64'
				  ,SUM(CASE WHEN SM.ServiceName = '65 - 69 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_65_69'
				  ,SUM(CASE WHEN SM.ServiceName = '70 - 74 YEARS ' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_70_74'
				  ,SUM(CASE WHEN SM.ServiceName = '75 - 79 YEARS ' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_75_79'
				  ,SUM(CASE WHEN SM.ServiceName = '80 - 84 YEARS ' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_80_84'
				  ,SUM(CASE WHEN SM.ServiceName = '85 YEARS & ABOVE' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_85_ABOVE'
				  ,SUM(CASE WHEN SM.ServiceName = 'UNKNOWN' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS UNKNOWN
				  ,SUM(CASE WHEN SM.ServiceName IN ('UNDER 1 MONTHS','1-11 MONTHS','1- 2 YEARS','3 - 4 YEARS','5 - 9 YEARS','10 - 14 YEARS','15 - 19 YEARS','20 - 24 YEARS','25 - 29 YEARS','30 - 34 YEARS','35 - 39 YEARS','40 - 44 YEARS','45 - 49 YEARS','50 - 54 YEARS',' 55- 59 YEARS ','60 - 64 YEARS ','65 - 69 YEARS','70 - 74 YEARS ','75 - 79 YEARS ','80 - 84 YEARS ','85 YEARS & ABOVE','UNKNOWN')
							THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.fn_CaseDetailDateWise(@FromDate,@ToDate) AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.HType = @HType OR (@HType = -100 AND CD.HType IN (10,12)))
			AND (CD.CaseType = 1)
			GROUP BY CM.CName
		END
END
GO
/****** Object:  StoredProcedure [dbo].[RptGovDBAGIP]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <18 Jan 2020>
-- Htype 11 For GENERAL
-- Htype 13 For MCC
-- Htype -100 For COMPLEX
-- DateMode 1 For Get Data For Month and Year
-- DateMode 2 For Get Data For FromDate ToDate
-- =============================================
-- Execute RptGovDBAGIP 0,0,2019,0,11,'1900/01/01','1900/01/01',1
-- Execute RptGovDBAGIP 0,0,2019,0,13,'1900/01/01','1900/01/01',1
-- Execute RptGovDBAGIP 0,0,2019,0,-100,'1900/01/01','1900/01/01',1
-- Execute RptGovDBAGIP 0,0,2019,0,11,'2019/01/01','2019/12/31',2
-- Execute RptGovDBAGIP 0,0,2019,0,13,'2019/01/01','2019/12/31',2
-- Execute RptGovDBAGIP 0,0,2019,0,-100,'2019/01/01','2019/12/31',2
CREATE PROCEDURE [dbo].[RptGovDBAGIP]
@CMonth Int,
@EMonth Int,
@CYear Int,
@CompanyId Bigint,
@HType Int,
@FromDate Datetime,
@ToDate Datetime,
@DateMode Int
AS
BEGIN
	IF (@DateMode = 1)
		BEGIN
			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName
				  ,SUM(CASE WHEN SM.ServiceName = 'UNDER 1 MONTHS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS UNDER_1_MTH
				  ,SUM(CASE WHEN SM.ServiceName = '1-11 MONTHS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'MTHS_1_11'
				  ,SUM(CASE WHEN SM.ServiceName = '1- 2 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_1_2'
				  ,SUM(CASE WHEN SM.ServiceName = '3 - 4 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_3_4'
				  ,SUM(CASE WHEN SM.ServiceName = '5 - 9 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_5_9'
				  ,SUM(CASE WHEN SM.ServiceName = '10 - 14 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_10_14'
				  ,SUM(CASE WHEN SM.ServiceName = '15 - 19 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_15_19'
				  ,SUM(CASE WHEN SM.ServiceName = '20 - 24 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_20_24'
				  ,SUM(CASE WHEN SM.ServiceName = '25 - 29 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_25_29'
				  ,SUM(CASE WHEN SM.ServiceName = '30 - 34 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_30_34'
				  ,SUM(CASE WHEN SM.ServiceName = '35 - 39 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_35_39'
				  ,SUM(CASE WHEN SM.ServiceName = '40 - 44 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_40_44'
				  ,SUM(CASE WHEN SM.ServiceName = '45 - 49 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_45_49'
				  ,SUM(CASE WHEN SM.ServiceName = '50 - 54 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_50_54'
				  ,SUM(CASE WHEN SM.ServiceName = ' 55- 59 YEARS ' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_55_59'
				  ,SUM(CASE WHEN SM.ServiceName = '60 - 64 YEARS ' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_60_64'
				  ,SUM(CASE WHEN SM.ServiceName = '65 - 69 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_65_69'
				  ,SUM(CASE WHEN SM.ServiceName = '70 - 74 YEARS ' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_70_74'
				  ,SUM(CASE WHEN SM.ServiceName = '75 - 79 YEARS ' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_75_79'
				  ,SUM(CASE WHEN SM.ServiceName = '80 - 84 YEARS ' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_80_84'
				  ,SUM(CASE WHEN SM.ServiceName = '85 YEARS & ABOVE' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_85_ABOVE'
				  ,SUM(CASE WHEN SM.ServiceName = 'UNKNOWN' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS UNKNOWN
				  ,SUM(CASE WHEN SM.ServiceName IN ('UNDER 1 MONTHS','1-11 MONTHS','1- 2 YEARS','3 - 4 YEARS','5 - 9 YEARS','10 - 14 YEARS','15 - 19 YEARS','20 - 24 YEARS','25 - 29 YEARS','30 - 34 YEARS','35 - 39 YEARS','40 - 44 YEARS','45 - 49 YEARS','50 - 54 YEARS',' 55- 59 YEARS ','60 - 64 YEARS ','65 - 69 YEARS','70 - 74 YEARS ','75 - 79 YEARS ','80 - 84 YEARS ','85 YEARS & ABOVE','UNKNOWN')
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.CaseDetail AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE ((CD.CMonth >= @CMonth AND CD.CMonth <= @EMonth) OR (@CMonth + @EMonth = 0))
			AND (CD.CYear = @CYear)
			AND (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.HType = @HType OR (@HType = -100 AND CD.HType IN (11,13)))
			AND (CD.CaseType = 1)
			GROUP BY CM.CName
		END
	ELSE IF (@DateMode = 2)
		BEGIN
			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName
				  ,SUM(CASE WHEN SM.ServiceName = 'UNDER 1 MONTHS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS UNDER_1_MTH
				  ,SUM(CASE WHEN SM.ServiceName = '1-11 MONTHS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'MTHS_1_11'
				  ,SUM(CASE WHEN SM.ServiceName = '1- 2 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_1_2'
				  ,SUM(CASE WHEN SM.ServiceName = '3 - 4 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_3_4'
				  ,SUM(CASE WHEN SM.ServiceName = '5 - 9 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_5_9'
				  ,SUM(CASE WHEN SM.ServiceName = '10 - 14 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_10_14'
				  ,SUM(CASE WHEN SM.ServiceName = '15 - 19 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_15_19'
				  ,SUM(CASE WHEN SM.ServiceName = '20 - 24 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_20_24'
				  ,SUM(CASE WHEN SM.ServiceName = '25 - 29 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_25_29'
				  ,SUM(CASE WHEN SM.ServiceName = '30 - 34 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_30_34'
				  ,SUM(CASE WHEN SM.ServiceName = '35 - 39 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_35_39'
				  ,SUM(CASE WHEN SM.ServiceName = '40 - 44 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_40_44'
				  ,SUM(CASE WHEN SM.ServiceName = '45 - 49 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_45_49'
				  ,SUM(CASE WHEN SM.ServiceName = '50 - 54 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_50_54'
				  ,SUM(CASE WHEN SM.ServiceName = ' 55- 59 YEARS ' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_55_59'
				  ,SUM(CASE WHEN SM.ServiceName = '60 - 64 YEARS ' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_60_64'
				  ,SUM(CASE WHEN SM.ServiceName = '65 - 69 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_65_69'
				  ,SUM(CASE WHEN SM.ServiceName = '70 - 74 YEARS ' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_70_74'
				  ,SUM(CASE WHEN SM.ServiceName = '75 - 79 YEARS ' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_75_79'
				  ,SUM(CASE WHEN SM.ServiceName = '80 - 84 YEARS ' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_80_84'
				  ,SUM(CASE WHEN SM.ServiceName = '85 YEARS & ABOVE' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_85_ABOVE'
				  ,SUM(CASE WHEN SM.ServiceName = 'UNKNOWN' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS UNKNOWN
				  ,SUM(CASE WHEN SM.ServiceName IN ('UNDER 1 MONTHS','1-11 MONTHS','1- 2 YEARS','3 - 4 YEARS','5 - 9 YEARS','10 - 14 YEARS','15 - 19 YEARS','20 - 24 YEARS','25 - 29 YEARS','30 - 34 YEARS','35 - 39 YEARS','40 - 44 YEARS','45 - 49 YEARS','50 - 54 YEARS',' 55- 59 YEARS ','60 - 64 YEARS ','65 - 69 YEARS','70 - 74 YEARS ','75 - 79 YEARS ','80 - 84 YEARS ','85 YEARS & ABOVE','UNKNOWN')
							THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.fn_CaseDetailDateWise(@FromDate,@ToDate) AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.HType = @HType OR (@HType = -100 AND CD.HType IN (11,13)))
			AND (CD.CaseType = 1)
			GROUP BY CM.CName
		END
END
GO
/****** Object:  StoredProcedure [dbo].[RptGovIPS]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <18 Jan 2020>
-- Htype 150 For GENERAL
-- Htype 151 For MCC
-- Htype -100 For COMPLEX
-- =============================================
-- Execute RptGovIPS 0,0,2019,0,150
-- Execute RptGovIPS 0,0,2019,0,151
-- Execute RptGovIPS 0,0,2019,0,-100
CREATE PROCEDURE [dbo].[RptGovIPS]
@CMonth Int,
@EMonth Int,
@CYear Int,
@CompanyId Bigint,
@HType Int
AS
BEGIN
	DECLARE @DayCount AS INT

	SELECT @DayCount = SUM(MonthTotalDays)
	FROM dbo.MonthDays
	WHERE (MonthId >= @CMonth AND MonthId <= @EMonth)
	OR (@CMonth = 0 AND @EMonth = 0)

	SELECT 0 AS SrNo
			,T.HospitalName
			,SUM(T.BED_COMPLEMENT_BEDS) AS BED_COMPLEMENT_BEDS
			,SUM(T.BED_COMPLEMENT_CRADLES) AS BED_COMPLEMENT_CRADLES
			,SUM(T.BED_COMPLEMENT_COTS) AS BED_COMPLEMENT_COTS
			,SUM(T.BED_COMPLEMENT_INCUBATOR) AS BED_COMPLEMENT_INCUBATOR
			,SUM(T.BED_COMPLEMENT_TOTAL) AS BED_COMPLEMENT_TOTAL
			,SUM(T.ADMISSIONS_MALE) AS ADMISSIONS_MALE
			,SUM(T.ADMISSIONS_FEMALE) AS ADMISSIONS_FEMALE
			,SUM(T.ADMISSIONS_TOTAL) AS ADMISSIONS_TOTAL
			,SUM(T.DISCHARGES_MALE) AS DISCHARGES_MALE
			,SUM(T.DISCHARGES_FEMALE) AS DISCHARGES_FEMALE
			,SUM(T.DISCHARGES_TOTAL) AS DISCHARGES_TOTAL
			,SUM(T.DEATHS_MALE) AS DEATHS_MALE
			,SUM(T.DEATHS_FEMALE) AS DEATHS_FEMALE
			,SUM(T.DEATHS_TOTAL) AS DEATHS_TOTAL
			,CONVERT(DECIMAL(10,2),SUM(T.BED_OCCUPANCY)) AS BED_OCCUPANCY
			,CONVERT(DECIMAL(10,2),SUM(T.CASE_FATALITY_RATES)) AS CASE_FATALITY_RATES
			,SUM(T.CASUALTY) AS CASUALTY
			,SUM(T.OBD) AS OBD
			,SUM(T.CUMULATIVE_PATIENT_DAYS) AS CUMULATIVE_PATIENT_DAYS
			,SUM(T.AVAILABLE_BED) AS AVAILABLE_BED
			,SUM(T.VACANT_BED) AS VACANT_BED
			,CONVERT(DECIMAL(10,2),SUM(T.AVERAGE_LENGTH_OF_STAY)) AS AVERAGE_LENGTH_OF_STAY
	FROM
	(
		SELECT 0 AS SrNo
				,CM.CName AS HospitalName
				,SUM(ISNULL(HB.Beds,0)) AS BED_COMPLEMENT_BEDS
				,SUM(ISNULL(HB.Cradles,0)) AS BED_COMPLEMENT_CRADLES
				,SUM(ISNULL(HB.Cots,0)) AS BED_COMPLEMENT_COTS
				,SUM(ISNULL(HB.Incubator,0)) AS BED_COMPLEMENT_INCUBATOR
				,SUM(ISNULL(HB.Beds,0) + ISNULL(HB.Cradles,0) + ISNULL(HB.Cots,0) + ISNULL(HB.Incubator,0)) AS BED_COMPLEMENT_TOTAL
				,0 AS ADMISSIONS_MALE
				,0 AS ADMISSIONS_FEMALE
				,0 AS ADMISSIONS_TOTAL
				,0 AS DISCHARGES_MALE
				,0 AS DISCHARGES_FEMALE
				,0 AS DISCHARGES_TOTAL
				,0 AS DEATHS_MALE
				,0 AS DEATHS_FEMALE
				,0 AS DEATHS_TOTAL
				,0 AS BED_OCCUPANCY
				,0 AS CASE_FATALITY_RATES
				,SUM((CASE WHEN HBM.SrNo = 2 THEN ISNULL(HB.Beds,0) + ISNULL(HB.Cradles,0) + ISNULL(HB.Cots,0) + ISNULL(HB.Incubator,0) ELSE 0 END)) AS CASUALTY
				,0 AS OBD
				,0 AS CUMULATIVE_PATIENT_DAYS
				,0 AS AVAILABLE_BED
				,0 AS VACANT_BED
				,0 AS AVERAGE_LENGTH_OF_STAY
		FROM dbo.CompanyMaster AS CM
		INNER JOIN dbo.HospitalBeds AS HB
		ON CM.RecId = HB.CompanyId
		INNER JOIN dbo.HospitalBedMaster AS HBM
		ON HB.RefSrNo = HBM.SrNo
		WHERE ((HB.CMonth >= @CMonth AND HB.CMonth <= @EMonth) OR (@CMonth + @EMonth = 0))
		AND (HB.CYear = @CYear)
		AND (HB.CompanyId = @CompanyId OR @CompanyId = 0)
		AND (HB.Htype = @HType OR (@HType = -100 AND HB.Htype IN (150,151)))
		GROUP BY CM.CName
		UNION ALL
		SELECT 0 AS SrNo
				,CM.CName AS HospitalName
				,0 AS BED_COMPLEMENT_BEDS
				,0 AS BED_COMPLEMENT_CRADLES
				,0 AS BED_COMPLEMENT_COTS
				,0 AS BED_COMPLEMENT_INCUBATOR
				,0 AS BED_COMPLEMENT_TOTAL
				,SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'ADMISSIONS' THEN ISNULL(IPO.MALE,0) ELSE 0 END) AS ADMISSIONS_MALE
				,SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'ADMISSIONS' THEN ISNULL(IPO.FEMALE,0) ELSE 0 END) AS ADMISSIONS_FEMALE
				,SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'ADMISSIONS' THEN ISNULL(IPO.MALE,0) + ISNULL(IPO.FEMALE,0) ELSE 0 END) AS ADMISSIONS_TOTAL
				,SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'DISCHARGES' THEN ISNULL(IPO.MALE,0) ELSE 0 END) AS DISCHARGES_MALE
				,SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'DISCHARGES' THEN ISNULL(IPO.FEMALE,0) ELSE 0 END) AS DISCHARGES_FEMALE
				,SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'DISCHARGES' THEN ISNULL(IPO.MALE,0) + ISNULL(IPO.FEMALE,0) ELSE 0 END) AS DISCHARGES_TOTAL
				,SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'DEATHS' THEN ISNULL(IPO.MALE,0) ELSE 0 END) AS DEATHS_MALE
				,SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'DEATHS' THEN ISNULL(IPO.FEMALE,0) ELSE 0 END) AS DEATHS_FEMALE
				,SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'DEATHS' THEN ISNULL(IPO.MALE,0) + ISNULL(IPO.FEMALE,0) ELSE 0 END) AS DEATHS_TOTAL
				,CONVERT(DECIMAL(10,2),(SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'CUMMULATIVE PATIENT DAYS'
												THEN ISNULL(IPO.MALE,0) + ISNULL(IPO.FEMALE,0)
												ELSE 0 END) * 100)) /
				(CASE WHEN (SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'AVAILABLE BED'
									THEN ISNULL(IPO.MALE,0) + ISNULL(IPO.FEMALE,0)
									ELSE 0 END)) > 0 
						THEN CONVERT(DECIMAL(10,2),(SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'AVAILABLE BED'
									THEN ISNULL(IPO.MALE,0)
									ELSE 0 END)) * @DayCount)
						ELSE 1 END) AS BED_OCCUPANCY
				,CONVERT(DECIMAL(10,2),(SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'DEATHS'
												THEN ISNULL(IPO.MALE,0) + ISNULL(IPO.FEMALE,0)
												ELSE 0 END) * 100)) /
				CONVERT(DECIMAL(10,2),SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'ADMISSIONS'
												THEN ISNULL(IPO.MALE,0) + ISNULL(IPO.FEMALE,0)
												ELSE 0 END)) AS CASE_FATALITY_RATES
				,0 AS CASUALTY
				,0 AS OBD
				,SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'CUMMULATIVE PATIENT DAYS'
						THEN ISNULL(IPO.MALE,0) + ISNULL(IPO.FEMALE,0)
						ELSE 0 END) AS CUMULATIVE_PATIENT_DAYS
				,SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'AVAILABLE BED'
						THEN ISNULL(IPO.MALE,0)
						ELSE 0 END) AS AVAILABLE_BED
				,ISNULL(((CASE WHEN SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'AVAILABLE BED' THEN ISNULL(IPO.MALE,0) ELSE 0 END) > 0
								THEN SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'AVAILABLE BED' THEN ISNULL(IPO.MALE,0) ELSE 0 END)
								ELSE 0 END) * @DayCount) -
								SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'CUMMULATIVE PATIENT DAYS' THEN ISNULL(IPO.MALE,0) + ISNULL(IPO.FEMALE,0)
								ELSE 0 END),0) AS VACANT_BED
				,CONVERT(DECIMAL(10,2),SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'CUMMULATIVE PATIENT DAYS'
											THEN ISNULL(IPO.MALE,0) + ISNULL(IPO.FEMALE,0)
											ELSE 0 END)) /
				CONVERT(DECIMAL(10,2),(CASE WHEN (SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'DISCHARGES' THEN ISNULL(IPO.MALE,0) + ISNULL(IPO.FEMALE,0) ELSE 0 END) + SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'DEATHS' THEN ISNULL(IPO.MALE,0) + ISNULL(IPO.FEMALE,0) ELSE 0 END)) > 0
											THEN (SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'DISCHARGES' THEN ISNULL(IPO.MALE,0) + ISNULL(IPO.FEMALE,0) ELSE 0 END) + SUM(CASE WHEN IPOM.BEDCOMPLEMENT = 'DEATHS' THEN ISNULL(IPO.MALE,0) + ISNULL(IPO.FEMALE,0) ELSE 0 END))
											ELSE 1 END)) AS AVERAGE_LENGTH_OF_STAY
		FROM dbo.CompanyMaster AS CM
		INNER JOIN dbo.IPDOutcome AS IPO
		ON CM.RecId = IPO.CompanyId
		INNER JOIN dbo.IPDOutcomeMaster AS IPOM
		ON IPO.RefSrNo = IPOM.SrNo
		WHERE ((IPO.CMonth >= @CMonth AND IPO.CMonth <= @EMonth) OR (@CMonth + @EMonth = 0))
		AND (IPO.CYear = @CYear)
		AND (IPO.CompanyId = @CompanyId OR @CompanyId = 0)
		AND (IPO.Htype = @HType OR (@HType = -100 AND IPO.Htype IN (150,151)))
		GROUP BY CM.CName
	) AS T
	GROUP BY T.HospitalName
END
GO
/****** Object:  StoredProcedure [dbo].[RptGovMA]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <18 Jan 2020>
-- Htype 1 For GENERAL
-- Htype 2 For MCC
-- Htype -100 For COMPLEX
-- DateMode 1 For Get Data For Month and Year
-- DateMode 2 For Get Data For FromDate ToDate
-- =============================================
-- Execute RptGovMA 0,0,2019,0,1,'1900/01/01','1900/01/01',1
-- Execute RptGovMA 0,0,2019,0,2,'1900/01/01','1900/01/01',1
-- Execute RptGovMA 0,0,2019,0,-100,'1900/01/01','1900/01/01',1
-- Execute RptGovMA 0,0,2019,0,1,'2019/01/01','2019/12/31',2
-- Execute RptGovMA 0,0,2019,0,2,'2019/01/01','2019/12/31',2
-- Execute RptGovMA 0,0,2019,0,-100,'2019/01/01','2019/12/31',2
CREATE PROCEDURE [dbo].[RptGovMA]
@CMonth Int,
@EMonth Int,
@CYear Int,
@CompanyId Bigint,
@HType Int,
@FromDate Datetime,
@ToDate Datetime,
@DateMode Int
AS
BEGIN
	IF (@DateMode = 1)
		BEGIN
			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName
				  ,SUM(CASE WHEN SM.ServiceName = 'Injection' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INJECTION
				  ,SUM(CASE WHEN SM.ServiceName = 'Immunization' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS IMMUNIZATION
				  ,SUM(CASE WHEN SM.ServiceName = 'VCT' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS VCT
				  ,SUM(CASE WHEN SM.ServiceName = 'ECG' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ECG
				  ,SUM(CASE WHEN SM.ServiceName = 'Dressing' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DRESSING
				  ,SUM(CASE WHEN SM.ServiceName = 'Preregristration' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PRE_REGRISTRATION
				  ,SUM(CASE WHEN SM.ServiceName = 'NUTRITION' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NUTRITION
				  ,SUM(CASE WHEN SM.ServiceName = 'Daycare' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DAYCARE
				  ,SUM(CASE WHEN SM.ServiceName = 'X-ray' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS X_RAY
				  ,SUM(CASE WHEN SM.ServiceName = 'Scan' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SCAN
				  ,SUM(CASE WHEN SM.ServiceName = 'Dietetics' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DIETETICS
				  ,SUM(CASE WHEN SM.ServiceName = 'PNC' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PNC
				  ,SUM(CASE WHEN SM.ServiceName = 'Family Planning' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FAMILY_PLANNING
				  ,SUM(CASE WHEN SM.ServiceName = 'Lab Service' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS LABORATORY_SERVICES
				  ,SUM(CASE WHEN SM.ServiceName = 'OPD Theatre' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OP_THEATRE
				  ,SUM(CASE WHEN SM.ServiceName = 'Medical Exam' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MEDICAL_EXAM
				  ,SUM(CASE WHEN SM.ServiceName IN ('Injection','Immunization','VCT','ECG','Dressing','Preregristration','NUTRITION','Daycare','X-ray','Scan','Dietetics','PNC','Family Planning','Lab Service','OPD Theatre','Medical Exam')
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.CaseDetail AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE ((CD.CMonth >= @CMonth AND CD.CMonth <= @EMonth) OR (@CMonth + @EMonth = 0))
			AND (CD.CYear = @CYear)
			AND (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.HType = @HType OR (@HType = -100 AND CD.HType IN (1,2)))
			AND (SM.GroupId = 10)
			GROUP BY CM.CName
		END
	ELSE IF (@DateMode = 2)
		BEGIN
			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName
				  ,SUM(CASE WHEN SM.ServiceName = 'Injection' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INJECTION
				  ,SUM(CASE WHEN SM.ServiceName = 'Immunization' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS IMMUNIZATION
				  ,SUM(CASE WHEN SM.ServiceName = 'VCT' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS VCT
				  ,SUM(CASE WHEN SM.ServiceName = 'ECG' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ECG
				  ,SUM(CASE WHEN SM.ServiceName = 'Dressing' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DRESSING
				  ,SUM(CASE WHEN SM.ServiceName = 'Preregristration' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PRE_REGRISTRATION
				  ,SUM(CASE WHEN SM.ServiceName = 'NUTRITION' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NUTRITION
				  ,SUM(CASE WHEN SM.ServiceName = 'Daycare' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DAYCARE
				  ,SUM(CASE WHEN SM.ServiceName = 'X-ray' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS X_RAY
				  ,SUM(CASE WHEN SM.ServiceName = 'Scan' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SCAN
				  ,SUM(CASE WHEN SM.ServiceName = 'Dietetics' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DIETETICS
				  ,SUM(CASE WHEN SM.ServiceName = 'PNC' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PNC
				  ,SUM(CASE WHEN SM.ServiceName = 'Family Planning' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FAMILY_PLANNING
				  ,SUM(CASE WHEN SM.ServiceName = 'Lab Service' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS LABORATORY_SERVICES
				  ,SUM(CASE WHEN SM.ServiceName = 'OPD Theatre' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OP_THEATRE
				  ,SUM(CASE WHEN SM.ServiceName = 'Medical Exam' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MEDICAL_EXAM
				  ,SUM(CASE WHEN SM.ServiceName IN ('Injection','Immunization','VCT','ECG','Dressing','Preregristration','NUTRITION','Daycare','X-ray','Scan','Dietetics','PNC','Family Planning','Lab Service','OPD Theatre','Medical Exam')
							THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.fn_CaseDetailDateWise(@FromDate,@ToDate) AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.HType = @HType OR (@HType = -100 AND CD.HType IN (1,2)))
			AND (SM.GroupId = 10)
			GROUP BY CM.CName
		END
END
GO
/****** Object:  StoredProcedure [dbo].[RptGovMCPBA]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <09 Mar 2020>
-- Htype 101,102,103,106,107,108 - For 1 To 14 Age
-- Htype 104,109 - For 15 To 49 Age
-- Htype 105,110 - For 50 And Above Age
-- DateMode 1 For Get Data For Month and Year
-- DateMode 2 For Get Data For FromDate ToDate
-- =============================================
-- Execute RptGovMCPBA 0,0,2019,0,'1900/01/01','1900/01/01',1
-- Execute RptGovMCPBA 0,0,2019,0,'2019/01/01','2019/12/31',2
CREATE PROCEDURE [dbo].[RptGovMCPBA]
@CMonth Int,
@EMonth Int,
@CYear Int,
@CompanyId Bigint,
@FromDate Datetime,
@ToDate Datetime,
@DateMode Int
AS
BEGIN
	IF (@DateMode = 1)
		BEGIN
			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName

				  ,SUM(CASE WHEN SM.ServiceName = 'A00 - Cholera' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CHOLERA_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'A00 - Cholera' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CHOLERA_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'A00 - Cholera' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CHOLERA_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'A01 - Typhoid and parathyphoid fevers' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TYPHOID_FEVER_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'A01 - Typhoid and parathyphoid fevers' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TYPHOID_FEVER_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'A01 - Typhoid and parathyphoid fevers' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TYPHOID_FEVER_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DIARRHOEA_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DIARRHOEA_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DIARRHOEA_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 96 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TUBERCULOSIS_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 96 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TUBERCULOSIS_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 96 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TUBERCULOSIS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 102 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ZOONATIC_INFECTION_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 102 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ZOONATIC_INFECTION_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 102 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ZOONATIC_INFECTION_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'A35 - Other Tetanus' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TETANUS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'A35 - Other Tetanus' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TETANUS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'A35 - Other Tetanus' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TETANUS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'A40 - Streptococcal Septicaemia' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS STREPTOCOCCAL_SEPTICAEMIA_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'A40 - Streptococcal Septicaemia' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS STREPTOCOCCAL_SEPTICAEMIA_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'A40 - Streptococcal Septicaemia' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS STREPTOCOCCAL_SEPTICAEMIA_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 112 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_BACTERIA_DXS_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 112 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_BACTERIA_DXS_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 112 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_BACTERIA_DXS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'A64 - Unspecified sexually transmitted disease' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SEXUALLY_TRANSMITTED_DISEASES_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'A64 - Unspecified sexually transmitted disease' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SEXUALLY_TRANSMITTED_DISEASES_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'A64 - Unspecified sexually transmitted disease' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SEXUALLY_TRANSMITTED_DISEASES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'A80 - Acute poliomyelitis' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POLIOMYELITES_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'A80 - Acute poliomyelitis' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POLIOMYELITES_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'A80 - Acute poliomyelitis' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POLIOMYELITES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'A82 - Rabies' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS RABIES_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'A82 - Rabies' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS RABIES_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'A82 - Rabies' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS RABIES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 158 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 158 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 158 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'A95 - Yellow fever' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS YELLOW_FEVER_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'A95 - Yellow fever' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS YELLOW_FEVER_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'A95 - Yellow fever' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS YELLOW_FEVER_50ANDABOVE
		  
				  ,SUM(CASE WHEN SM.ServiceName = 'B01 - Varicella (chicken pox)' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CHICKEN_POX_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'B01 - Varicella (chicken pox)' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CHICKEN_POX_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'B01 - Varicella (chicken pox)' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CHICKEN_POX_50ANDABOVE
		  
				  ,SUM(CASE WHEN SM.ServiceName = 'B05 - Measles' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MEASLES_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'B05 - Measles' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MEASLES_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'B05 - Measles' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MEASLES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'B02 - Zoster (herpes zoster)' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HERPES_ZOSTER_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'B02 - Zoster (herpes zoster)' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HERPES_ZOSTER_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'B02 - Zoster (herpes zoster)' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HERPES_ZOSTER_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'B07 - Viral warts' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS VIRAL_WARTS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'B07 - Viral warts' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS VIRAL_WARTS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'B07 - Viral warts' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS VIRAL_WARTS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 184 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS VIRAL_HEPATITIS_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 184 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS VIRAL_HEPATITIS_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 184 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS VIRAL_HEPATITIS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'B24 - Unspecified HIV diseases/Immuno suppression' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HIV_DISEASES_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'B24 - Unspecified HIV diseases/Immuno suppression' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HIV_DISEASES_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'B24 - Unspecified HIV diseases/Immuno suppression' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HIV_DISEASES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 194 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_VIRAL_DXS_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 194 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_VIRAL_DXS_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 194 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_VIRAL_DXS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 200 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MYCOSES_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 200 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MYCOSES_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 200 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MYCOSES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'B54 - Unspecified Malaria' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALARIA_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'B54 - Unspecified Malaria' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALARIA_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'B54 - Unspecified Malaria' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALARIA_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 221 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HELMINTHIASIS_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 221 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HELMINTHIASIS_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 221 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HELMINTHIASIS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HOOKWORM_DISEASES_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HOOKWORM_DISEASES_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HOOKWORM_DISEASES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'B77 - Ascariasis' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ASCARIASIS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'B77 - Ascariasis' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ASCARIASIS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'B77 - Ascariasis' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ASCARIASIS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'B83 - Other Helminthiases' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_HELMINTHIASIS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'B83 - Other Helminthiases' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_HELMINTHIASIS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'B83 - Other Helminthiases' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_HELMINTHIASIS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'C17 - Malignant Neoplasm of Small Intestines' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'C17 - Malignant Neoplasm of Small Intestines' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'C17 - Malignant Neoplasm of Small Intestines' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'C44 -  Other Malignant Neoplasm of Skin' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_SKIN_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'C44 -  Other Malignant Neoplasm of Skin' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_SKIN_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'C44 -  Other Malignant Neoplasm of Skin' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_SKIN_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'C34 - Malignant Neoplasm of Bronchus & Lung' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LUNG_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'C34 - Malignant Neoplasm of Bronchus & Lung' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LUNG_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'C34 - Malignant Neoplasm of Bronchus & Lung' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LUNG_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_BONE_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_BONE_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_BONE_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MALIGNANT_NEOPLASM_DISEASES_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MALIGNANT_NEOPLASM_DISEASES_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MALIGNANT_NEOPLASM_DISEASES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'K74 - Fibrosis and cirrhosis of liver' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FIBROID_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'K74 - Fibrosis and cirrhosis of liver' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FIBROID_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'K74 - Fibrosis and cirrhosis of liver' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FIBROID_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'C61 - Malignant Neoplasms of Prostate' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BENIGH_PROSTATE_HYPAPLASIA_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'C61 - Malignant Neoplasms of Prostate' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BENIGH_PROSTATE_HYPAPLASIA_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'C61 - Malignant Neoplasms of Prostate' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BENIGH_PROSTATE_HYPAPLASIA_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'C50 - MALIGNANT NEOPLASM OF BREAST' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INSITION_OF_BREAST_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'C50 - MALIGNANT NEOPLASM OF BREAST' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INSITION_OF_BREAST_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'C50 - MALIGNANT NEOPLASM OF BREAST' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INSITION_OF_BREAST_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 323 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_BENIGH_NEOPLASM_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 323 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_BENIGH_NEOPLASM_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 323 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_BENIGH_NEOPLASM_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'D64 - Other Anaemias' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SEVERE_ANAEMIA_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'D64 - Other Anaemias' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SEVERE_ANAEMIA_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'D64 - Other Anaemias' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SEVERE_ANAEMIA_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'D53 - Other Nutritional Anaemias' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_NUTRITIONAL_ANAEMIA_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'D53 - Other Nutritional Anaemias' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_NUTRITIONAL_ANAEMIA_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'D53 - Other Nutritional Anaemias' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_NUTRITIONAL_ANAEMIA_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'D57 - Sickle-cell disorders' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SICKLE_CELL_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'D57 - Sickle-cell disorders' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SICKLE_CELL_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'D57 - Sickle-cell disorders' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SICKLE_CELL_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 365 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISORDER_OF_THYROID_GLAND_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 365 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISORDER_OF_THYROID_GLAND_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 365 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISORDER_OF_THYROID_GLAND_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 372 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DIABETES_MELLITUS_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 372 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DIABETES_MELLITUS_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 372 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DIABETES_MELLITUS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'E16.2 - Hypoglyceamia' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HYPOGLYCAEMIA_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'E16.2 - Hypoglyceamia' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HYPOGLYCAEMIA_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'E16.2 - Hypoglyceamia' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HYPOGLYCAEMIA_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'E40 - Kwashiorkor' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS KWASHIORKOR_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'E40 - Kwashiorkor' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS KWASHIORKOR_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'E40 - Kwashiorkor' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS KWASHIORKOR_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 382 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MALNUTRITION_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 382 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MALNUTRITION_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 382 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MALNUTRITION_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'E66 - Obesity' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OBESITY_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'E66 - Obesity' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OBESITY_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'E66 - Obesity' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OBESITY_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'F32 - Depressive episode' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DEPRESSION_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'F32 - Depressive episode' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DEPRESSION_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'F32 - Depressive episode' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DEPRESSION_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'F78 - Other mental retardation' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MENTAL_DISORDER_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'F78 - Other mental retardation' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MENTAL_DISORDER_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'F78 - Other mental retardation' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MENTAL_DISORDER_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'G01 - Meningitis due to other unspecified causes' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MENINGITIS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'G01 - Meningitis due to other unspecified causes' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MENINGITIS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'G01 - Meningitis due to other unspecified causes' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MENINGITIS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'G40 - Epilepsy' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS EPILEPSY_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'G40 - Epilepsy' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS EPILEPSY_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'G40 - Epilepsy' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS EPILEPSY_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'G43 - Migraine' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MIGRAINE_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'G43 - Migraine' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MIGRAINE_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'G43 - Migraine' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MIGRAINE_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DISEASES_OF_CNS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DISEASES_OF_CNS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DISEASES_OF_CNS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'G80 - Cerebral palsy' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CEREBRAL_PALSY_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'G80 - Cerebral palsy' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CEREBRAL_PALSY_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'G80 - Cerebral palsy' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CEREBRAL_PALSY_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 463 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_PARALYTIC_SYNDRONES_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 463 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_PARALYTIC_SYNDRONES_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 463 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_PARALYTIC_SYNDRONES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'B30 - Viral Conjuctivitis' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONJUCTIVITIS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'B30 - Viral Conjuctivitis' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONJUCTIVITIS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'B30 - Viral Conjuctivitis' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONJUCTIVITIS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'H25 - Senile Cataract' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CATARACT_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'H25 - Senile Cataract' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CATARACT_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'H25 - Senile Cataract' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CATARACT_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'H40 - Glaucoma' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GLAUCOMA_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'H40 - Glaucoma' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GLAUCOMA_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'H40 - Glaucoma' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GLAUCOMA_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'O70 - Perineal laceration during delivery' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONEAL_LACERATION_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'O70 - Perineal laceration during delivery' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONEAL_LACERATION_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'O70 - Perineal laceration during delivery' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONEAL_LACERATION_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'S05 - Injury of eye and orbit' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_EYES_DISORDERS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'S05 - Injury of eye and orbit' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_EYES_DISORDERS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'S05 - Injury of eye and orbit' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_EYES_DISORDERS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 488 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_EAR_AND_MASTOID_PROCESS_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 488 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_EAR_AND_MASTOID_PROCESS_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 488 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_EAR_AND_MASTOID_PROCESS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 505 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS RHEUNMATIC_FEVER_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 505 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS RHEUNMATIC_FEVER_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 505 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS RHEUNMATIC_FEVER_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 511 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HYPERTENSIVE_DISEASES_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 511 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HYPERTENSIVE_DISEASES_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 511 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HYPERTENSIVE_DISEASES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 533 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CEREBRO_VASCULAR_ACCIDENT_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 533 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CEREBRO_VASCULAR_ACCIDENT_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 533 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CEREBRO_VASCULAR_ACCIDENT_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName IN ('I46 - Cardiac arrest','I50 - Heart failure') AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CARDIAC_ARREST_HEART_FAILURE_1TO14
				  ,SUM(CASE WHEN SM.ServiceName IN ('I46 - Cardiac arrest','I50 - Heart failure') AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CARDIAC_ARREST_HEART_FAILURE_15TO49
				  ,SUM(CASE WHEN SM.ServiceName IN ('I46 - Cardiac arrest','I50 - Heart failure') AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CARDIAC_ARREST_HEART_FAILURE_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 526 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_FORM_OF_HEART_DISEASES_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 526 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_FORM_OF_HEART_DISEASES_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 526 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_FORM_OF_HEART_DISEASES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BRONCHO_PNEUMONIA_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BRONCHO_PNEUMONIA_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BRONCHO_PNEUMONIA_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'J20 - Acute Bronchitis' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BRONCHITIS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'J20 - Acute Bronchitis' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BRONCHITIS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'J20 - Acute Bronchitis' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BRONCHITIS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'J45 - Asthma' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ASTHMA_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'J45 - Asthma' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ASTHMA_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'J45 - Asthma' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ASTHMA_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 560 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_RESPIRATORY_DISEASES_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 560 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_RESPIRATORY_DISEASES_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 560 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_RESPIRATORY_DISEASES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'K02 - Dental Caries' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DENTAL_DISEASES_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'K02 - Dental Caries' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DENTAL_DISEASES_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'K02 - Dental Caries' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DENTAL_DISEASES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'K25 - Gastric Ulcer' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ULCER_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'K25 - Gastric Ulcer' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ULCER_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'K25 - Gastric Ulcer' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ULCER_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'K35 - Acute Appendicitis' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS APPENDICITIS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'K35 - Acute Appendicitis' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS APPENDICITIS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'K35 - Acute Appendicitis' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS APPENDICITIS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 605 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HERNIA_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 605 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HERNIA_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 605 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HERNIA_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'K65 - Peritonitis' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PERITONITIS_INTESTINAL_OBSTRUCTION_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'K65 - Peritonitis' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PERITONITIS_INTESTINAL_OBSTRUCTION_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'K65 - Peritonitis' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PERITONITIS_INTESTINAL_OBSTRUCTION_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 622 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS LIVER_DISEASES_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 622 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS LIVER_DISEASES_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 622 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS LIVER_DISEASES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 584 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DIGESTIVE_SYSTEM_DISEASES_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 584 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DIGESTIVE_SYSTEM_DISEASES_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 584 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DIGESTIVE_SYSTEM_DISEASES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 636 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 636 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 636 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_MUSCULOSKELETAL_SYS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_MUSCULOSKELETAL_SYS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_MUSCULOSKELETAL_SYS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'N00 - Acute Nephritic syndrome' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ACUTE_NEPHRITIS_SYNDROME_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'N00 - Acute Nephritic syndrome' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ACUTE_NEPHRITIS_SYNDROME_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'N00 - Acute Nephritic syndrome' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ACUTE_NEPHRITIS_SYNDROME_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'N17 - Acute renal failure' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ACUTE_RENAL_FAILURE_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'N17 - Acute renal failure' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ACUTE_RENAL_FAILURE_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'N17 - Acute renal failure' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ACUTE_RENAL_FAILURE_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_GENTOURINARY_DISEASES_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_GENTOURINARY_DISEASES_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_GENTOURINARY_DISEASES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'N46 - Male Infertility' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALE_INFERTILITY_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'N46 - Male Infertility' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALE_INFERTILITY_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'N46 - Male Infertility' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALE_INFERTILITY_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'Q55 - Other Congenital malformation of male genital organs' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'Q55 - Other Congenital malformation of male genital organs' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'Q55 - Other Congenital malformation of male genital organs' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 711 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 711 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 711 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 718 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 718 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 718 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'N97 - Female Infertility' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FEMALE_INFERTILITY_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'N97 - Female Infertility' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FEMALE_INFERTILITY_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'N97 - Female Infertility' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FEMALE_INFERTILITY_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'N95 - Menopausal and other perimenopausal disorders' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MENOPOUSAL_DISORDER_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'N95 - Menopausal and other perimenopausal disorders' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MENOPOUSAL_DISORDER_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'N95 - Menopausal and other perimenopausal disorders' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MENOPOUSAL_DISORDER_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'Q52 - Other Congenital malformation of female genitalia' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_FEMALE_GENITAL_DISEASES_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'Q52 - Other Congenital malformation of female genitalia' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_FEMALE_GENITAL_DISEASES_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'Q52 - Other Congenital malformation of female genitalia' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_FEMALE_GENITAL_DISEASES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'O00 - Ectopic pregnancy' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ECTOPIC_PREGNANCY_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'O00 - Ectopic pregnancy' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ECTOPIC_PREGNANCY_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'O00 - Ectopic pregnancy' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ECTOPIC_PREGNANCY_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'O03 - Spontanous abortion' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SPONTENEOUS_ABORTION_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'O03 - Spontanous abortion' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SPONTENEOUS_ABORTION_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'O03 - Spontanous abortion' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SPONTENEOUS_ABORTION_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'O15 - Eclampsia' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ECLAMPSIA_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'O15 - Eclampsia' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ECLAMPSIA_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'O15 - Eclampsia' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ECLAMPSIA_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 753 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_PREGNANCY_RELATED_DISEASES_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 753 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_PREGNANCY_RELATED_DISEASES_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 753 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_PREGNANCY_RELATED_DISEASES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'O60 - Preterm Labour' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PRETERIM_DELIVERY_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'O60 - Preterm Labour' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PRETERIM_DELIVERY_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'O60 - Preterm Labour' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PRETERIM_DELIVERY_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POST_PERTUM_HEAMORRHAGE_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POST_PERTUM_HEAMORRHAGE_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POST_PERTUM_HEAMORRHAGE_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'O64 - Obstucted labour due to malposition & malpresentation of fetus' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OBSTRUCTED_LABOUR_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'O64 - Obstucted labour due to malposition & malpresentation of fetus' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OBSTRUCTED_LABOUR_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'O64 - Obstucted labour due to malposition & malpresentation of fetus' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OBSTRUCTED_LABOUR_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'O75 - Other complications of labour and delivery NEC' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'O75 - Other complications of labour and delivery NEC' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'O75 - Other complications of labour and delivery NEC' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'A41 - Sepsis' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PUERPERAL_SEPSIS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'A41 - Sepsis' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PUERPERAL_SEPSIS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'A41 - Sepsis' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PUERPERAL_SEPSIS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'P21 - Birth Asphyxia' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BIRTH_ASPHYXIA_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'P21 - Birth Asphyxia' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BIRTH_ASPHYXIA_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'P21 - Birth Asphyxia' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BIRTH_ASPHYXIA_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'P59 - Neonatal Jaundice from other and unspecified causes' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NEONATAL_JAUNDICE_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'P59 - Neonatal Jaundice from other and unspecified causes' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NEONATAL_JAUNDICE_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'P59 - Neonatal Jaundice from other and unspecified causes' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NEONATAL_JAUNDICE_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 848 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 848 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 848 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'R05 - Cough' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS COUGH_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'R05 - Cough' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS COUGH_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'R05 - Cough' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS COUGH_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'R82 - Other abnormal findings of urine' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'R82 - Other abnormal findings of urine' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'R82 - Other abnormal findings of urine' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'R50 - Fever of other and unknown origin' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FEVER_OF_UNKNOWN_ORIGIN_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'R50 - Fever of other and unknown origin' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FEVER_OF_UNKNOWN_ORIGIN_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'R50 - Fever of other and unknown origin' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FEVER_OF_UNKNOWN_ORIGIN_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'R68 - Other general symptoms and signs' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_GENERAL_SYMPTONS_AND_SIGNS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'R68 - Other general symptoms and signs' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_GENERAL_SYMPTONS_AND_SIGNS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'R68 - Other general symptoms and signs' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_GENERAL_SYMPTONS_AND_SIGNS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 975 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HEAD_INJURY_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 975 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HEAD_INJURY_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 975 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HEAD_INJURY_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'S09 - Other and unspecified injuries of head' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_INJURY_TO_THE_HEAD_REGION_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'S09 - Other and unspecified injuries of head' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_INJURY_TO_THE_HEAD_REGION_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'S09 - Other and unspecified injuries of head' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_INJURY_TO_THE_HEAD_REGION_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'T02 - Fractures involving multiple body regions' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_INJURY_POISON_FRACTURE_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'T02 - Fractures involving multiple body regions' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_INJURY_POISON_FRACTURE_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'T02 - Fractures involving multiple body regions' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_INJURY_POISON_FRACTURE_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'W44 - Foreign body entering into or through eye or natural orifice' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FOREIGN_BODY_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'W44 - Foreign body entering into or through eye or natural orifice' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FOREIGN_BODY_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'W44 - Foreign body entering into or through eye or natural orifice' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FOREIGN_BODY_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 1109 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BURNS_AND_CORROSIONS_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 1109 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BURNS_AND_CORROSIONS_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 1109 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BURNS_AND_CORROSIONS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = 'T36 - Poisoning by systematic antibiotics' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POISONS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = 'T36 - Poisoning by systematic antibiotics' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POISONS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = 'T36 - Poisoning by systematic antibiotics' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POISONS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 1278 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TRANSPORTATION_ACCIDENTS_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 1278 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TRANSPORTATION_ACCIDENTS_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 1278 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TRANSPORTATION_ACCIDENTS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 1303 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FALLS_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 1303 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FALLS_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 1303 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FALLS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS WEAPONS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS WEAPONS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS WEAPONS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GUNS_1TO14
				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GUNS_15TO49
				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GUNS_50ANDABOVE

				  ,SUM(CASE WHEN SM.ParentId = 1460 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INTENTIONAL_SELF_HARM_1TO14
				  ,SUM(CASE WHEN SM.ParentId = 1460 AND CD.HType IN (104,109) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INTENTIONAL_SELF_HARM_15TO49
				  ,SUM(CASE WHEN SM.ParentId = 1460 AND CD.HType IN (105,110) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INTENTIONAL_SELF_HARM_50ANDABOVE

				  ,SUM(CASE WHEN CD.HType IN (101,102,103,106,107,108) AND SM.ServiceName IN ('A00 - Cholera','A01 - Typhoid and parathyphoid fevers','A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin','A35 - Other Tetanus','A40 - Streptococcal Septicaemia','A64 - Unspecified sexually transmitted disease','A80 - Acute poliomyelitis','A82 - Rabies','A95 - Yellow fever','B01 - Varicella (chicken pox)','B05 - Measles','B02 - Zoster (herpes zoster)','B07 - Viral warts','B24 - Unspecified HIV diseases/Immuno suppression','B54 - Unspecified Malaria','B77 - Ascariasis','B83 - Other Helminthiases','C17 - Malignant Neoplasm of Small Intestines','C44 -  Other Malignant Neoplasm of Skin','C34 - Malignant Neoplasm of Bronchus & Lung','C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs','C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues','K74 - Fibrosis and cirrhosis of liver','C61 - Malignant Neoplasms of Prostate','C50 - MALIGNANT NEOPLASM OF BREAST','D64 - Other Anaemias','D53 - Other Nutritional Anaemias','D57 - Sickle-cell disorders','E16.2 - Hypoglyceamia','E40 - Kwashiorkor','E66 - Obesity','F32 - Depressive episode','F78 - Other mental retardation','G01 - Meningitis due to other unspecified causes','G40 - Epilepsy','G43 - Migraine','C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS','G80 - Cerebral palsy','B30 - Viral Conjuctivitis','H25 - Senile Cataract','H40 - Glaucoma','O70 - Perineal laceration during delivery','S05 - Injury of eye and orbit','I46 - Cardiac arrest','I50 - Heart failure','J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]','J20 - Acute Bronchitis','J45 - Asthma','K02 - Dental Caries','K25 - Gastric Ulcer','K35 - Acute Appendicitis','K65 - Peritonitis','R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ','N00 - Acute Nephritic syndrome','N17 - Acute renal failure','N46 - Male Infertility','Q55 - Other Congenital malformation of male genital organs','N97 - Female Infertility','N95 - Menopausal and other perimenopausal disorders','Q52 - Other Congenital malformation of female genitalia','O00 - Ectopic pregnancy','O03 - Spontanous abortion','O15 - Eclampsia','O60 - Preterm Labour','Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care','O64 - Obstucted labour due to malposition & malpresentation of fetus','O75 - Other complications of labour and delivery NEC','A41 - Sepsis','P21 - Birth Asphyxia','P59 - Neonatal Jaundice from other and unspecified causes','R05 - Cough','R82 - Other abnormal findings of urine','R50 - Fever of other and unknown origin','R68 - Other general symptoms and signs','S09 - Other and unspecified injuries of head','T02 - Fractures involving multiple body regions','W44 - Foreign body entering into or through eye or natural orifice','T36 - Poisoning by systematic antibiotics')
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) +
				   SUM(CASE WHEN CD.HType IN (101,102,103,106,107,108) AND SM.ParentId IN (96,102,112,158,184,194,200,221,323,365,372,382,463,488,505,511,533,526,560,605,622,584,636,711,718,753,848,975,1109,1278,1303,1460)
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TOTAL_1TO14
				  ,SUM(CASE WHEN CD.HType IN (104,109) AND SM.ServiceName IN ('A00 - Cholera','A01 - Typhoid and parathyphoid fevers','A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin','A35 - Other Tetanus','A40 - Streptococcal Septicaemia','A64 - Unspecified sexually transmitted disease','A80 - Acute poliomyelitis','A82 - Rabies','A95 - Yellow fever','B01 - Varicella (chicken pox)','B05 - Measles','B02 - Zoster (herpes zoster)','B07 - Viral warts','B24 - Unspecified HIV diseases/Immuno suppression','B54 - Unspecified Malaria','B77 - Ascariasis','B83 - Other Helminthiases','C17 - Malignant Neoplasm of Small Intestines','C44 -  Other Malignant Neoplasm of Skin','C34 - Malignant Neoplasm of Bronchus & Lung','C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs','C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues','K74 - Fibrosis and cirrhosis of liver','C61 - Malignant Neoplasms of Prostate','C50 - MALIGNANT NEOPLASM OF BREAST','D64 - Other Anaemias','D53 - Other Nutritional Anaemias','D57 - Sickle-cell disorders','E16.2 - Hypoglyceamia','E40 - Kwashiorkor','E66 - Obesity','F32 - Depressive episode','F78 - Other mental retardation','G01 - Meningitis due to other unspecified causes','G40 - Epilepsy','G43 - Migraine','C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS','G80 - Cerebral palsy','B30 - Viral Conjuctivitis','H25 - Senile Cataract','H40 - Glaucoma','O70 - Perineal laceration during delivery','S05 - Injury of eye and orbit','I46 - Cardiac arrest','I50 - Heart failure','J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]','J20 - Acute Bronchitis','J45 - Asthma','K02 - Dental Caries','K25 - Gastric Ulcer','K35 - Acute Appendicitis','K65 - Peritonitis','R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ','N00 - Acute Nephritic syndrome','N17 - Acute renal failure','N46 - Male Infertility','Q55 - Other Congenital malformation of male genital organs','N97 - Female Infertility','N95 - Menopausal and other perimenopausal disorders','Q52 - Other Congenital malformation of female genitalia','O00 - Ectopic pregnancy','O03 - Spontanous abortion','O15 - Eclampsia','O60 - Preterm Labour','Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care','O64 - Obstucted labour due to malposition & malpresentation of fetus','O75 - Other complications of labour and delivery NEC','A41 - Sepsis','P21 - Birth Asphyxia','P59 - Neonatal Jaundice from other and unspecified causes','R05 - Cough','R82 - Other abnormal findings of urine','R50 - Fever of other and unknown origin','R68 - Other general symptoms and signs','S09 - Other and unspecified injuries of head','T02 - Fractures involving multiple body regions','W44 - Foreign body entering into or through eye or natural orifice','T36 - Poisoning by systematic antibiotics')
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) +
				   SUM(CASE WHEN CD.HType IN (104,109) AND SM.ParentId IN (96,102,112,158,184,194,200,221,323,365,372,382,463,488,505,511,533,526,560,605,622,584,636,711,718,753,848,975,1109,1278,1303,1460)
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TOTAL_15TO49
				  ,SUM(CASE WHEN CD.HType IN (105,110) AND SM.ServiceName IN ('A00 - Cholera','A01 - Typhoid and parathyphoid fevers','A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin','A35 - Other Tetanus','A40 - Streptococcal Septicaemia','A64 - Unspecified sexually transmitted disease','A80 - Acute poliomyelitis','A82 - Rabies','A95 - Yellow fever','B01 - Varicella (chicken pox)','B05 - Measles','B02 - Zoster (herpes zoster)','B07 - Viral warts','B24 - Unspecified HIV diseases/Immuno suppression','B54 - Unspecified Malaria','B77 - Ascariasis','B83 - Other Helminthiases','C17 - Malignant Neoplasm of Small Intestines','C44 -  Other Malignant Neoplasm of Skin','C34 - Malignant Neoplasm of Bronchus & Lung','C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs','C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues','K74 - Fibrosis and cirrhosis of liver','C61 - Malignant Neoplasms of Prostate','C50 - MALIGNANT NEOPLASM OF BREAST','D64 - Other Anaemias','D53 - Other Nutritional Anaemias','D57 - Sickle-cell disorders','E16.2 - Hypoglyceamia','E40 - Kwashiorkor','E66 - Obesity','F32 - Depressive episode','F78 - Other mental retardation','G01 - Meningitis due to other unspecified causes','G40 - Epilepsy','G43 - Migraine','C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS','G80 - Cerebral palsy','B30 - Viral Conjuctivitis','H25 - Senile Cataract','H40 - Glaucoma','O70 - Perineal laceration during delivery','S05 - Injury of eye and orbit','I46 - Cardiac arrest','I50 - Heart failure','J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]','J20 - Acute Bronchitis','J45 - Asthma','K02 - Dental Caries','K25 - Gastric Ulcer','K35 - Acute Appendicitis','K65 - Peritonitis','R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ','N00 - Acute Nephritic syndrome','N17 - Acute renal failure','N46 - Male Infertility','Q55 - Other Congenital malformation of male genital organs','N97 - Female Infertility','N95 - Menopausal and other perimenopausal disorders','Q52 - Other Congenital malformation of female genitalia','O00 - Ectopic pregnancy','O03 - Spontanous abortion','O15 - Eclampsia','O60 - Preterm Labour','Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care','O64 - Obstucted labour due to malposition & malpresentation of fetus','O75 - Other complications of labour and delivery NEC','A41 - Sepsis','P21 - Birth Asphyxia','P59 - Neonatal Jaundice from other and unspecified causes','R05 - Cough','R82 - Other abnormal findings of urine','R50 - Fever of other and unknown origin','R68 - Other general symptoms and signs','S09 - Other and unspecified injuries of head','T02 - Fractures involving multiple body regions','W44 - Foreign body entering into or through eye or natural orifice','T36 - Poisoning by systematic antibiotics')
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) +
				   SUM(CASE WHEN CD.HType IN (105,110) AND SM.ParentId IN (96,102,112,158,184,194,200,221,323,365,372,382,463,488,505,511,533,526,560,605,622,584,636,711,718,753,848,975,1109,1278,1303,1460)
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TOTAL_50ANDABOVE
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.CaseDetail AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE ((CD.CMonth >= @CMonth AND CD.CMonth <= @EMonth) OR (@CMonth + @EMonth = 0))
			AND (CD.CYear = @CYear)
			AND (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.CaseType = 1)
			AND (CD.HType >= 101) 
			AND (CD.HType <= 110)
			GROUP BY CM.CName
		END
	--ELSE IF (@DateMode = 2)
	--	BEGIN
	--		SELECT 0 AS SrNo
	--			  ,CM.CName AS HospitalName

	--			  ,SUM(CASE WHEN SM.ServiceName = 'A00 - Cholera' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CHOLERA_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A00 - Cholera' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CHOLERA_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A00 - Cholera' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CHOLERA_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'A01 - Typhoid and parathyphoid fevers' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TYPHOID_FEVER_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A01 - Typhoid and parathyphoid fevers' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TYPHOID_FEVER_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A01 - Typhoid and parathyphoid fevers' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TYPHOID_FEVER_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DIARRHOEA_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DIARRHOEA_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DIARRHOEA_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 96 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TUBERCULOSIS_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 96 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TUBERCULOSIS_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 96 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TUBERCULOSIS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 102 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ZOONATIC_INFECTION_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 102 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ZOONATIC_INFECTION_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 102 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ZOONATIC_INFECTION_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'A35 - Other Tetanus' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TETANUS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A35 - Other Tetanus' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TETANUS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A35 - Other Tetanus' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TETANUS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'A40 - Streptococcal Septicaemia' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS STREPTOCOCCAL_SEPTICAEMIA_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A40 - Streptococcal Septicaemia' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS STREPTOCOCCAL_SEPTICAEMIA_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A40 - Streptococcal Septicaemia' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS STREPTOCOCCAL_SEPTICAEMIA_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 112 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_BACTERIA_DXS_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 112 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_BACTERIA_DXS_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 112 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_BACTERIA_DXS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'A64 - Unspecified sexually transmitted disease' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SEXUALLY_TRANSMITTED_DISEASES_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A64 - Unspecified sexually transmitted disease' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SEXUALLY_TRANSMITTED_DISEASES_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A64 - Unspecified sexually transmitted disease' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SEXUALLY_TRANSMITTED_DISEASES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'A80 - Acute poliomyelitis' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POLIOMYELITES_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A80 - Acute poliomyelitis' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POLIOMYELITES_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A80 - Acute poliomyelitis' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POLIOMYELITES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'A82 - Rabies' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS RABIES_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A82 - Rabies' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS RABIES_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A82 - Rabies' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS RABIES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 158 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 158 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 158 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'A95 - Yellow fever' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS YELLOW_FEVER_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A95 - Yellow fever' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS YELLOW_FEVER_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A95 - Yellow fever' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS YELLOW_FEVER_50ANDABOVE
		  
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B01 - Varicella (chicken pox)' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CHICKEN_POX_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B01 - Varicella (chicken pox)' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CHICKEN_POX_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B01 - Varicella (chicken pox)' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CHICKEN_POX_50ANDABOVE
		  
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B05 - Measles' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MEASLES_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B05 - Measles' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MEASLES_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B05 - Measles' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MEASLES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'B02 - Zoster (herpes zoster)' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HERPES_ZOSTER_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B02 - Zoster (herpes zoster)' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HERPES_ZOSTER_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B02 - Zoster (herpes zoster)' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HERPES_ZOSTER_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'B07 - Viral warts' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS VIRAL_WARTS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B07 - Viral warts' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS VIRAL_WARTS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B07 - Viral warts' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS VIRAL_WARTS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 184 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS VIRAL_HEPATITIS_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 184 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS VIRAL_HEPATITIS_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 184 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS VIRAL_HEPATITIS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'B24 - Unspecified HIV diseases/Immuno suppression' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HIV_DISEASES_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B24 - Unspecified HIV diseases/Immuno suppression' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HIV_DISEASES_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B24 - Unspecified HIV diseases/Immuno suppression' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HIV_DISEASES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 194 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_VIRAL_DXS_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 194 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_VIRAL_DXS_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 194 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_VIRAL_DXS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 200 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MYCOSES_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 200 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MYCOSES_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 200 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MYCOSES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'B54 - Unspecified Malaria' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALARIA_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B54 - Unspecified Malaria' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALARIA_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B54 - Unspecified Malaria' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALARIA_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 221 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HELMINTHIASIS_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 221 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HELMINTHIASIS_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 221 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HELMINTHIASIS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HOOKWORM_DISEASES_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HOOKWORM_DISEASES_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HOOKWORM_DISEASES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'B77 - Ascariasis' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ASCARIASIS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B77 - Ascariasis' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ASCARIASIS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B77 - Ascariasis' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ASCARIASIS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'B83 - Other Helminthiases' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_HELMINTHIASIS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B83 - Other Helminthiases' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_HELMINTHIASIS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B83 - Other Helminthiases' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_HELMINTHIASIS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'C17 - Malignant Neoplasm of Small Intestines' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'C17 - Malignant Neoplasm of Small Intestines' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'C17 - Malignant Neoplasm of Small Intestines' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'C44 -  Other Malignant Neoplasm of Skin' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_SKIN_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'C44 -  Other Malignant Neoplasm of Skin' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_SKIN_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'C44 -  Other Malignant Neoplasm of Skin' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_SKIN_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'C34 - Malignant Neoplasm of Bronchus & Lung' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LUNG_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'C34 - Malignant Neoplasm of Bronchus & Lung' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LUNG_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'C34 - Malignant Neoplasm of Bronchus & Lung' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LUNG_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_BONE_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_BONE_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_BONE_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MALIGNANT_NEOPLASM_DISEASES_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MALIGNANT_NEOPLASM_DISEASES_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MALIGNANT_NEOPLASM_DISEASES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'K74 - Fibrosis and cirrhosis of liver' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FIBROID_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'K74 - Fibrosis and cirrhosis of liver' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FIBROID_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'K74 - Fibrosis and cirrhosis of liver' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FIBROID_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'C61 - Malignant Neoplasms of Prostate' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BENIGH_PROSTATE_HYPAPLASIA_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'C61 - Malignant Neoplasms of Prostate' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BENIGH_PROSTATE_HYPAPLASIA_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'C61 - Malignant Neoplasms of Prostate' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BENIGH_PROSTATE_HYPAPLASIA_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'C50 - MALIGNANT NEOPLASM OF BREAST' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INSITION_OF_BREAST_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'C50 - MALIGNANT NEOPLASM OF BREAST' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INSITION_OF_BREAST_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'C50 - MALIGNANT NEOPLASM OF BREAST' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INSITION_OF_BREAST_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 323 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_BENIGH_NEOPLASM_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 323 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_BENIGH_NEOPLASM_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 323 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_BENIGH_NEOPLASM_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'D64 - Other Anaemias' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SEVERE_ANAEMIA_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'D64 - Other Anaemias' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SEVERE_ANAEMIA_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'D64 - Other Anaemias' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SEVERE_ANAEMIA_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'D53 - Other Nutritional Anaemias' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_NUTRITIONAL_ANAEMIA_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'D53 - Other Nutritional Anaemias' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_NUTRITIONAL_ANAEMIA_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'D53 - Other Nutritional Anaemias' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_NUTRITIONAL_ANAEMIA_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'D57 - Sickle-cell disorders' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SICKLE_CELL_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'D57 - Sickle-cell disorders' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SICKLE_CELL_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'D57 - Sickle-cell disorders' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SICKLE_CELL_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 365 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISORDER_OF_THYROID_GLAND_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 365 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISORDER_OF_THYROID_GLAND_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 365 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISORDER_OF_THYROID_GLAND_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 372 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DIABETES_MELLITUS_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 372 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DIABETES_MELLITUS_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 372 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DIABETES_MELLITUS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'E16.2 - Hypoglyceamia' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HYPOGLYCAEMIA_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'E16.2 - Hypoglyceamia' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HYPOGLYCAEMIA_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'E16.2 - Hypoglyceamia' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HYPOGLYCAEMIA_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'E40 - Kwashiorkor' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS KWASHIORKOR_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'E40 - Kwashiorkor' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS KWASHIORKOR_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'E40 - Kwashiorkor' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS KWASHIORKOR_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 382 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MALNUTRITION_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 382 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MALNUTRITION_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 382 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MALNUTRITION_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'E66 - Obesity' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OBESITY_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'E66 - Obesity' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OBESITY_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'E66 - Obesity' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OBESITY_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'F32 - Depressive episode' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DEPRESSION_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'F32 - Depressive episode' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DEPRESSION_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'F32 - Depressive episode' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DEPRESSION_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'F78 - Other mental retardation' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MENTAL_DISORDER_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'F78 - Other mental retardation' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MENTAL_DISORDER_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'F78 - Other mental retardation' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MENTAL_DISORDER_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'G01 - Meningitis due to other unspecified causes' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MENINGITIS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'G01 - Meningitis due to other unspecified causes' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MENINGITIS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'G01 - Meningitis due to other unspecified causes' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MENINGITIS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'G40 - Epilepsy' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS EPILEPSY_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'G40 - Epilepsy' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS EPILEPSY_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'G40 - Epilepsy' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS EPILEPSY_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'G43 - Migraine' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MIGRAINE_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'G43 - Migraine' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MIGRAINE_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'G43 - Migraine' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MIGRAINE_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DISEASES_OF_CNS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DISEASES_OF_CNS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DISEASES_OF_CNS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'G80 - Cerebral palsy' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CEREBRAL_PALSY_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'G80 - Cerebral palsy' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CEREBRAL_PALSY_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'G80 - Cerebral palsy' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CEREBRAL_PALSY_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 463 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_PARALYTIC_SYNDRONES_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 463 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_PARALYTIC_SYNDRONES_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 463 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_PARALYTIC_SYNDRONES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'B30 - Viral Conjuctivitis' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONJUCTIVITIS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B30 - Viral Conjuctivitis' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONJUCTIVITIS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'B30 - Viral Conjuctivitis' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONJUCTIVITIS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'H25 - Senile Cataract' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CATARACT_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'H25 - Senile Cataract' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CATARACT_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'H25 - Senile Cataract' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CATARACT_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'H40 - Glaucoma' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GLAUCOMA_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'H40 - Glaucoma' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GLAUCOMA_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'H40 - Glaucoma' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GLAUCOMA_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'O70 - Perineal laceration during delivery' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONEAL_LACERATION_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'O70 - Perineal laceration during delivery' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONEAL_LACERATION_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'O70 - Perineal laceration during delivery' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONEAL_LACERATION_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'S05 - Injury of eye and orbit' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_EYES_DISORDERS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'S05 - Injury of eye and orbit' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_EYES_DISORDERS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'S05 - Injury of eye and orbit' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_EYES_DISORDERS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 488 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_EAR_AND_MASTOID_PROCESS_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 488 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_EAR_AND_MASTOID_PROCESS_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 488 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_EAR_AND_MASTOID_PROCESS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 505 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS RHEUNMATIC_FEVER_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 505 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS RHEUNMATIC_FEVER_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 505 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS RHEUNMATIC_FEVER_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 511 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HYPERTENSIVE_DISEASES_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 511 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HYPERTENSIVE_DISEASES_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 511 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HYPERTENSIVE_DISEASES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 533 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CEREBRO_VASCULAR_ACCIDENT_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 533 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CEREBRO_VASCULAR_ACCIDENT_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 533 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CEREBRO_VASCULAR_ACCIDENT_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName IN ('I46 - Cardiac arrest','I50 - Heart failure') AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CARDIAC_ARREST_HEART_FAILURE_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName IN ('I46 - Cardiac arrest','I50 - Heart failure') AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CARDIAC_ARREST_HEART_FAILURE_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName IN ('I46 - Cardiac arrest','I50 - Heart failure') AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CARDIAC_ARREST_HEART_FAILURE_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 526 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_FORM_OF_HEART_DISEASES_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 526 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_FORM_OF_HEART_DISEASES_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 526 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_FORM_OF_HEART_DISEASES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BRONCHO_PNEUMONIA_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BRONCHO_PNEUMONIA_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BRONCHO_PNEUMONIA_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'J20 - Acute Bronchitis' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BRONCHITIS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'J20 - Acute Bronchitis' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BRONCHITIS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'J20 - Acute Bronchitis' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BRONCHITIS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'J45 - Asthma' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ASTHMA_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'J45 - Asthma' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ASTHMA_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'J45 - Asthma' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ASTHMA_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 560 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_RESPIRATORY_DISEASES_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 560 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_RESPIRATORY_DISEASES_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 560 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_RESPIRATORY_DISEASES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'K02 - Dental Caries' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DENTAL_DISEASES_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'K02 - Dental Caries' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DENTAL_DISEASES_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'K02 - Dental Caries' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DENTAL_DISEASES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'K25 - Gastric Ulcer' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ULCER_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'K25 - Gastric Ulcer' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ULCER_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'K25 - Gastric Ulcer' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ULCER_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'K35 - Acute Appendicitis' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS APPENDICITIS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'K35 - Acute Appendicitis' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS APPENDICITIS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'K35 - Acute Appendicitis' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS APPENDICITIS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 605 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HERNIA_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 605 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HERNIA_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 605 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HERNIA_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'K65 - Peritonitis' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PERITONITIS_INTESTINAL_OBSTRUCTION_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'K65 - Peritonitis' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PERITONITIS_INTESTINAL_OBSTRUCTION_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'K65 - Peritonitis' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PERITONITIS_INTESTINAL_OBSTRUCTION_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 622 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS LIVER_DISEASES_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 622 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS LIVER_DISEASES_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 622 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS LIVER_DISEASES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 584 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DIGESTIVE_SYSTEM_DISEASES_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 584 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DIGESTIVE_SYSTEM_DISEASES_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 584 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DIGESTIVE_SYSTEM_DISEASES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 636 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 636 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 636 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_MUSCULOSKELETAL_SYS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_MUSCULOSKELETAL_SYS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_MUSCULOSKELETAL_SYS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'N00 - Acute Nephritic syndrome' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ACUTE_NEPHRITIS_SYNDROME_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'N00 - Acute Nephritic syndrome' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ACUTE_NEPHRITIS_SYNDROME_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'N00 - Acute Nephritic syndrome' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ACUTE_NEPHRITIS_SYNDROME_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'N17 - Acute renal failure' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ACUTE_RENAL_FAILURE_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'N17 - Acute renal failure' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ACUTE_RENAL_FAILURE_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'N17 - Acute renal failure' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ACUTE_RENAL_FAILURE_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_GENTOURINARY_DISEASES_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_GENTOURINARY_DISEASES_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_GENTOURINARY_DISEASES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'N46 - Male Infertility' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALE_INFERTILITY_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'N46 - Male Infertility' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALE_INFERTILITY_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'N46 - Male Infertility' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALE_INFERTILITY_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'Q55 - Other Congenital malformation of male genital organs' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'Q55 - Other Congenital malformation of male genital organs' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'Q55 - Other Congenital malformation of male genital organs' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 711 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 711 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 711 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 718 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 718 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 718 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'N97 - Female Infertility' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FEMALE_INFERTILITY_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'N97 - Female Infertility' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FEMALE_INFERTILITY_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'N97 - Female Infertility' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FEMALE_INFERTILITY_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'N95 - Menopausal and other perimenopausal disorders' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MENOPOUSAL_DISORDER_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'N95 - Menopausal and other perimenopausal disorders' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MENOPOUSAL_DISORDER_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'N95 - Menopausal and other perimenopausal disorders' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MENOPOUSAL_DISORDER_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'Q52 - Other Congenital malformation of female genitalia' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_FEMALE_GENITAL_DISEASES_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'Q52 - Other Congenital malformation of female genitalia' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_FEMALE_GENITAL_DISEASES_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'Q52 - Other Congenital malformation of female genitalia' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_FEMALE_GENITAL_DISEASES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'O00 - Ectopic pregnancy' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ECTOPIC_PREGNANCY_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'O00 - Ectopic pregnancy' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ECTOPIC_PREGNANCY_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'O00 - Ectopic pregnancy' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ECTOPIC_PREGNANCY_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'O03 - Spontanous abortion' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SPONTENEOUS_ABORTION_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'O03 - Spontanous abortion' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SPONTENEOUS_ABORTION_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'O03 - Spontanous abortion' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SPONTENEOUS_ABORTION_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'O15 - Eclampsia' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ECLAMPSIA_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'O15 - Eclampsia' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ECLAMPSIA_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'O15 - Eclampsia' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ECLAMPSIA_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 753 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_PREGNANCY_RELATED_DISEASES_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 753 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_PREGNANCY_RELATED_DISEASES_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 753 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_PREGNANCY_RELATED_DISEASES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'O60 - Preterm Labour' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PRETERIM_DELIVERY_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'O60 - Preterm Labour' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PRETERIM_DELIVERY_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'O60 - Preterm Labour' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PRETERIM_DELIVERY_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POST_PERTUM_HEAMORRHAGE_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POST_PERTUM_HEAMORRHAGE_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POST_PERTUM_HEAMORRHAGE_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'O64 - Obstucted labour due to malposition & malpresentation of fetus' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OBSTRUCTED_LABOUR_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'O64 - Obstucted labour due to malposition & malpresentation of fetus' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OBSTRUCTED_LABOUR_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'O64 - Obstucted labour due to malposition & malpresentation of fetus' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OBSTRUCTED_LABOUR_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'O75 - Other complications of labour and delivery NEC' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'O75 - Other complications of labour and delivery NEC' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'O75 - Other complications of labour and delivery NEC' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'A41 - Sepsis' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PUERPERAL_SEPSIS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A41 - Sepsis' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PUERPERAL_SEPSIS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'A41 - Sepsis' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PUERPERAL_SEPSIS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'P21 - Birth Asphyxia' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BIRTH_ASPHYXIA_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'P21 - Birth Asphyxia' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BIRTH_ASPHYXIA_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'P21 - Birth Asphyxia' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BIRTH_ASPHYXIA_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'P59 - Neonatal Jaundice from other and unspecified causes' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NEONATAL_JAUNDICE_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'P59 - Neonatal Jaundice from other and unspecified causes' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NEONATAL_JAUNDICE_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'P59 - Neonatal Jaundice from other and unspecified causes' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NEONATAL_JAUNDICE_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 848 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 848 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 848 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'R05 - Cough' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS COUGH_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'R05 - Cough' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS COUGH_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'R05 - Cough' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS COUGH_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'R82 - Other abnormal findings of urine' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'R82 - Other abnormal findings of urine' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'R82 - Other abnormal findings of urine' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'R50 - Fever of other and unknown origin' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FEVER_OF_UNKNOWN_ORIGIN_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'R50 - Fever of other and unknown origin' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FEVER_OF_UNKNOWN_ORIGIN_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'R50 - Fever of other and unknown origin' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FEVER_OF_UNKNOWN_ORIGIN_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'R68 - Other general symptoms and signs' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_GENERAL_SYMPTONS_AND_SIGNS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'R68 - Other general symptoms and signs' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_GENERAL_SYMPTONS_AND_SIGNS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'R68 - Other general symptoms and signs' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_GENERAL_SYMPTONS_AND_SIGNS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 975 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HEAD_INJURY_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 975 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HEAD_INJURY_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 975 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HEAD_INJURY_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'S09 - Other and unspecified injuries of head' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_INJURY_TO_THE_HEAD_REGION_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'S09 - Other and unspecified injuries of head' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_INJURY_TO_THE_HEAD_REGION_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'S09 - Other and unspecified injuries of head' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_INJURY_TO_THE_HEAD_REGION_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'T02 - Fractures involving multiple body regions' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_INJURY_POISON_FRACTURE_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'T02 - Fractures involving multiple body regions' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_INJURY_POISON_FRACTURE_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'T02 - Fractures involving multiple body regions' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_INJURY_POISON_FRACTURE_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'W44 - Foreign body entering into or through eye or natural orifice' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FOREIGN_BODY_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'W44 - Foreign body entering into or through eye or natural orifice' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FOREIGN_BODY_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'W44 - Foreign body entering into or through eye or natural orifice' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FOREIGN_BODY_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 1109 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BURNS_AND_CORROSIONS_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 1109 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BURNS_AND_CORROSIONS_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 1109 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BURNS_AND_CORROSIONS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = 'T36 - Poisoning by systematic antibiotics' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POISONS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = 'T36 - Poisoning by systematic antibiotics' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POISONS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = 'T36 - Poisoning by systematic antibiotics' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POISONS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 1278 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TRANSPORTATION_ACCIDENTS_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 1278 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TRANSPORTATION_ACCIDENTS_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 1278 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TRANSPORTATION_ACCIDENTS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 1303 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FALLS_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 1303 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FALLS_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 1303 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FALLS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS WEAPONS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS WEAPONS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS WEAPONS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GUNS_1TO14
	--			  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GUNS_15TO49
	--			  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GUNS_50ANDABOVE

	--			  ,SUM(CASE WHEN SM.ParentId = 1460 AND CD.HType IN (101,102,103,106,107,108) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INTENTIONAL_SELF_HARM_1TO14
	--			  ,SUM(CASE WHEN SM.ParentId = 1460 AND CD.HType IN (104,109) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INTENTIONAL_SELF_HARM_15TO49
	--			  ,SUM(CASE WHEN SM.ParentId = 1460 AND CD.HType IN (105,110) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INTENTIONAL_SELF_HARM_50ANDABOVE

	--			  ,SUM(CASE WHEN CD.HType IN (101,102,103,106,107,108) AND SM.ServiceName IN ('A00 - Cholera','A01 - Typhoid and parathyphoid fevers','A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin','A35 - Other Tetanus','A40 - Streptococcal Septicaemia','A64 - Unspecified sexually transmitted disease','A80 - Acute poliomyelitis','A82 - Rabies','A95 - Yellow fever','B01 - Varicella (chicken pox)','B05 - Measles','B02 - Zoster (herpes zoster)','B07 - Viral warts','B24 - Unspecified HIV diseases/Immuno suppression','B54 - Unspecified Malaria','B77 - Ascariasis','B83 - Other Helminthiases','C17 - Malignant Neoplasm of Small Intestines','C44 -  Other Malignant Neoplasm of Skin','C34 - Malignant Neoplasm of Bronchus & Lung','C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs','C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues','K74 - Fibrosis and cirrhosis of liver','C61 - Malignant Neoplasms of Prostate','C50 - MALIGNANT NEOPLASM OF BREAST','D64 - Other Anaemias','D53 - Other Nutritional Anaemias','D57 - Sickle-cell disorders','E16.2 - Hypoglyceamia','E40 - Kwashiorkor','E66 - Obesity','F32 - Depressive episode','F78 - Other mental retardation','G01 - Meningitis due to other unspecified causes','G40 - Epilepsy','G43 - Migraine','C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS','G80 - Cerebral palsy','B30 - Viral Conjuctivitis','H25 - Senile Cataract','H40 - Glaucoma','O70 - Perineal laceration during delivery','S05 - Injury of eye and orbit','I46 - Cardiac arrest','I50 - Heart failure','J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]','J20 - Acute Bronchitis','J45 - Asthma','K02 - Dental Caries','K25 - Gastric Ulcer','K35 - Acute Appendicitis','K65 - Peritonitis','R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ','N00 - Acute Nephritic syndrome','N17 - Acute renal failure','N46 - Male Infertility','Q55 - Other Congenital malformation of male genital organs','N97 - Female Infertility','N95 - Menopausal and other perimenopausal disorders','Q52 - Other Congenital malformation of female genitalia','O00 - Ectopic pregnancy','O03 - Spontanous abortion','O15 - Eclampsia','O60 - Preterm Labour','Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care','O64 - Obstucted labour due to malposition & malpresentation of fetus','O75 - Other complications of labour and delivery NEC','A41 - Sepsis','P21 - Birth Asphyxia','P59 - Neonatal Jaundice from other and unspecified causes','R05 - Cough','R82 - Other abnormal findings of urine','R50 - Fever of other and unknown origin','R68 - Other general symptoms and signs','S09 - Other and unspecified injuries of head','T02 - Fractures involving multiple body regions','W44 - Foreign body entering into or through eye or natural orifice','T36 - Poisoning by systematic antibiotics')
	--						THEN ISNULL(CD.DayVal,0) ELSE 0 END) +
	--			   SUM(CASE WHEN CD.HType IN (101,102,103,106,107,108) AND SM.ParentId IN (96,102,112,158,184,194,200,221,323,365,372,382,463,488,505,511,533,526,560,605,622,584,636,711,718,753,848,975,1109,1278,1303,1460)
	--						THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TOTAL_1TO14
	--			  ,SUM(CASE WHEN CD.HType IN (104,109) AND SM.ServiceName IN ('A00 - Cholera','A01 - Typhoid and parathyphoid fevers','A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin','A35 - Other Tetanus','A40 - Streptococcal Septicaemia','A64 - Unspecified sexually transmitted disease','A80 - Acute poliomyelitis','A82 - Rabies','A95 - Yellow fever','B01 - Varicella (chicken pox)','B05 - Measles','B02 - Zoster (herpes zoster)','B07 - Viral warts','B24 - Unspecified HIV diseases/Immuno suppression','B54 - Unspecified Malaria','B77 - Ascariasis','B83 - Other Helminthiases','C17 - Malignant Neoplasm of Small Intestines','C44 -  Other Malignant Neoplasm of Skin','C34 - Malignant Neoplasm of Bronchus & Lung','C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs','C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues','K74 - Fibrosis and cirrhosis of liver','C61 - Malignant Neoplasms of Prostate','C50 - MALIGNANT NEOPLASM OF BREAST','D64 - Other Anaemias','D53 - Other Nutritional Anaemias','D57 - Sickle-cell disorders','E16.2 - Hypoglyceamia','E40 - Kwashiorkor','E66 - Obesity','F32 - Depressive episode','F78 - Other mental retardation','G01 - Meningitis due to other unspecified causes','G40 - Epilepsy','G43 - Migraine','C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS','G80 - Cerebral palsy','B30 - Viral Conjuctivitis','H25 - Senile Cataract','H40 - Glaucoma','O70 - Perineal laceration during delivery','S05 - Injury of eye and orbit','I46 - Cardiac arrest','I50 - Heart failure','J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]','J20 - Acute Bronchitis','J45 - Asthma','K02 - Dental Caries','K25 - Gastric Ulcer','K35 - Acute Appendicitis','K65 - Peritonitis','R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ','N00 - Acute Nephritic syndrome','N17 - Acute renal failure','N46 - Male Infertility','Q55 - Other Congenital malformation of male genital organs','N97 - Female Infertility','N95 - Menopausal and other perimenopausal disorders','Q52 - Other Congenital malformation of female genitalia','O00 - Ectopic pregnancy','O03 - Spontanous abortion','O15 - Eclampsia','O60 - Preterm Labour','Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care','O64 - Obstucted labour due to malposition & malpresentation of fetus','O75 - Other complications of labour and delivery NEC','A41 - Sepsis','P21 - Birth Asphyxia','P59 - Neonatal Jaundice from other and unspecified causes','R05 - Cough','R82 - Other abnormal findings of urine','R50 - Fever of other and unknown origin','R68 - Other general symptoms and signs','S09 - Other and unspecified injuries of head','T02 - Fractures involving multiple body regions','W44 - Foreign body entering into or through eye or natural orifice','T36 - Poisoning by systematic antibiotics')
	--						THEN ISNULL(CD.DayVal,0) ELSE 0 END) +
	--			   SUM(CASE WHEN CD.HType IN (104,109) AND SM.ParentId IN (96,102,112,158,184,194,200,221,323,365,372,382,463,488,505,511,533,526,560,605,622,584,636,711,718,753,848,975,1109,1278,1303,1460)
	--						THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TOTAL_15TO49
	--			  ,SUM(CASE WHEN CD.HType IN (105,110) AND SM.ServiceName IN ('A00 - Cholera','A01 - Typhoid and parathyphoid fevers','A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin','A35 - Other Tetanus','A40 - Streptococcal Septicaemia','A64 - Unspecified sexually transmitted disease','A80 - Acute poliomyelitis','A82 - Rabies','A95 - Yellow fever','B01 - Varicella (chicken pox)','B05 - Measles','B02 - Zoster (herpes zoster)','B07 - Viral warts','B24 - Unspecified HIV diseases/Immuno suppression','B54 - Unspecified Malaria','B77 - Ascariasis','B83 - Other Helminthiases','C17 - Malignant Neoplasm of Small Intestines','C44 -  Other Malignant Neoplasm of Skin','C34 - Malignant Neoplasm of Bronchus & Lung','C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs','C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues','K74 - Fibrosis and cirrhosis of liver','C61 - Malignant Neoplasms of Prostate','C50 - MALIGNANT NEOPLASM OF BREAST','D64 - Other Anaemias','D53 - Other Nutritional Anaemias','D57 - Sickle-cell disorders','E16.2 - Hypoglyceamia','E40 - Kwashiorkor','E66 - Obesity','F32 - Depressive episode','F78 - Other mental retardation','G01 - Meningitis due to other unspecified causes','G40 - Epilepsy','G43 - Migraine','C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS','G80 - Cerebral palsy','B30 - Viral Conjuctivitis','H25 - Senile Cataract','H40 - Glaucoma','O70 - Perineal laceration during delivery','S05 - Injury of eye and orbit','I46 - Cardiac arrest','I50 - Heart failure','J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]','J20 - Acute Bronchitis','J45 - Asthma','K02 - Dental Caries','K25 - Gastric Ulcer','K35 - Acute Appendicitis','K65 - Peritonitis','R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ','N00 - Acute Nephritic syndrome','N17 - Acute renal failure','N46 - Male Infertility','Q55 - Other Congenital malformation of male genital organs','N97 - Female Infertility','N95 - Menopausal and other perimenopausal disorders','Q52 - Other Congenital malformation of female genitalia','O00 - Ectopic pregnancy','O03 - Spontanous abortion','O15 - Eclampsia','O60 - Preterm Labour','Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care','O64 - Obstucted labour due to malposition & malpresentation of fetus','O75 - Other complications of labour and delivery NEC','A41 - Sepsis','P21 - Birth Asphyxia','P59 - Neonatal Jaundice from other and unspecified causes','R05 - Cough','R82 - Other abnormal findings of urine','R50 - Fever of other and unknown origin','R68 - Other general symptoms and signs','S09 - Other and unspecified injuries of head','T02 - Fractures involving multiple body regions','W44 - Foreign body entering into or through eye or natural orifice','T36 - Poisoning by systematic antibiotics')
	--						THEN ISNULL(CD.DayVal,0) ELSE 0 END) +
	--			   SUM(CASE WHEN CD.HType IN (105,110) AND SM.ParentId IN (96,102,112,158,184,194,200,221,323,365,372,382,463,488,505,511,533,526,560,605,622,584,636,711,718,753,848,975,1109,1278,1303,1460)
	--						THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TOTAL_50ANDABOVE
	--		FROM dbo.CompanyMaster AS CM
	--		INNER JOIN dbo.fn_CaseDetailDateWise(@FromDate,@ToDate) AS CD
	--		ON CM.RecId = CD.CompanyId
	--		INNER JOIN dbo.ServicesMaster AS SM
	--		ON CD.ServiceId = SM.RecId
	--		WHERE (CD.CompanyId = @CompanyId OR @CompanyId = 0)
	--		AND (CD.CaseType = 1)
	--		AND (CD.HType >= 101) 
	--		AND (CD.HType <= 110)
	--		GROUP BY CM.CName
	--	END
END
GO
/****** Object:  StoredProcedure [dbo].[RptGovMCPBG]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <15 Feb 2020>
-- Htype 101
-- Htype1 110
-- DateMode 1 For Get Data For Month and Year
-- DateMode 2 For Get Data For FromDate ToDate
-- =============================================
-- Execute RptGovMCPBG 0,0,2019,0,101,110,'1900/01/01','1900/01/01',1
-- Execute RptGovMCPBG 0,0,2019,0,101,110,'2019/01/01','2019/12/31',2
CREATE PROCEDURE [dbo].[RptGovMCPBG]
@CMonth Int,
@EMonth Int,
@CYear Int,
@CompanyId Bigint,
@HType Int,
@HType1 Int,
@FromDate Datetime,
@ToDate Datetime,
@DateMode Int
AS
BEGIN
	IF (@DateMode = 1)
		BEGIN
			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName

				  ,SUM(CASE WHEN SM.ServiceName = 'A00 - Cholera' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CHOLERA_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A00 - Cholera' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CHOLERA_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A00 - Cholera' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CHOLERA_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'A01 - Typhoid and parathyphoid fevers' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TYPHOID_FEVER_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A01 - Typhoid and parathyphoid fevers' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TYPHOID_FEVER_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A01 - Typhoid and parathyphoid fevers' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TYPHOID_FEVER_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DIARRHOEA_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DIARRHOEA_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DIARRHOEA_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 96 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TUBERCULOSIS_MALE
				  ,SUM(CASE WHEN SM.ParentId = 96 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TUBERCULOSIS_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 96 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TUBERCULOSIS_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 102 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ZOONATIC_INFECTION_MALE
				  ,SUM(CASE WHEN SM.ParentId = 102 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ZOONATIC_INFECTION_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 102 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ZOONATIC_INFECTION_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'A35 - Other Tetanus' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TETANUS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A35 - Other Tetanus' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TETANUS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A35 - Other Tetanus' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TETANUS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'A40 - Streptococcal Septicaemia' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS STREPTOCOCCAL_SEPTICAEMIA_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A40 - Streptococcal Septicaemia' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS STREPTOCOCCAL_SEPTICAEMIA_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A40 - Streptococcal Septicaemia' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS STREPTOCOCCAL_SEPTICAEMIA_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 112 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_BACTERIA_DXS_MALE
				  ,SUM(CASE WHEN SM.ParentId = 112 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_BACTERIA_DXS_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 112 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_BACTERIA_DXS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'A64 - Unspecified sexually transmitted disease' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SEXUALLY_TRANSMITTED_DISEASES_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A64 - Unspecified sexually transmitted disease' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SEXUALLY_TRANSMITTED_DISEASES_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A64 - Unspecified sexually transmitted disease' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SEXUALLY_TRANSMITTED_DISEASES_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'A80 - Acute poliomyelitis' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POLIOMYELITES_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A80 - Acute poliomyelitis' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POLIOMYELITES_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A80 - Acute poliomyelitis' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POLIOMYELITES_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'A82 - Rabies' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS RABIES_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A82 - Rabies' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS RABIES_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A82 - Rabies' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS RABIES_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 158 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_MALE
				  ,SUM(CASE WHEN SM.ParentId = 158 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 158 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'A95 - Yellow fever' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS YELLOW_FEVER_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A95 - Yellow fever' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS YELLOW_FEVER_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A95 - Yellow fever' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS YELLOW_FEVER_TOTAL
		  
				  ,SUM(CASE WHEN SM.ServiceName = 'B01 - Varicella (chicken pox)' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CHICKEN_POX_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B01 - Varicella (chicken pox)' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CHICKEN_POX_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B01 - Varicella (chicken pox)' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CHICKEN_POX_TOTAL
		  
				  ,SUM(CASE WHEN SM.ServiceName = 'B05 - Measles' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MEASLES_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B05 - Measles' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MEASLES_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B05 - Measles' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MEASLES_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'B02 - Zoster (herpes zoster)' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HERPES_ZOSTER_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B02 - Zoster (herpes zoster)' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HERPES_ZOSTER_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B02 - Zoster (herpes zoster)' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HERPES_ZOSTER_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'B07 - Viral warts' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS VIRAL_WARTS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B07 - Viral warts' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS VIRAL_WARTS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B07 - Viral warts' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS VIRAL_WARTS_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 184 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS VIRAL_HEPATITIS_MALE
				  ,SUM(CASE WHEN SM.ParentId = 184 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS VIRAL_HEPATITIS_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 184 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS VIRAL_HEPATITIS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'B24 - Unspecified HIV diseases/Immuno suppression' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HIV_DISEASES_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B24 - Unspecified HIV diseases/Immuno suppression' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HIV_DISEASES_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B24 - Unspecified HIV diseases/Immuno suppression' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HIV_DISEASES_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 194 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_VIRAL_DXS_MALE
				  ,SUM(CASE WHEN SM.ParentId = 194 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_VIRAL_DXS_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 194 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_VIRAL_DXS_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 200 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MYCOSES_MALE
				  ,SUM(CASE WHEN SM.ParentId = 200 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MYCOSES_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 200 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MYCOSES_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'B54 - Unspecified Malaria' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALARIA_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B54 - Unspecified Malaria' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALARIA_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B54 - Unspecified Malaria' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALARIA_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 221 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HELMINTHIASIS_MALE
				  ,SUM(CASE WHEN SM.ParentId = 221 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HELMINTHIASIS_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 221 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HELMINTHIASIS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HOOKWORM_DISEASES_MALE
				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HOOKWORM_DISEASES_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HOOKWORM_DISEASES_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'B77 - Ascariasis' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ASCARIASIS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B77 - Ascariasis' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ASCARIASIS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B77 - Ascariasis' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ASCARIASIS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'B83 - Other Helminthiases' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_HELMINTHIASIS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B83 - Other Helminthiases' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_HELMINTHIASIS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B83 - Other Helminthiases' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_HELMINTHIASIS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'C17 - Malignant Neoplasm of Small Intestines' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'C17 - Malignant Neoplasm of Small Intestines' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'C17 - Malignant Neoplasm of Small Intestines' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'C44 -  Other Malignant Neoplasm of Skin' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_SKIN_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'C44 -  Other Malignant Neoplasm of Skin' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_SKIN_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'C44 -  Other Malignant Neoplasm of Skin' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_SKIN_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'C34 - Malignant Neoplasm of Bronchus & Lung' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LUNG_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'C34 - Malignant Neoplasm of Bronchus & Lung' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LUNG_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'C34 - Malignant Neoplasm of Bronchus & Lung' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LUNG_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_BONE_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_BONE_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_BONE_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MALIGNANT_NEOPLASM_DISEASES_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MALIGNANT_NEOPLASM_DISEASES_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MALIGNANT_NEOPLASM_DISEASES_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'K74 - Fibrosis and cirrhosis of liver' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FIBROID_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'K74 - Fibrosis and cirrhosis of liver' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FIBROID_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'K74 - Fibrosis and cirrhosis of liver' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FIBROID_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'C61 - Malignant Neoplasms of Prostate' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BENIGH_PROSTATE_HYPAPLASIA_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'C61 - Malignant Neoplasms of Prostate' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BENIGH_PROSTATE_HYPAPLASIA_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'C61 - Malignant Neoplasms of Prostate' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BENIGH_PROSTATE_HYPAPLASIA_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'C50 - MALIGNANT NEOPLASM OF BREAST' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INSITION_OF_BREAST_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'C50 - MALIGNANT NEOPLASM OF BREAST' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INSITION_OF_BREAST_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'C50 - MALIGNANT NEOPLASM OF BREAST' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INSITION_OF_BREAST_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 323 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_BENIGH_NEOPLASM_MALE
				  ,SUM(CASE WHEN SM.ParentId = 323 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_BENIGH_NEOPLASM_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 323 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_BENIGH_NEOPLASM_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'D64 - Other Anaemias' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SEVERE_ANAEMIA_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'D64 - Other Anaemias' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SEVERE_ANAEMIA_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'D64 - Other Anaemias' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SEVERE_ANAEMIA_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'D53 - Other Nutritional Anaemias' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_NUTRITIONAL_ANAEMIA_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'D53 - Other Nutritional Anaemias' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_NUTRITIONAL_ANAEMIA_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'D53 - Other Nutritional Anaemias' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_NUTRITIONAL_ANAEMIA_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'D57 - Sickle-cell disorders' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SICKLE_CELL_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'D57 - Sickle-cell disorders' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SICKLE_CELL_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'D57 - Sickle-cell disorders' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SICKLE_CELL_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 365 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISORDER_OF_THYROID_GLAND_MALE
				  ,SUM(CASE WHEN SM.ParentId = 365 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISORDER_OF_THYROID_GLAND_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 365 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISORDER_OF_THYROID_GLAND_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 372 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DIABETES_MELLITUS_MALE
				  ,SUM(CASE WHEN SM.ParentId = 372 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DIABETES_MELLITUS_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 372 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DIABETES_MELLITUS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'E16.2 - Hypoglyceamia' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HYPOGLYCAEMIA_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'E16.2 - Hypoglyceamia' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HYPOGLYCAEMIA_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'E16.2 - Hypoglyceamia' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HYPOGLYCAEMIA_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'E40 - Kwashiorkor' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS KWASHIORKOR_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'E40 - Kwashiorkor' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS KWASHIORKOR_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'E40 - Kwashiorkor' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS KWASHIORKOR_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 382 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MALNUTRITION_MALE
				  ,SUM(CASE WHEN SM.ParentId = 382 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MALNUTRITION_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 382 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MALNUTRITION_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'E66 - Obesity' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OBESITY_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'E66 - Obesity' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OBESITY_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'E66 - Obesity' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OBESITY_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'F32 - Depressive episode' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DEPRESSION_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'F32 - Depressive episode' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DEPRESSION_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'F32 - Depressive episode' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DEPRESSION_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'F78 - Other mental retardation' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MENTAL_DISORDER_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'F78 - Other mental retardation' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MENTAL_DISORDER_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'F78 - Other mental retardation' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_MENTAL_DISORDER_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'G01 - Meningitis due to other unspecified causes' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MENINGITIS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'G01 - Meningitis due to other unspecified causes' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MENINGITIS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'G01 - Meningitis due to other unspecified causes' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MENINGITIS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'G40 - Epilepsy' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS EPILEPSY_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'G40 - Epilepsy' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS EPILEPSY_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'G40 - Epilepsy' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS EPILEPSY_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'G43 - Migraine' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MIGRAINE_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'G43 - Migraine' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MIGRAINE_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'G43 - Migraine' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MIGRAINE_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DISEASES_OF_CNS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DISEASES_OF_CNS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DISEASES_OF_CNS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'G80 - Cerebral palsy' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CEREBRAL_PALSY_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'G80 - Cerebral palsy' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CEREBRAL_PALSY_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'G80 - Cerebral palsy' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CEREBRAL_PALSY_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 463 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_PARALYTIC_SYNDRONES_MALE
				  ,SUM(CASE WHEN SM.ParentId = 463 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_PARALYTIC_SYNDRONES_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 463 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_PARALYTIC_SYNDRONES_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'B30 - Viral Conjuctivitis' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONJUCTIVITIS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B30 - Viral Conjuctivitis' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONJUCTIVITIS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'B30 - Viral Conjuctivitis' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONJUCTIVITIS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'H25 - Senile Cataract' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CATARACT_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'H25 - Senile Cataract' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CATARACT_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'H25 - Senile Cataract' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CATARACT_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'H40 - Glaucoma' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GLAUCOMA_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'H40 - Glaucoma' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GLAUCOMA_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'H40 - Glaucoma' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GLAUCOMA_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'O70 - Perineal laceration during delivery' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONEAL_LACERATION_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'O70 - Perineal laceration during delivery' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONEAL_LACERATION_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'O70 - Perineal laceration during delivery' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONEAL_LACERATION_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'S05 - Injury of eye and orbit' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_EYES_DISORDERS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'S05 - Injury of eye and orbit' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_EYES_DISORDERS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'S05 - Injury of eye and orbit' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_EYES_DISORDERS_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 488 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_EAR_AND_MASTOID_PROCESS_MALE
				  ,SUM(CASE WHEN SM.ParentId = 488 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_EAR_AND_MASTOID_PROCESS_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 488 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_EAR_AND_MASTOID_PROCESS_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 505 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS RHEUNMATIC_FEVER_MALE
				  ,SUM(CASE WHEN SM.ParentId = 505 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS RHEUNMATIC_FEVER_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 505 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS RHEUNMATIC_FEVER_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 511 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HYPERTENSIVE_DISEASES_MALE
				  ,SUM(CASE WHEN SM.ParentId = 511 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HYPERTENSIVE_DISEASES_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 511 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HYPERTENSIVE_DISEASES_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 533 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CEREBRO_VASCULAR_ACCIDENT_MALE
				  ,SUM(CASE WHEN SM.ParentId = 533 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CEREBRO_VASCULAR_ACCIDENT_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 533 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CEREBRO_VASCULAR_ACCIDENT_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName IN ('I46 - Cardiac arrest','I50 - Heart failure') AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CARDIAC_ARREST_HEART_FAILURE_MALE
				  ,SUM(CASE WHEN SM.ServiceName IN ('I46 - Cardiac arrest','I50 - Heart failure') AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CARDIAC_ARREST_HEART_FAILURE_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName IN ('I46 - Cardiac arrest','I50 - Heart failure') AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CARDIAC_ARREST_HEART_FAILURE_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 526 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_FORM_OF_HEART_DISEASES_MALE
				  ,SUM(CASE WHEN SM.ParentId = 526 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_FORM_OF_HEART_DISEASES_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 526 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_FORM_OF_HEART_DISEASES_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BRONCHO_PNEUMONIA_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BRONCHO_PNEUMONIA_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BRONCHO_PNEUMONIA_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'J20 - Acute Bronchitis' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BRONCHITIS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'J20 - Acute Bronchitis' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BRONCHITIS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'J20 - Acute Bronchitis' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BRONCHITIS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'J45 - Asthma' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ASTHMA_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'J45 - Asthma' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ASTHMA_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'J45 - Asthma' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ASTHMA_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 560 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_RESPIRATORY_DISEASES_MALE
				  ,SUM(CASE WHEN SM.ParentId = 560 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_RESPIRATORY_DISEASES_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 560 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_RESPIRATORY_DISEASES_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'K02 - Dental Caries' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DENTAL_DISEASES_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'K02 - Dental Caries' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DENTAL_DISEASES_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'K02 - Dental Caries' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DENTAL_DISEASES_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'K25 - Gastric Ulcer' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ULCER_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'K25 - Gastric Ulcer' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ULCER_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'K25 - Gastric Ulcer' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ULCER_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'K35 - Acute Appendicitis' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS APPENDICITIS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'K35 - Acute Appendicitis' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS APPENDICITIS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'K35 - Acute Appendicitis' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS APPENDICITIS_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 605 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HERNIA_MALE
				  ,SUM(CASE WHEN SM.ParentId = 605 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HERNIA_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 605 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HERNIA_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'K65 - Peritonitis' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PERITONITIS_INTESTINAL_OBSTRUCTION_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'K65 - Peritonitis' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PERITONITIS_INTESTINAL_OBSTRUCTION_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'K65 - Peritonitis' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PERITONITIS_INTESTINAL_OBSTRUCTION_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 622 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS LIVER_DISEASES_MALE
				  ,SUM(CASE WHEN SM.ParentId = 622 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS LIVER_DISEASES_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 622 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS LIVER_DISEASES_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 584 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DIGESTIVE_SYSTEM_DISEASES_MALE
				  ,SUM(CASE WHEN SM.ParentId = 584 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DIGESTIVE_SYSTEM_DISEASES_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 584 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DIGESTIVE_SYSTEM_DISEASES_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 636 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_MALE
				  ,SUM(CASE WHEN SM.ParentId = 636 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 636 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_MUSCULOSKELETAL_SYS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_MUSCULOSKELETAL_SYS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DISEASES_OF_MUSCULOSKELETAL_SYS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'N00 - Acute Nephritic syndrome' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ACUTE_NEPHRITIS_SYNDROME_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'N00 - Acute Nephritic syndrome' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ACUTE_NEPHRITIS_SYNDROME_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'N00 - Acute Nephritic syndrome' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ACUTE_NEPHRITIS_SYNDROME_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'N17 - Acute renal failure' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ACUTE_RENAL_FAILURE_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'N17 - Acute renal failure' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ACUTE_RENAL_FAILURE_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'N17 - Acute renal failure' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ACUTE_RENAL_FAILURE_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_GENTOURINARY_DISEASES_MALE
				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_GENTOURINARY_DISEASES_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_GENTOURINARY_DISEASES_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'N46 - Male Infertility' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALE_INFERTILITY_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'N46 - Male Infertility' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALE_INFERTILITY_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'N46 - Male Infertility' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALE_INFERTILITY_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'Q55 - Other Congenital malformation of male genital organs' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'Q55 - Other Congenital malformation of male genital organs' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'Q55 - Other Congenital malformation of male genital organs' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 711 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_MALE
				  ,SUM(CASE WHEN SM.ParentId = 711 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 711 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 718 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_MALE
				  ,SUM(CASE WHEN SM.ParentId = 718 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 718 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'N97 - Female Infertility' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FEMALE_INFERTILITY_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'N97 - Female Infertility' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FEMALE_INFERTILITY_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'N97 - Female Infertility' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FEMALE_INFERTILITY_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'N95 - Menopausal and other perimenopausal disorders' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MENOPOUSAL_DISORDER_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'N95 - Menopausal and other perimenopausal disorders' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MENOPOUSAL_DISORDER_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'N95 - Menopausal and other perimenopausal disorders' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MENOPOUSAL_DISORDER_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'Q52 - Other Congenital malformation of female genitalia' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_FEMALE_GENITAL_DISEASES_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'Q52 - Other Congenital malformation of female genitalia' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_FEMALE_GENITAL_DISEASES_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'Q52 - Other Congenital malformation of female genitalia' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_FEMALE_GENITAL_DISEASES_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'O00 - Ectopic pregnancy' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ECTOPIC_PREGNANCY_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'O00 - Ectopic pregnancy' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ECTOPIC_PREGNANCY_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'O00 - Ectopic pregnancy' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ECTOPIC_PREGNANCY_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'O03 - Spontanous abortion' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SPONTENEOUS_ABORTION_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'O03 - Spontanous abortion' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SPONTENEOUS_ABORTION_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'O03 - Spontanous abortion' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SPONTENEOUS_ABORTION_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'O15 - Eclampsia' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ECLAMPSIA_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'O15 - Eclampsia' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ECLAMPSIA_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'O15 - Eclampsia' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ECLAMPSIA_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 753 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_PREGNANCY_RELATED_DISEASES_MALE
				  ,SUM(CASE WHEN SM.ParentId = 753 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_PREGNANCY_RELATED_DISEASES_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 753 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_PREGNANCY_RELATED_DISEASES_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'O60 - Preterm Labour' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PRETERIM_DELIVERY_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'O60 - Preterm Labour' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PRETERIM_DELIVERY_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'O60 - Preterm Labour' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PRETERIM_DELIVERY_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POST_PERTUM_HEAMORRHAGE_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POST_PERTUM_HEAMORRHAGE_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POST_PERTUM_HEAMORRHAGE_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'O64 - Obstucted labour due to malposition & malpresentation of fetus' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OBSTRUCTED_LABOUR_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'O64 - Obstucted labour due to malposition & malpresentation of fetus' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OBSTRUCTED_LABOUR_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'O64 - Obstucted labour due to malposition & malpresentation of fetus' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OBSTRUCTED_LABOUR_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'O75 - Other complications of labour and delivery NEC' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'O75 - Other complications of labour and delivery NEC' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'O75 - Other complications of labour and delivery NEC' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'A41 - Sepsis' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PUERPERAL_SEPSIS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A41 - Sepsis' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PUERPERAL_SEPSIS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'A41 - Sepsis' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PUERPERAL_SEPSIS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'P21 - Birth Asphyxia' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BIRTH_ASPHYXIA_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'P21 - Birth Asphyxia' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BIRTH_ASPHYXIA_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'P21 - Birth Asphyxia' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BIRTH_ASPHYXIA_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'P59 - Neonatal Jaundice from other and unspecified causes' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NEONATAL_JAUNDICE_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'P59 - Neonatal Jaundice from other and unspecified causes' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NEONATAL_JAUNDICE_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'P59 - Neonatal Jaundice from other and unspecified causes' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NEONATAL_JAUNDICE_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 848 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_MALE
				  ,SUM(CASE WHEN SM.ParentId = 848 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 848 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'R05 - Cough' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS COUGH_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'R05 - Cough' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS COUGH_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'R05 - Cough' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS COUGH_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'R82 - Other abnormal findings of urine' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'R82 - Other abnormal findings of urine' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'R82 - Other abnormal findings of urine' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'R50 - Fever of other and unknown origin' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FEVER_OF_UNKNOWN_ORIGIN_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'R50 - Fever of other and unknown origin' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FEVER_OF_UNKNOWN_ORIGIN_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'R50 - Fever of other and unknown origin' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FEVER_OF_UNKNOWN_ORIGIN_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'R68 - Other general symptoms and signs' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_GENERAL_SYMPTONS_AND_SIGNS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'R68 - Other general symptoms and signs' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_GENERAL_SYMPTONS_AND_SIGNS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'R68 - Other general symptoms and signs' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_GENERAL_SYMPTONS_AND_SIGNS_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 975 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HEAD_INJURY_MALE
				  ,SUM(CASE WHEN SM.ParentId = 975 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HEAD_INJURY_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 975 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HEAD_INJURY_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'S09 - Other and unspecified injuries of head' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_INJURY_TO_THE_HEAD_REGION_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'S09 - Other and unspecified injuries of head' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_INJURY_TO_THE_HEAD_REGION_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'S09 - Other and unspecified injuries of head' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_INJURY_TO_THE_HEAD_REGION_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'T02 - Fractures involving multiple body regions' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_INJURY_POISON_FRACTURE_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'T02 - Fractures involving multiple body regions' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_INJURY_POISON_FRACTURE_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'T02 - Fractures involving multiple body regions' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHER_INJURY_POISON_FRACTURE_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'W44 - Foreign body entering into or through eye or natural orifice' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FOREIGN_BODY_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'W44 - Foreign body entering into or through eye or natural orifice' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FOREIGN_BODY_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'W44 - Foreign body entering into or through eye or natural orifice' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FOREIGN_BODY_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 1109 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BURNS_AND_CORROSIONS_MALE
				  ,SUM(CASE WHEN SM.ParentId = 1109 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BURNS_AND_CORROSIONS_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 1109 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BURNS_AND_CORROSIONS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = 'T36 - Poisoning by systematic antibiotics' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POISONS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = 'T36 - Poisoning by systematic antibiotics' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POISONS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = 'T36 - Poisoning by systematic antibiotics' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS POISONS_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 1278 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TRANSPORTATION_ACCIDENTS_MALE
				  ,SUM(CASE WHEN SM.ParentId = 1278 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TRANSPORTATION_ACCIDENTS_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 1278 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TRANSPORTATION_ACCIDENTS_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 1303 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FALLS_MALE
				  ,SUM(CASE WHEN SM.ParentId = 1303 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FALLS_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 1303 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FALLS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS WEAPONS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS WEAPONS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS WEAPONS_TOTAL

				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GUNS_MALE
				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GUNS_FEMALE
				  ,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GUNS_TOTAL

				  ,SUM(CASE WHEN SM.ParentId = 1460 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INTENTIONAL_SELF_HARM_MALE
				  ,SUM(CASE WHEN SM.ParentId = 1460 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INTENTIONAL_SELF_HARM_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = 1460 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS INTENTIONAL_SELF_HARM_TOTAL

				  ,SUM(CASE WHEN CD.Gender = 1 AND SM.ServiceName IN ('A00 - Cholera','A01 - Typhoid and parathyphoid fevers','A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin','A35 - Other Tetanus','A40 - Streptococcal Septicaemia','A64 - Unspecified sexually transmitted disease','A80 - Acute poliomyelitis','A82 - Rabies','A95 - Yellow fever','B01 - Varicella (chicken pox)','B05 - Measles','B02 - Zoster (herpes zoster)','B07 - Viral warts','B24 - Unspecified HIV diseases/Immuno suppression','B54 - Unspecified Malaria','B77 - Ascariasis','B83 - Other Helminthiases','C17 - Malignant Neoplasm of Small Intestines','C44 -  Other Malignant Neoplasm of Skin','C34 - Malignant Neoplasm of Bronchus & Lung','C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs','C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues','K74 - Fibrosis and cirrhosis of liver','C61 - Malignant Neoplasms of Prostate','C50 - MALIGNANT NEOPLASM OF BREAST','D64 - Other Anaemias','D53 - Other Nutritional Anaemias','D57 - Sickle-cell disorders','E16.2 - Hypoglyceamia','E40 - Kwashiorkor','E66 - Obesity','F32 - Depressive episode','F78 - Other mental retardation','G01 - Meningitis due to other unspecified causes','G40 - Epilepsy','G43 - Migraine','C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS','G80 - Cerebral palsy','B30 - Viral Conjuctivitis','H25 - Senile Cataract','H40 - Glaucoma','O70 - Perineal laceration during delivery','S05 - Injury of eye and orbit','I46 - Cardiac arrest','I50 - Heart failure','J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]','J20 - Acute Bronchitis','J45 - Asthma','K02 - Dental Caries','K25 - Gastric Ulcer','K35 - Acute Appendicitis','K65 - Peritonitis','R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ','N00 - Acute Nephritic syndrome','N17 - Acute renal failure','N46 - Male Infertility','Q55 - Other Congenital malformation of male genital organs','N97 - Female Infertility','N95 - Menopausal and other perimenopausal disorders','Q52 - Other Congenital malformation of female genitalia','O00 - Ectopic pregnancy','O03 - Spontanous abortion','O15 - Eclampsia','O60 - Preterm Labour','Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care','O64 - Obstucted labour due to malposition & malpresentation of fetus','O75 - Other complications of labour and delivery NEC','A41 - Sepsis','P21 - Birth Asphyxia','P59 - Neonatal Jaundice from other and unspecified causes','R05 - Cough','R82 - Other abnormal findings of urine','R50 - Fever of other and unknown origin','R68 - Other general symptoms and signs','S09 - Other and unspecified injuries of head','T02 - Fractures involving multiple body regions','W44 - Foreign body entering into or through eye or natural orifice','T36 - Poisoning by systematic antibiotics')
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) +
				   SUM(CASE WHEN CD.Gender = 1 AND SM.ParentId IN (96,102,112,158,184,194,200,221,323,365,372,382,463,488,505,511,533,526,560,605,622,584,636,711,718,753,848,975,1109,1278,1303,1460)
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MALE_TOTAL
				  ,SUM(CASE WHEN CD.Gender = 2 AND SM.ServiceName IN ('A00 - Cholera','A01 - Typhoid and parathyphoid fevers','A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin','A35 - Other Tetanus','A40 - Streptococcal Septicaemia','A64 - Unspecified sexually transmitted disease','A80 - Acute poliomyelitis','A82 - Rabies','A95 - Yellow fever','B01 - Varicella (chicken pox)','B05 - Measles','B02 - Zoster (herpes zoster)','B07 - Viral warts','B24 - Unspecified HIV diseases/Immuno suppression','B54 - Unspecified Malaria','B77 - Ascariasis','B83 - Other Helminthiases','C17 - Malignant Neoplasm of Small Intestines','C44 -  Other Malignant Neoplasm of Skin','C34 - Malignant Neoplasm of Bronchus & Lung','C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs','C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues','K74 - Fibrosis and cirrhosis of liver','C61 - Malignant Neoplasms of Prostate','C50 - MALIGNANT NEOPLASM OF BREAST','D64 - Other Anaemias','D53 - Other Nutritional Anaemias','D57 - Sickle-cell disorders','E16.2 - Hypoglyceamia','E40 - Kwashiorkor','E66 - Obesity','F32 - Depressive episode','F78 - Other mental retardation','G01 - Meningitis due to other unspecified causes','G40 - Epilepsy','G43 - Migraine','C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS','G80 - Cerebral palsy','B30 - Viral Conjuctivitis','H25 - Senile Cataract','H40 - Glaucoma','O70 - Perineal laceration during delivery','S05 - Injury of eye and orbit','I46 - Cardiac arrest','I50 - Heart failure','J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]','J20 - Acute Bronchitis','J45 - Asthma','K02 - Dental Caries','K25 - Gastric Ulcer','K35 - Acute Appendicitis','K65 - Peritonitis','R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ','N00 - Acute Nephritic syndrome','N17 - Acute renal failure','N46 - Male Infertility','Q55 - Other Congenital malformation of male genital organs','N97 - Female Infertility','N95 - Menopausal and other perimenopausal disorders','Q52 - Other Congenital malformation of female genitalia','O00 - Ectopic pregnancy','O03 - Spontanous abortion','O15 - Eclampsia','O60 - Preterm Labour','Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care','O64 - Obstucted labour due to malposition & malpresentation of fetus','O75 - Other complications of labour and delivery NEC','A41 - Sepsis','P21 - Birth Asphyxia','P59 - Neonatal Jaundice from other and unspecified causes','R05 - Cough','R82 - Other abnormal findings of urine','R50 - Fever of other and unknown origin','R68 - Other general symptoms and signs','S09 - Other and unspecified injuries of head','T02 - Fractures involving multiple body regions','W44 - Foreign body entering into or through eye or natural orifice','T36 - Poisoning by systematic antibiotics')
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) +
				   SUM(CASE WHEN CD.Gender = 2 AND SM.ParentId IN (96,102,112,158,184,194,200,221,323,365,372,382,463,488,505,511,533,526,560,605,622,584,636,711,718,753,848,975,1109,1278,1303,1460)
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FEMALE_TOTAL
				  ,SUM(CASE WHEN CD.Gender IN (1,2) AND SM.ServiceName IN ('A00 - Cholera','A01 - Typhoid and parathyphoid fevers','A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin','A35 - Other Tetanus','A40 - Streptococcal Septicaemia','A64 - Unspecified sexually transmitted disease','A80 - Acute poliomyelitis','A82 - Rabies','A95 - Yellow fever','B01 - Varicella (chicken pox)','B05 - Measles','B02 - Zoster (herpes zoster)','B07 - Viral warts','B24 - Unspecified HIV diseases/Immuno suppression','B54 - Unspecified Malaria','B77 - Ascariasis','B83 - Other Helminthiases','C17 - Malignant Neoplasm of Small Intestines','C44 -  Other Malignant Neoplasm of Skin','C34 - Malignant Neoplasm of Bronchus & Lung','C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs','C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues','K74 - Fibrosis and cirrhosis of liver','C61 - Malignant Neoplasms of Prostate','C50 - MALIGNANT NEOPLASM OF BREAST','D64 - Other Anaemias','D53 - Other Nutritional Anaemias','D57 - Sickle-cell disorders','E16.2 - Hypoglyceamia','E40 - Kwashiorkor','E66 - Obesity','F32 - Depressive episode','F78 - Other mental retardation','G01 - Meningitis due to other unspecified causes','G40 - Epilepsy','G43 - Migraine','C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS','G80 - Cerebral palsy','B30 - Viral Conjuctivitis','H25 - Senile Cataract','H40 - Glaucoma','O70 - Perineal laceration during delivery','S05 - Injury of eye and orbit','I46 - Cardiac arrest','I50 - Heart failure','J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]','J20 - Acute Bronchitis','J45 - Asthma','K02 - Dental Caries','K25 - Gastric Ulcer','K35 - Acute Appendicitis','K65 - Peritonitis','R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ','N00 - Acute Nephritic syndrome','N17 - Acute renal failure','N46 - Male Infertility','Q55 - Other Congenital malformation of male genital organs','N97 - Female Infertility','N95 - Menopausal and other perimenopausal disorders','Q52 - Other Congenital malformation of female genitalia','O00 - Ectopic pregnancy','O03 - Spontanous abortion','O15 - Eclampsia','O60 - Preterm Labour','Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care','O64 - Obstucted labour due to malposition & malpresentation of fetus','O75 - Other complications of labour and delivery NEC','A41 - Sepsis','P21 - Birth Asphyxia','P59 - Neonatal Jaundice from other and unspecified causes','R05 - Cough','R82 - Other abnormal findings of urine','R50 - Fever of other and unknown origin','R68 - Other general symptoms and signs','S09 - Other and unspecified injuries of head','T02 - Fractures involving multiple body regions','W44 - Foreign body entering into or through eye or natural orifice','T36 - Poisoning by systematic antibiotics')
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) +
				   SUM(CASE WHEN CD.Gender IN (1,2) AND SM.ParentId IN (96,102,112,158,184,194,200,221,323,365,372,382,463,488,505,511,533,526,560,605,622,584,636,711,718,753,848,975,1109,1278,1303,1460)
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GRAND_TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.CaseDetail AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE ((CD.CMonth >= @CMonth AND CD.CMonth <= @EMonth) OR (@CMonth + @EMonth = 0))
			AND (CD.CYear = @CYear)
			AND (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.CaseType = 1)
			AND (CD.HType >= @HType) 
			AND (CD.HType <= @HType1)
			GROUP BY CM.CName
		END
	ELSE IF (@DateMode = 2)
		BEGIN
			SELECT 0 AS SrNo
				  ,HospitalName

				  ,CHOLERA_MALE
				  ,CHOLERA_FEMALE
				  ,(CHOLERA_MALE + CHOLERA_FEMALE) AS CHOLERA_TOTAL
				  
				  ,TYPHOID_FEVER_MALE
				  ,TYPHOID_FEVER_FEMALE
				  ,(TYPHOID_FEVER_MALE + TYPHOID_FEVER_FEMALE) AS TYPHOID_FEVER_TOTAL
				  
				  ,DIARRHOEA_MALE
				  ,DIARRHOEA_FEMALE
				  ,(DIARRHOEA_MALE + DIARRHOEA_FEMALE) AS DIARRHOEA_TOTAL
				  
				  ,TUBERCULOSIS_MALE
				  ,TUBERCULOSIS_FEMALE
				  ,(TUBERCULOSIS_MALE+TUBERCULOSIS_FEMALE) AS TUBERCULOSIS_TOTAL
				  
				  ,ZOONATIC_INFECTION_MALE
				  ,ZOONATIC_INFECTION_FEMALE
				  ,(ZOONATIC_INFECTION_MALE+ZOONATIC_INFECTION_FEMALE) AS ZOONATIC_INFECTION_TOTAL

				  ,TETANUS_MALE
				  ,TETANUS_FEMALE
				  ,(TETANUS_MALE+TETANUS_FEMALE) AS TETANUS_TOTAL

				  ,STREPTOCOCCAL_SEPTICAEMIA_MALE
				  ,STREPTOCOCCAL_SEPTICAEMIA_FEMALE
				  ,(STREPTOCOCCAL_SEPTICAEMIA_MALE + STREPTOCOCCAL_SEPTICAEMIA_FEMALE) AS STREPTOCOCCAL_SEPTICAEMIA_TOTAL

				  ,OTHER_BACTERIA_DXS_MALE
				  ,OTHER_BACTERIA_DXS_FEMALE
				  ,(OTHER_BACTERIA_DXS_MALE+OTHER_BACTERIA_DXS_FEMALE) AS OTHER_BACTERIA_DXS_TOTAL

				  ,SEXUALLY_TRANSMITTED_DISEASES_MALE
				  ,SEXUALLY_TRANSMITTED_DISEASES_FEMALE
				  ,(SEXUALLY_TRANSMITTED_DISEASES_MALE+SEXUALLY_TRANSMITTED_DISEASES_FEMALE) AS SEXUALLY_TRANSMITTED_DISEASES_TOTAL

				  ,POLIOMYELITES_MALE
				  ,POLIOMYELITES_FEMALE
				  ,(POLIOMYELITES_MALE+POLIOMYELITES_FEMALE) AS POLIOMYELITES_TOTAL

				  ,RABIES_MALE
				  ,RABIES_FEMALE
				  ,(RABIES_MALE + RABIES_FEMALE) AS RABIES_TOTAL

				  ,OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_MALE
				  ,OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_FEMALE
				  ,(OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_MALE+OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_FEMALE) AS OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_TOTAL

				  ,YELLOW_FEVER_MALE
				  ,YELLOW_FEVER_FEMALE
				  ,(YELLOW_FEVER_MALE+YELLOW_FEVER_FEMALE) AS YELLOW_FEVER_TOTAL
		  
				  ,CHICKEN_POX_MALE
				  ,CHICKEN_POX_FEMALE
				  ,(CHICKEN_POX_MALE+CHICKEN_POX_FEMALE) AS CHICKEN_POX_TOTAL
		  
				  ,MEASLES_MALE
				  ,MEASLES_FEMALE
				  ,(MEASLES_MALE+MEASLES_FEMALE) AS MEASLES_TOTAL

				  ,HERPES_ZOSTER_MALE
				  ,HERPES_ZOSTER_FEMALE
				  ,(HERPES_ZOSTER_MALE+HERPES_ZOSTER_FEMALE) AS HERPES_ZOSTER_TOTAL

				  ,VIRAL_WARTS_MALE
				  ,VIRAL_WARTS_FEMALE
				  ,(VIRAL_WARTS_MALE+VIRAL_WARTS_FEMALE) AS VIRAL_WARTS_TOTAL

				  ,VIRAL_HEPATITIS_MALE
				  ,VIRAL_HEPATITIS_FEMALE
				  ,(VIRAL_HEPATITIS_MALE+VIRAL_HEPATITIS_FEMALE) AS VIRAL_HEPATITIS_TOTAL

				  ,HIV_DISEASES_MALE
				  ,HIV_DISEASES_FEMALE
				  ,(HIV_DISEASES_MALE+HIV_DISEASES_FEMALE) AS HIV_DISEASES_TOTAL

				  ,OTHER_VIRAL_DXS_MALE
				  ,OTHER_VIRAL_DXS_FEMALE
				  ,(OTHER_VIRAL_DXS_MALE+OTHER_VIRAL_DXS_FEMALE) AS OTHER_VIRAL_DXS_TOTAL

				  ,MYCOSES_MALE
				  ,MYCOSES_FEMALE
				  ,(MYCOSES_MALE+MYCOSES_FEMALE) AS MYCOSES_TOTAL

				  ,MALARIA_MALE
				  ,MALARIA_FEMALE
				  ,(MALARIA_MALE+MALARIA_FEMALE) AS MALARIA_TOTAL

				  ,HELMINTHIASIS_MALE
				  ,HELMINTHIASIS_FEMALE
				  ,(HELMINTHIASIS_MALE+HELMINTHIASIS_FEMALE) AS HELMINTHIASIS_TOTAL

				  ,HOOKWORM_DISEASES_MALE
				  ,HOOKWORM_DISEASES_FEMALE
				  ,(HOOKWORM_DISEASES_MALE+HOOKWORM_DISEASES_FEMALE) AS HOOKWORM_DISEASES_TOTAL

				  ,ASCARIASIS_MALE
				  ,ASCARIASIS_FEMALE
				  ,(ASCARIASIS_MALE+ASCARIASIS_FEMALE) AS ASCARIASIS_TOTAL

				  ,OTHER_HELMINTHIASIS_MALE
				  ,OTHER_HELMINTHIASIS_FEMALE
				  ,(OTHER_HELMINTHIASIS_MALE+OTHER_HELMINTHIASIS_FEMALE) AS OTHER_HELMINTHIASIS_TOTAL

				  ,MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_MALE
				  ,MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_FEMALE
				  ,(MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_MALE+MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_FEMALE) AS MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_TOTAL

				  ,MALIGNANT_NEOPLASM_OF_SKIN_MALE
				  ,MALIGNANT_NEOPLASM_OF_SKIN_FEMALE
				  ,(MALIGNANT_NEOPLASM_OF_SKIN_MALE+MALIGNANT_NEOPLASM_OF_SKIN_FEMALE) AS MALIGNANT_NEOPLASM_OF_SKIN_TOTAL

				  ,MALIGNANT_NEOPLASM_OF_LUNG_MALE
				  ,MALIGNANT_NEOPLASM_OF_LUNG_FEMALE
				  ,(MALIGNANT_NEOPLASM_OF_LUNG_MALE+MALIGNANT_NEOPLASM_OF_LUNG_FEMALE) AS MALIGNANT_NEOPLASM_OF_LUNG_TOTAL

				  ,MALIGNANT_NEOPLASM_OF_BONE_MALE
				  ,MALIGNANT_NEOPLASM_OF_BONE_FEMALE
				  ,(MALIGNANT_NEOPLASM_OF_BONE_MALE+MALIGNANT_NEOPLASM_OF_BONE_FEMALE) AS MALIGNANT_NEOPLASM_OF_BONE_TOTAL

				  ,OTHER_MALIGNANT_NEOPLASM_DISEASES_MALE
				  ,OTHER_MALIGNANT_NEOPLASM_DISEASES_FEMALE
				  ,(OTHER_MALIGNANT_NEOPLASM_DISEASES_MALE+OTHER_MALIGNANT_NEOPLASM_DISEASES_FEMALE) AS OTHER_MALIGNANT_NEOPLASM_DISEASES_TOTAL

				  ,FIBROID_MALE
				  ,FIBROID_FEMALE
				  ,(FIBROID_MALE+FIBROID_FEMALE) AS FIBROID_TOTAL

				  ,BENIGH_PROSTATE_HYPAPLASIA_MALE
				  ,BENIGH_PROSTATE_HYPAPLASIA_FEMALE
				  ,(BENIGH_PROSTATE_HYPAPLASIA_MALE+BENIGH_PROSTATE_HYPAPLASIA_FEMALE) AS BENIGH_PROSTATE_HYPAPLASIA_TOTAL

				  ,INSITION_OF_BREAST_MALE
				  ,INSITION_OF_BREAST_FEMALE
				  ,(INSITION_OF_BREAST_MALE+INSITION_OF_BREAST_FEMALE) AS INSITION_OF_BREAST_TOTAL

				  ,OTHER_BENIGH_NEOPLASM_MALE
				  ,OTHER_BENIGH_NEOPLASM_FEMALE
				  ,(OTHER_BENIGH_NEOPLASM_MALE+OTHER_BENIGH_NEOPLASM_FEMALE) AS OTHER_BENIGH_NEOPLASM_TOTAL

				  ,SEVERE_ANAEMIA_MALE
				  ,SEVERE_ANAEMIA_FEMALE
				  ,(SEVERE_ANAEMIA_MALE+SEVERE_ANAEMIA_FEMALE) AS SEVERE_ANAEMIA_TOTAL

				  ,OTHER_NUTRITIONAL_ANAEMIA_MALE
				  ,OTHER_NUTRITIONAL_ANAEMIA_FEMALE
				  ,(OTHER_NUTRITIONAL_ANAEMIA_MALE+OTHER_NUTRITIONAL_ANAEMIA_FEMALE) AS OTHER_NUTRITIONAL_ANAEMIA_TOTAL

				  ,SICKLE_CELL_MALE
				  ,SICKLE_CELL_FEMALE
				  ,(SICKLE_CELL_MALE+SICKLE_CELL_FEMALE) AS SICKLE_CELL_TOTAL

				  ,DISORDER_OF_THYROID_GLAND_MALE
				  ,DISORDER_OF_THYROID_GLAND_FEMALE
				  ,(DISORDER_OF_THYROID_GLAND_MALE+DISORDER_OF_THYROID_GLAND_FEMALE) AS DISORDER_OF_THYROID_GLAND_TOTAL

				  ,DIABETES_MELLITUS_MALE
				  ,DIABETES_MELLITUS_FEMALE
				  ,(DIABETES_MELLITUS_MALE+DIABETES_MELLITUS_FEMALE) AS DIABETES_MELLITUS_TOTAL

				  ,HYPOGLYCAEMIA_MALE
				  ,HYPOGLYCAEMIA_FEMALE
				  ,(HYPOGLYCAEMIA_MALE+HYPOGLYCAEMIA_FEMALE) AS HYPOGLYCAEMIA_TOTAL

				  ,KWASHIORKOR_MALE
				  ,KWASHIORKOR_FEMALE
				  ,(KWASHIORKOR_MALE+KWASHIORKOR_FEMALE) AS KWASHIORKOR_TOTAL

				  ,OTHER_MALNUTRITION_MALE
				  ,OTHER_MALNUTRITION_FEMALE
				  ,(OTHER_MALNUTRITION_MALE+OTHER_MALNUTRITION_FEMALE) AS OTHER_MALNUTRITION_TOTAL

				  ,OBESITY_MALE
				  ,OBESITY_FEMALE
				  ,(OBESITY_MALE+OBESITY_FEMALE) AS OBESITY_TOTAL

				  ,DEPRESSION_MALE
				  ,DEPRESSION_FEMALE
				  ,(DEPRESSION_MALE+DEPRESSION_FEMALE) AS DEPRESSION_TOTAL

				  ,OTHER_MENTAL_DISORDER_MALE
				  ,OTHER_MENTAL_DISORDER_FEMALE
				  ,(OTHER_MENTAL_DISORDER_MALE+OTHER_MENTAL_DISORDER_FEMALE) AS OTHER_MENTAL_DISORDER_TOTAL

				  ,MENINGITIS_MALE
				  ,MENINGITIS_FEMALE
				  ,(MENINGITIS_MALE+MENINGITIS_FEMALE) AS MENINGITIS_TOTAL

				  ,EPILEPSY_MALE
				  ,EPILEPSY_FEMALE
				  ,(EPILEPSY_MALE+EPILEPSY_FEMALE) AS EPILEPSY_TOTAL

				  ,MIGRAINE_MALE
				  ,MIGRAINE_FEMALE
				  ,(MIGRAINE_MALE+MIGRAINE_FEMALE) AS MIGRAINE_TOTAL

				  ,OTHER_DISEASES_OF_CNS_MALE
				  ,OTHER_DISEASES_OF_CNS_FEMALE
				  ,(OTHER_DISEASES_OF_CNS_MALE+OTHER_DISEASES_OF_CNS_FEMALE) AS OTHER_DISEASES_OF_CNS_TOTAL

				  ,CEREBRAL_PALSY_MALE
				  ,CEREBRAL_PALSY_FEMALE
				  ,(CEREBRAL_PALSY_MALE+CEREBRAL_PALSY_FEMALE) AS CEREBRAL_PALSY_TOTAL

				  ,OTHER_PARALYTIC_SYNDRONES_MALE
				  ,OTHER_PARALYTIC_SYNDRONES_FEMALE
				  ,(OTHER_PARALYTIC_SYNDRONES_MALE+OTHER_PARALYTIC_SYNDRONES_FEMALE) AS OTHER_PARALYTIC_SYNDRONES_TOTAL

				  ,CONJUCTIVITIS_MALE
				  ,CONJUCTIVITIS_FEMALE
				  ,(CONJUCTIVITIS_MALE+CONJUCTIVITIS_FEMALE) AS CONJUCTIVITIS_TOTAL

				  ,CATARACT_MALE
				  ,CATARACT_FEMALE
				  ,(CATARACT_MALE+CATARACT_FEMALE) AS CATARACT_TOTAL

				  ,GLAUCOMA_MALE
				  ,GLAUCOMA_FEMALE
				  ,(GLAUCOMA_MALE+GLAUCOMA_FEMALE) AS GLAUCOMA_TOTAL

				  ,CONEAL_LACERATION_MALE
				  ,CONEAL_LACERATION_FEMALE
				  ,(CONEAL_LACERATION_MALE+CONEAL_LACERATION_FEMALE) AS CONEAL_LACERATION_TOTAL

				  ,OTHER_EYES_DISORDERS_MALE
				  ,OTHER_EYES_DISORDERS_FEMALE
				  ,(OTHER_EYES_DISORDERS_MALE+OTHER_EYES_DISORDERS_FEMALE) AS OTHER_EYES_DISORDERS_TOTAL

				  ,DISEASES_OF_EAR_AND_MASTOID_PROCESS_MALE
				  ,DISEASES_OF_EAR_AND_MASTOID_PROCESS_FEMALE
				  ,(DISEASES_OF_EAR_AND_MASTOID_PROCESS_MALE+DISEASES_OF_EAR_AND_MASTOID_PROCESS_FEMALE) AS DISEASES_OF_EAR_AND_MASTOID_PROCESS_TOTAL

				  ,RHEUNMATIC_FEVER_MALE
				  ,RHEUNMATIC_FEVER_FEMALE
				  ,(RHEUNMATIC_FEVER_MALE+RHEUNMATIC_FEVER_FEMALE) AS RHEUNMATIC_FEVER_TOTAL

				  ,HYPERTENSIVE_DISEASES_MALE
				  ,HYPERTENSIVE_DISEASES_FEMALE
				  ,(HYPERTENSIVE_DISEASES_MALE+HYPERTENSIVE_DISEASES_FEMALE) AS HYPERTENSIVE_DISEASES_TOTAL

				  ,CEREBRO_VASCULAR_ACCIDENT_MALE
				  ,CEREBRO_VASCULAR_ACCIDENT_FEMALE
				  ,(CEREBRO_VASCULAR_ACCIDENT_MALE+CEREBRO_VASCULAR_ACCIDENT_FEMALE) AS CEREBRO_VASCULAR_ACCIDENT_TOTAL

				  ,CARDIAC_ARREST_HEART_FAILURE_MALE
				  ,CARDIAC_ARREST_HEART_FAILURE_FEMALE
				  ,(CARDIAC_ARREST_HEART_FAILURE_MALE+CARDIAC_ARREST_HEART_FAILURE_FEMALE) AS CARDIAC_ARREST_HEART_FAILURE_TOTAL

				  ,OTHER_FORM_OF_HEART_DISEASES_MALE
				  ,OTHER_FORM_OF_HEART_DISEASES_FEMALE
				  ,(OTHER_FORM_OF_HEART_DISEASES_MALE+OTHER_FORM_OF_HEART_DISEASES_FEMALE) AS OTHER_FORM_OF_HEART_DISEASES_TOTAL

				  ,BRONCHO_PNEUMONIA_MALE
				  ,BRONCHO_PNEUMONIA_FEMALE
				  ,(BRONCHO_PNEUMONIA_MALE+BRONCHO_PNEUMONIA_FEMALE) AS BRONCHO_PNEUMONIA_TOTAL

				  ,BRONCHITIS_MALE
				  ,BRONCHITIS_FEMALE
				  ,(BRONCHITIS_MALE+BRONCHITIS_FEMALE) AS BRONCHITIS_TOTAL

				  ,ASTHMA_MALE
				  ,ASTHMA_FEMALE
				  ,(ASTHMA_MALE+ASTHMA_FEMALE) AS ASTHMA_TOTAL

				  ,OTHER_RESPIRATORY_DISEASES_MALE
				  ,OTHER_RESPIRATORY_DISEASES_FEMALE
				  ,(OTHER_RESPIRATORY_DISEASES_MALE+OTHER_RESPIRATORY_DISEASES_FEMALE) AS OTHER_RESPIRATORY_DISEASES_TOTAL

				  ,DENTAL_DISEASES_MALE
				  ,DENTAL_DISEASES_FEMALE
				  ,(DENTAL_DISEASES_MALE+DENTAL_DISEASES_FEMALE) AS DENTAL_DISEASES_TOTAL

				  ,ULCER_MALE
				  ,ULCER_FEMALE
				  ,(ULCER_MALE+ULCER_FEMALE) AS ULCER_TOTAL

				  ,APPENDICITIS_MALE
				  ,APPENDICITIS_FEMALE
				  ,(APPENDICITIS_MALE+APPENDICITIS_FEMALE) AS APPENDICITIS_TOTAL

				  ,HERNIA_MALE
				  ,HERNIA_FEMALE
				  ,(HERNIA_MALE+HERNIA_FEMALE) AS HERNIA_TOTAL

				  ,PERITONITIS_INTESTINAL_OBSTRUCTION_MALE
				  ,PERITONITIS_INTESTINAL_OBSTRUCTION_FEMALE
				  ,(PERITONITIS_INTESTINAL_OBSTRUCTION_MALE+PERITONITIS_INTESTINAL_OBSTRUCTION_FEMALE) AS PERITONITIS_INTESTINAL_OBSTRUCTION_TOTAL

				  ,LIVER_DISEASES_MALE
				  ,LIVER_DISEASES_FEMALE
				  ,(LIVER_DISEASES_MALE+LIVER_DISEASES_FEMALE) AS LIVER_DISEASES_TOTAL

				  ,OTHER_DIGESTIVE_SYSTEM_DISEASES_MALE
				  ,OTHER_DIGESTIVE_SYSTEM_DISEASES_FEMALE
				  ,(OTHER_DIGESTIVE_SYSTEM_DISEASES_MALE+OTHER_DIGESTIVE_SYSTEM_DISEASES_FEMALE) AS OTHER_DIGESTIVE_SYSTEM_DISEASES_TOTAL

				  ,DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_MALE
				  ,DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_FEMALE
				  ,(DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_MALE+DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_FEMALE) AS DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_TOTAL

				  ,DISEASES_OF_MUSCULOSKELETAL_SYS_MALE
				  ,DISEASES_OF_MUSCULOSKELETAL_SYS_FEMALE
				  ,(DISEASES_OF_MUSCULOSKELETAL_SYS_MALE+DISEASES_OF_MUSCULOSKELETAL_SYS_FEMALE) AS DISEASES_OF_MUSCULOSKELETAL_SYS_TOTAL

				  ,ACUTE_NEPHRITIS_SYNDROME_MALE
				  ,ACUTE_NEPHRITIS_SYNDROME_FEMALE
				  ,(ACUTE_NEPHRITIS_SYNDROME_MALE+ACUTE_NEPHRITIS_SYNDROME_FEMALE) AS ACUTE_NEPHRITIS_SYNDROME_TOTAL

				  ,ACUTE_RENAL_FAILURE_MALE
				  ,ACUTE_RENAL_FAILURE_FEMALE
				  ,(ACUTE_RENAL_FAILURE_MALE+ACUTE_RENAL_FAILURE_FEMALE) AS ACUTE_RENAL_FAILURE_TOTAL

				  ,OTHER_GENTOURINARY_DISEASES_MALE
				  ,OTHER_GENTOURINARY_DISEASES_FEMALE
				  ,(OTHER_GENTOURINARY_DISEASES_MALE+OTHER_GENTOURINARY_DISEASES_FEMALE) AS OTHER_GENTOURINARY_DISEASES_TOTAL

				  ,MALE_INFERTILITY_MALE
				  ,MALE_INFERTILITY_FEMALE
				  ,(MALE_INFERTILITY_MALE+MALE_INFERTILITY_FEMALE) AS MALE_INFERTILITY_TOTAL

				  ,OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_MALE
				  ,OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_FEMALE
				  ,(OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_MALE+OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_FEMALE) AS OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_TOTAL

				  ,INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_MALE
				  ,INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_FEMALE
				  ,(INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_MALE+INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_FEMALE) AS INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_TOTAL

				  ,NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_MALE
				  ,NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_FEMALE
				  ,(NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_MALE+NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_FEMALE) AS NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_TOTAL

				  ,FEMALE_INFERTILITY_MALE
				  ,FEMALE_INFERTILITY_FEMALE
				  ,(FEMALE_INFERTILITY_MALE+FEMALE_INFERTILITY_FEMALE) AS FEMALE_INFERTILITY_TOTAL

				  ,MENOPOUSAL_DISORDER_MALE
				  ,MENOPOUSAL_DISORDER_FEMALE
				  ,(MENOPOUSAL_DISORDER_MALE+MENOPOUSAL_DISORDER_FEMALE) AS MENOPOUSAL_DISORDER_TOTAL

				  ,OTHER_FEMALE_GENITAL_DISEASES_MALE
				  ,OTHER_FEMALE_GENITAL_DISEASES_FEMALE
				  ,(OTHER_FEMALE_GENITAL_DISEASES_MALE+OTHER_FEMALE_GENITAL_DISEASES_FEMALE) AS OTHER_FEMALE_GENITAL_DISEASES_TOTAL

				  ,ECTOPIC_PREGNANCY_MALE
				  ,ECTOPIC_PREGNANCY_FEMALE
				  ,(ECTOPIC_PREGNANCY_MALE+ECTOPIC_PREGNANCY_FEMALE) AS ECTOPIC_PREGNANCY_TOTAL

				  ,SPONTENEOUS_ABORTION_MALE
				  ,SPONTENEOUS_ABORTION_FEMALE
				  ,(SPONTENEOUS_ABORTION_MALE+SPONTENEOUS_ABORTION_FEMALE) AS SPONTENEOUS_ABORTION_TOTAL

				  ,ECLAMPSIA_MALE
				  ,ECLAMPSIA_FEMALE
				  ,(ECLAMPSIA_MALE+ECLAMPSIA_FEMALE) AS ECLAMPSIA_TOTAL

				  ,OTHER_PREGNANCY_RELATED_DISEASES_MALE
				  ,OTHER_PREGNANCY_RELATED_DISEASES_FEMALE
				  ,(OTHER_PREGNANCY_RELATED_DISEASES_MALE+OTHER_PREGNANCY_RELATED_DISEASES_FEMALE) AS OTHER_PREGNANCY_RELATED_DISEASES_TOTAL

				  ,PRETERIM_DELIVERY_MALE
				  ,PRETERIM_DELIVERY_FEMALE
				  ,(PRETERIM_DELIVERY_MALE+PRETERIM_DELIVERY_FEMALE) AS PRETERIM_DELIVERY_TOTAL

				  ,POST_PERTUM_HEAMORRHAGE_MALE
				  ,POST_PERTUM_HEAMORRHAGE_FEMALE
				  ,(POST_PERTUM_HEAMORRHAGE_MALE+POST_PERTUM_HEAMORRHAGE_FEMALE) AS POST_PERTUM_HEAMORRHAGE_TOTAL

				  ,OBSTRUCTED_LABOUR_MALE
				  ,OBSTRUCTED_LABOUR_FEMALE
				  ,(OBSTRUCTED_LABOUR_MALE+OBSTRUCTED_LABOUR_FEMALE) AS OBSTRUCTED_LABOUR_TOTAL

				  ,OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_MALE
				  ,OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_FEMALE
				  ,(OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_MALE+OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_FEMALE) AS OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_TOTAL

				  ,PUERPERAL_SEPSIS_MALE
				  ,PUERPERAL_SEPSIS_FEMALE
				  ,(PUERPERAL_SEPSIS_MALE+PUERPERAL_SEPSIS_FEMALE) AS PUERPERAL_SEPSIS_TOTAL

				  ,BIRTH_ASPHYXIA_MALE
				  ,BIRTH_ASPHYXIA_FEMALE
				  ,(BIRTH_ASPHYXIA_MALE+BIRTH_ASPHYXIA_FEMALE) AS BIRTH_ASPHYXIA_TOTAL

				  ,NEONATAL_JAUNDICE_MALE
				  ,NEONATAL_JAUNDICE_FEMALE
				  ,(NEONATAL_JAUNDICE_MALE+NEONATAL_JAUNDICE_FEMALE) AS NEONATAL_JAUNDICE_TOTAL

				  ,CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_MALE
				  ,CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_FEMALE
				  ,(CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_MALE+CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_FEMALE) AS CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_TOTAL

				  ,COUGH_MALE
				  ,COUGH_FEMALE
				  ,(COUGH_MALE+COUGH_FEMALE) AS COUGH_TOTAL

				  ,OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_MALE
				  ,OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_FEMALE
				  ,(OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_MALE+OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_FEMALE) AS OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_TOTAL

				  ,FEVER_OF_UNKNOWN_ORIGIN_MALE
				  ,FEVER_OF_UNKNOWN_ORIGIN_FEMALE
				  ,(FEVER_OF_UNKNOWN_ORIGIN_MALE+FEVER_OF_UNKNOWN_ORIGIN_FEMALE) AS FEVER_OF_UNKNOWN_ORIGIN_TOTAL

				  ,OTHER_GENERAL_SYMPTONS_AND_SIGNS_MALE
				  ,OTHER_GENERAL_SYMPTONS_AND_SIGNS_FEMALE
				  ,(OTHER_GENERAL_SYMPTONS_AND_SIGNS_MALE+OTHER_GENERAL_SYMPTONS_AND_SIGNS_FEMALE) AS OTHER_GENERAL_SYMPTONS_AND_SIGNS_TOTAL

				  ,HEAD_INJURY_MALE
				  ,HEAD_INJURY_FEMALE
				  ,(HEAD_INJURY_MALE+HEAD_INJURY_FEMALE) AS HEAD_INJURY_TOTAL

				  ,OTHER_INJURY_TO_THE_HEAD_REGION_MALE
				  ,OTHER_INJURY_TO_THE_HEAD_REGION_FEMALE
				  ,(OTHER_INJURY_TO_THE_HEAD_REGION_MALE+OTHER_INJURY_TO_THE_HEAD_REGION_FEMALE) AS OTHER_INJURY_TO_THE_HEAD_REGION_TOTAL

				  ,OTHER_INJURY_POISON_FRACTURE_MALE
				  ,OTHER_INJURY_POISON_FRACTURE_FEMALE
				  ,(OTHER_INJURY_POISON_FRACTURE_MALE+OTHER_INJURY_POISON_FRACTURE_FEMALE) AS OTHER_INJURY_POISON_FRACTURE_TOTAL

				  ,FOREIGN_BODY_MALE
				  ,FOREIGN_BODY_FEMALE
				  ,(FOREIGN_BODY_MALE+FOREIGN_BODY_FEMALE) AS FOREIGN_BODY_TOTAL

				  ,BURNS_AND_CORROSIONS_MALE
				  ,BURNS_AND_CORROSIONS_FEMALE
				  ,(BURNS_AND_CORROSIONS_MALE+BURNS_AND_CORROSIONS_FEMALE) AS BURNS_AND_CORROSIONS_TOTAL

				  ,POISONS_MALE
				  ,POISONS_FEMALE
				  ,(POISONS_MALE+POISONS_FEMALE) AS POISONS_TOTAL

				  ,TRANSPORTATION_ACCIDENTS_MALE
				  ,TRANSPORTATION_ACCIDENTS_FEMALE
				  ,(TRANSPORTATION_ACCIDENTS_MALE+TRANSPORTATION_ACCIDENTS_FEMALE) AS TRANSPORTATION_ACCIDENTS_TOTAL

				  ,FALLS_MALE
				  ,FALLS_FEMALE
				  ,(FALLS_MALE+FALLS_FEMALE) AS FALLS_TOTAL

				  ,WEAPONS_MALE
				  ,WEAPONS_FEMALE
				  ,(WEAPONS_MALE+WEAPONS_FEMALE) AS WEAPONS_TOTAL

				  ,GUNS_MALE
				  ,GUNS_FEMALE
				  ,(GUNS_MALE+GUNS_FEMALE) AS GUNS_TOTAL

				  ,INTENTIONAL_SELF_HARM_MALE
				  ,INTENTIONAL_SELF_HARM_FEMALE
				  ,(INTENTIONAL_SELF_HARM_MALE+INTENTIONAL_SELF_HARM_FEMALE) AS INTENTIONAL_SELF_HARM_TOTAL

				  ,MALE_TOTAL
				  ,FEMALE_TOTAL
				  ,(MALE_TOTAL+FEMALE_TOTAL) AS GRAND_TOTAL
		FROM
		(
		SELECT  CM.CName AS HospitalName		
				,SUM(CASE WHEN SM.ServiceName = 'A00 - Cholera' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CHOLERA_MALE
				,SUM(CASE WHEN SM.ServiceName = 'A00 - Cholera' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CHOLERA_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'A00 - Cholera' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CHOLERA_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'A01 - Typhoid and parathyphoid fevers' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TYPHOID_FEVER_MALE
				,SUM(CASE WHEN SM.ServiceName = 'A01 - Typhoid and parathyphoid fevers' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TYPHOID_FEVER_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'A01 - Typhoid and parathyphoid fevers' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TYPHOID_FEVER_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DIARRHOEA_MALE
				,SUM(CASE WHEN SM.ServiceName = 'A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DIARRHOEA_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DIARRHOEA_TOTAL

				,SUM(CASE WHEN SM.ParentId = 96 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TUBERCULOSIS_MALE
				,SUM(CASE WHEN SM.ParentId = 96 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TUBERCULOSIS_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 96 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TUBERCULOSIS_TOTAL

				,SUM(CASE WHEN SM.ParentId = 102 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ZOONATIC_INFECTION_MALE
				,SUM(CASE WHEN SM.ParentId = 102 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ZOONATIC_INFECTION_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 102 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ZOONATIC_INFECTION_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'A35 - Other Tetanus' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TETANUS_MALE
				,SUM(CASE WHEN SM.ServiceName = 'A35 - Other Tetanus' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TETANUS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'A35 - Other Tetanus' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TETANUS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'A40 - Streptococcal Septicaemia' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS STREPTOCOCCAL_SEPTICAEMIA_MALE
				,SUM(CASE WHEN SM.ServiceName = 'A40 - Streptococcal Septicaemia' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS STREPTOCOCCAL_SEPTICAEMIA_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'A40 - Streptococcal Septicaemia' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS STREPTOCOCCAL_SEPTICAEMIA_TOTAL

				,SUM(CASE WHEN SM.ParentId = 112 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_BACTERIA_DXS_MALE
				,SUM(CASE WHEN SM.ParentId = 112 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_BACTERIA_DXS_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 112 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_BACTERIA_DXS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'A64 - Unspecified sexually transmitted disease' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SEXUALLY_TRANSMITTED_DISEASES_MALE
				,SUM(CASE WHEN SM.ServiceName = 'A64 - Unspecified sexually transmitted disease' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SEXUALLY_TRANSMITTED_DISEASES_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'A64 - Unspecified sexually transmitted disease' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SEXUALLY_TRANSMITTED_DISEASES_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'A80 - Acute poliomyelitis' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POLIOMYELITES_MALE
				,SUM(CASE WHEN SM.ServiceName = 'A80 - Acute poliomyelitis' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POLIOMYELITES_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'A80 - Acute poliomyelitis' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POLIOMYELITES_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'A82 - Rabies' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS RABIES_MALE
				,SUM(CASE WHEN SM.ServiceName = 'A82 - Rabies' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS RABIES_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'A82 - Rabies' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS RABIES_TOTAL

				,SUM(CASE WHEN SM.ParentId = 158 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_MALE
				,SUM(CASE WHEN SM.ParentId = 158 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 158 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_VIRAL_INFECTION_OF_CENTRAL_NERVOUS_SYSTEM_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'A95 - Yellow fever' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS YELLOW_FEVER_MALE
				,SUM(CASE WHEN SM.ServiceName = 'A95 - Yellow fever' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS YELLOW_FEVER_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'A95 - Yellow fever' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS YELLOW_FEVER_TOTAL
		  
				,SUM(CASE WHEN SM.ServiceName = 'B01 - Varicella (chicken pox)' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CHICKEN_POX_MALE
				,SUM(CASE WHEN SM.ServiceName = 'B01 - Varicella (chicken pox)' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CHICKEN_POX_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'B01 - Varicella (chicken pox)' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CHICKEN_POX_TOTAL
		  
				,SUM(CASE WHEN SM.ServiceName = 'B05 - Measles' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MEASLES_MALE
				,SUM(CASE WHEN SM.ServiceName = 'B05 - Measles' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MEASLES_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'B05 - Measles' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MEASLES_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'B02 - Zoster (herpes zoster)' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HERPES_ZOSTER_MALE
				,SUM(CASE WHEN SM.ServiceName = 'B02 - Zoster (herpes zoster)' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HERPES_ZOSTER_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'B02 - Zoster (herpes zoster)' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HERPES_ZOSTER_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'B07 - Viral warts' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS VIRAL_WARTS_MALE
				,SUM(CASE WHEN SM.ServiceName = 'B07 - Viral warts' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS VIRAL_WARTS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'B07 - Viral warts' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS VIRAL_WARTS_TOTAL

				,SUM(CASE WHEN SM.ParentId = 184 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS VIRAL_HEPATITIS_MALE
				,SUM(CASE WHEN SM.ParentId = 184 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS VIRAL_HEPATITIS_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 184 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS VIRAL_HEPATITIS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'B24 - Unspecified HIV diseases/Immuno suppression' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HIV_DISEASES_MALE
				,SUM(CASE WHEN SM.ServiceName = 'B24 - Unspecified HIV diseases/Immuno suppression' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HIV_DISEASES_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'B24 - Unspecified HIV diseases/Immuno suppression' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HIV_DISEASES_TOTAL

				,SUM(CASE WHEN SM.ParentId = 194 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_VIRAL_DXS_MALE
				,SUM(CASE WHEN SM.ParentId = 194 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_VIRAL_DXS_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 194 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_VIRAL_DXS_TOTAL

				,SUM(CASE WHEN SM.ParentId = 200 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MYCOSES_MALE
				,SUM(CASE WHEN SM.ParentId = 200 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MYCOSES_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 200 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MYCOSES_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'B54 - Unspecified Malaria' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALARIA_MALE
				,SUM(CASE WHEN SM.ServiceName = 'B54 - Unspecified Malaria' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALARIA_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'B54 - Unspecified Malaria' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALARIA_TOTAL

				,SUM(CASE WHEN SM.ParentId = 221 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HELMINTHIASIS_MALE
				,SUM(CASE WHEN SM.ParentId = 221 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HELMINTHIASIS_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 221 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HELMINTHIASIS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HOOKWORM_DISEASES_MALE
				,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HOOKWORM_DISEASES_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HOOKWORM_DISEASES_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'B77 - Ascariasis' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ASCARIASIS_MALE
				,SUM(CASE WHEN SM.ServiceName = 'B77 - Ascariasis' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ASCARIASIS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'B77 - Ascariasis' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ASCARIASIS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'B83 - Other Helminthiases' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_HELMINTHIASIS_MALE
				,SUM(CASE WHEN SM.ServiceName = 'B83 - Other Helminthiases' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_HELMINTHIASIS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'B83 - Other Helminthiases' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_HELMINTHIASIS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'C17 - Malignant Neoplasm of Small Intestines' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_MALE
				,SUM(CASE WHEN SM.ServiceName = 'C17 - Malignant Neoplasm of Small Intestines' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'C17 - Malignant Neoplasm of Small Intestines' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LARGE_INTESTINE_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'C44 -  Other Malignant Neoplasm of Skin' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_SKIN_MALE
				,SUM(CASE WHEN SM.ServiceName = 'C44 -  Other Malignant Neoplasm of Skin' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_SKIN_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'C44 -  Other Malignant Neoplasm of Skin' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_SKIN_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'C34 - Malignant Neoplasm of Bronchus & Lung' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LUNG_MALE
				,SUM(CASE WHEN SM.ServiceName = 'C34 - Malignant Neoplasm of Bronchus & Lung' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LUNG_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'C34 - Malignant Neoplasm of Bronchus & Lung' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_LUNG_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_BONE_MALE
				,SUM(CASE WHEN SM.ServiceName = 'C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_BONE_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALIGNANT_NEOPLASM_OF_BONE_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MALIGNANT_NEOPLASM_DISEASES_MALE
				,SUM(CASE WHEN SM.ServiceName = 'C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MALIGNANT_NEOPLASM_DISEASES_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MALIGNANT_NEOPLASM_DISEASES_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'K74 - Fibrosis and cirrhosis of liver' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FIBROID_MALE
				,SUM(CASE WHEN SM.ServiceName = 'K74 - Fibrosis and cirrhosis of liver' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FIBROID_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'K74 - Fibrosis and cirrhosis of liver' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FIBROID_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'C61 - Malignant Neoplasms of Prostate' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BENIGH_PROSTATE_HYPAPLASIA_MALE
				,SUM(CASE WHEN SM.ServiceName = 'C61 - Malignant Neoplasms of Prostate' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BENIGH_PROSTATE_HYPAPLASIA_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'C61 - Malignant Neoplasms of Prostate' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BENIGH_PROSTATE_HYPAPLASIA_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'C50 - MALIGNANT NEOPLASM OF BREAST' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INSITION_OF_BREAST_MALE
				,SUM(CASE WHEN SM.ServiceName = 'C50 - MALIGNANT NEOPLASM OF BREAST' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INSITION_OF_BREAST_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'C50 - MALIGNANT NEOPLASM OF BREAST' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INSITION_OF_BREAST_TOTAL

				,SUM(CASE WHEN SM.ParentId = 323 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_BENIGH_NEOPLASM_MALE
				,SUM(CASE WHEN SM.ParentId = 323 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_BENIGH_NEOPLASM_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 323 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_BENIGH_NEOPLASM_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'D64 - Other Anaemias' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SEVERE_ANAEMIA_MALE
				,SUM(CASE WHEN SM.ServiceName = 'D64 - Other Anaemias' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SEVERE_ANAEMIA_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'D64 - Other Anaemias' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SEVERE_ANAEMIA_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'D53 - Other Nutritional Anaemias' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_NUTRITIONAL_ANAEMIA_MALE
				,SUM(CASE WHEN SM.ServiceName = 'D53 - Other Nutritional Anaemias' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_NUTRITIONAL_ANAEMIA_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'D53 - Other Nutritional Anaemias' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_NUTRITIONAL_ANAEMIA_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'D57 - Sickle-cell disorders' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SICKLE_CELL_MALE
				,SUM(CASE WHEN SM.ServiceName = 'D57 - Sickle-cell disorders' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SICKLE_CELL_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'D57 - Sickle-cell disorders' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SICKLE_CELL_TOTAL

				,SUM(CASE WHEN SM.ParentId = 365 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISORDER_OF_THYROID_GLAND_MALE
				,SUM(CASE WHEN SM.ParentId = 365 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISORDER_OF_THYROID_GLAND_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 365 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISORDER_OF_THYROID_GLAND_TOTAL

				,SUM(CASE WHEN SM.ParentId = 372 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DIABETES_MELLITUS_MALE
				,SUM(CASE WHEN SM.ParentId = 372 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DIABETES_MELLITUS_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 372 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DIABETES_MELLITUS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'E16.2 - Hypoglyceamia' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HYPOGLYCAEMIA_MALE
				,SUM(CASE WHEN SM.ServiceName = 'E16.2 - Hypoglyceamia' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HYPOGLYCAEMIA_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'E16.2 - Hypoglyceamia' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HYPOGLYCAEMIA_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'E40 - Kwashiorkor' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS KWASHIORKOR_MALE
				,SUM(CASE WHEN SM.ServiceName = 'E40 - Kwashiorkor' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS KWASHIORKOR_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'E40 - Kwashiorkor' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS KWASHIORKOR_TOTAL

				,SUM(CASE WHEN SM.ParentId = 382 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MALNUTRITION_MALE
				,SUM(CASE WHEN SM.ParentId = 382 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MALNUTRITION_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 382 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MALNUTRITION_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'E66 - Obesity' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OBESITY_MALE
				,SUM(CASE WHEN SM.ServiceName = 'E66 - Obesity' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OBESITY_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'E66 - Obesity' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OBESITY_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'F32 - Depressive episode' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DEPRESSION_MALE
				,SUM(CASE WHEN SM.ServiceName = 'F32 - Depressive episode' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DEPRESSION_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'F32 - Depressive episode' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DEPRESSION_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'F78 - Other mental retardation' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MENTAL_DISORDER_MALE
				,SUM(CASE WHEN SM.ServiceName = 'F78 - Other mental retardation' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MENTAL_DISORDER_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'F78 - Other mental retardation' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_MENTAL_DISORDER_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'G01 - Meningitis due to other unspecified causes' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MENINGITIS_MALE
				,SUM(CASE WHEN SM.ServiceName = 'G01 - Meningitis due to other unspecified causes' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MENINGITIS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'G01 - Meningitis due to other unspecified causes' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MENINGITIS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'G40 - Epilepsy' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS EPILEPSY_MALE
				,SUM(CASE WHEN SM.ServiceName = 'G40 - Epilepsy' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS EPILEPSY_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'G40 - Epilepsy' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS EPILEPSY_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'G43 - Migraine' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MIGRAINE_MALE
				,SUM(CASE WHEN SM.ServiceName = 'G43 - Migraine' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MIGRAINE_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'G43 - Migraine' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MIGRAINE_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DISEASES_OF_CNS_MALE
				,SUM(CASE WHEN SM.ServiceName = 'C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DISEASES_OF_CNS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DISEASES_OF_CNS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'G80 - Cerebral palsy' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CEREBRAL_PALSY_MALE
				,SUM(CASE WHEN SM.ServiceName = 'G80 - Cerebral palsy' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CEREBRAL_PALSY_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'G80 - Cerebral palsy' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CEREBRAL_PALSY_TOTAL

				,SUM(CASE WHEN SM.ParentId = 463 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_PARALYTIC_SYNDRONES_MALE
				,SUM(CASE WHEN SM.ParentId = 463 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_PARALYTIC_SYNDRONES_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 463 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_PARALYTIC_SYNDRONES_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'B30 - Viral Conjuctivitis' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONJUCTIVITIS_MALE
				,SUM(CASE WHEN SM.ServiceName = 'B30 - Viral Conjuctivitis' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONJUCTIVITIS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'B30 - Viral Conjuctivitis' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONJUCTIVITIS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'H25 - Senile Cataract' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CATARACT_MALE
				,SUM(CASE WHEN SM.ServiceName = 'H25 - Senile Cataract' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CATARACT_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'H25 - Senile Cataract' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CATARACT_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'H40 - Glaucoma' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GLAUCOMA_MALE
				,SUM(CASE WHEN SM.ServiceName = 'H40 - Glaucoma' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GLAUCOMA_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'H40 - Glaucoma' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GLAUCOMA_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'O70 - Perineal laceration during delivery' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONEAL_LACERATION_MALE
				,SUM(CASE WHEN SM.ServiceName = 'O70 - Perineal laceration during delivery' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONEAL_LACERATION_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'O70 - Perineal laceration during delivery' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONEAL_LACERATION_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'S05 - Injury of eye and orbit' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_EYES_DISORDERS_MALE
				,SUM(CASE WHEN SM.ServiceName = 'S05 - Injury of eye and orbit' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_EYES_DISORDERS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'S05 - Injury of eye and orbit' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_EYES_DISORDERS_TOTAL

				,SUM(CASE WHEN SM.ParentId = 488 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_EAR_AND_MASTOID_PROCESS_MALE
				,SUM(CASE WHEN SM.ParentId = 488 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_EAR_AND_MASTOID_PROCESS_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 488 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_EAR_AND_MASTOID_PROCESS_TOTAL

				,SUM(CASE WHEN SM.ParentId = 505 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS RHEUNMATIC_FEVER_MALE
				,SUM(CASE WHEN SM.ParentId = 505 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS RHEUNMATIC_FEVER_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 505 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS RHEUNMATIC_FEVER_TOTAL

				,SUM(CASE WHEN SM.ParentId = 511 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HYPERTENSIVE_DISEASES_MALE
				,SUM(CASE WHEN SM.ParentId = 511 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HYPERTENSIVE_DISEASES_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 511 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HYPERTENSIVE_DISEASES_TOTAL

				,SUM(CASE WHEN SM.ParentId = 533 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CEREBRO_VASCULAR_ACCIDENT_MALE
				,SUM(CASE WHEN SM.ParentId = 533 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CEREBRO_VASCULAR_ACCIDENT_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 533 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CEREBRO_VASCULAR_ACCIDENT_TOTAL

				,SUM(CASE WHEN SM.ServiceName IN ('I46 - Cardiac arrest','I50 - Heart failure') AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CARDIAC_ARREST_HEART_FAILURE_MALE
				,SUM(CASE WHEN SM.ServiceName IN ('I46 - Cardiac arrest','I50 - Heart failure') AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CARDIAC_ARREST_HEART_FAILURE_FEMALE
				--,SUM(CASE WHEN SM.ServiceName IN ('I46 - Cardiac arrest','I50 - Heart failure') AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CARDIAC_ARREST_HEART_FAILURE_TOTAL

				,SUM(CASE WHEN SM.ParentId = 526 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_FORM_OF_HEART_DISEASES_MALE
				,SUM(CASE WHEN SM.ParentId = 526 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_FORM_OF_HEART_DISEASES_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 526 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_FORM_OF_HEART_DISEASES_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BRONCHO_PNEUMONIA_MALE
				,SUM(CASE WHEN SM.ServiceName = 'J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BRONCHO_PNEUMONIA_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BRONCHO_PNEUMONIA_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'J20 - Acute Bronchitis' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BRONCHITIS_MALE
				,SUM(CASE WHEN SM.ServiceName = 'J20 - Acute Bronchitis' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BRONCHITIS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'J20 - Acute Bronchitis' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BRONCHITIS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'J45 - Asthma' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ASTHMA_MALE
				,SUM(CASE WHEN SM.ServiceName = 'J45 - Asthma' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ASTHMA_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'J45 - Asthma' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ASTHMA_TOTAL

				,SUM(CASE WHEN SM.ParentId = 560 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_RESPIRATORY_DISEASES_MALE
				,SUM(CASE WHEN SM.ParentId = 560 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_RESPIRATORY_DISEASES_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 560 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_RESPIRATORY_DISEASES_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'K02 - Dental Caries' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DENTAL_DISEASES_MALE
				,SUM(CASE WHEN SM.ServiceName = 'K02 - Dental Caries' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DENTAL_DISEASES_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'K02 - Dental Caries' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DENTAL_DISEASES_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'K25 - Gastric Ulcer' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ULCER_MALE
				,SUM(CASE WHEN SM.ServiceName = 'K25 - Gastric Ulcer' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ULCER_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'K25 - Gastric Ulcer' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ULCER_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'K35 - Acute Appendicitis' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS APPENDICITIS_MALE
				,SUM(CASE WHEN SM.ServiceName = 'K35 - Acute Appendicitis' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS APPENDICITIS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'K35 - Acute Appendicitis' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS APPENDICITIS_TOTAL

				,SUM(CASE WHEN SM.ParentId = 605 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HERNIA_MALE
				,SUM(CASE WHEN SM.ParentId = 605 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HERNIA_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 605 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HERNIA_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'K65 - Peritonitis' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PERITONITIS_INTESTINAL_OBSTRUCTION_MALE
				,SUM(CASE WHEN SM.ServiceName = 'K65 - Peritonitis' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PERITONITIS_INTESTINAL_OBSTRUCTION_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'K65 - Peritonitis' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PERITONITIS_INTESTINAL_OBSTRUCTION_TOTAL

				,SUM(CASE WHEN SM.ParentId = 622 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS LIVER_DISEASES_MALE
				,SUM(CASE WHEN SM.ParentId = 622 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS LIVER_DISEASES_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 622 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS LIVER_DISEASES_TOTAL

				,SUM(CASE WHEN SM.ParentId = 584 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DIGESTIVE_SYSTEM_DISEASES_MALE
				,SUM(CASE WHEN SM.ParentId = 584 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DIGESTIVE_SYSTEM_DISEASES_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 584 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DIGESTIVE_SYSTEM_DISEASES_TOTAL

				,SUM(CASE WHEN SM.ParentId = 636 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_MALE
				,SUM(CASE WHEN SM.ParentId = 636 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 636 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_SKIN_AND_SUBCUTANEOUS_TISSUE_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_MUSCULOSKELETAL_SYS_MALE
				,SUM(CASE WHEN SM.ServiceName = 'R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_MUSCULOSKELETAL_SYS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DISEASES_OF_MUSCULOSKELETAL_SYS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'N00 - Acute Nephritic syndrome' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ACUTE_NEPHRITIS_SYNDROME_MALE
				,SUM(CASE WHEN SM.ServiceName = 'N00 - Acute Nephritic syndrome' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ACUTE_NEPHRITIS_SYNDROME_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'N00 - Acute Nephritic syndrome' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ACUTE_NEPHRITIS_SYNDROME_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'N17 - Acute renal failure' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ACUTE_RENAL_FAILURE_MALE
				,SUM(CASE WHEN SM.ServiceName = 'N17 - Acute renal failure' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ACUTE_RENAL_FAILURE_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'N17 - Acute renal failure' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ACUTE_RENAL_FAILURE_TOTAL

				,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_GENTOURINARY_DISEASES_MALE
				,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_GENTOURINARY_DISEASES_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_GENTOURINARY_DISEASES_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'N46 - Male Infertility' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALE_INFERTILITY_MALE
				,SUM(CASE WHEN SM.ServiceName = 'N46 - Male Infertility' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALE_INFERTILITY_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'N46 - Male Infertility' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALE_INFERTILITY_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'Q55 - Other Congenital malformation of male genital organs' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_MALE
				,SUM(CASE WHEN SM.ServiceName = 'Q55 - Other Congenital malformation of male genital organs' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'Q55 - Other Congenital malformation of male genital organs' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_DISEASES_OF_MALE_GENITAL_ORGAN_TOTAL

				,SUM(CASE WHEN SM.ParentId = 711 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_MALE
				,SUM(CASE WHEN SM.ParentId = 711 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 711 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INFLAMMENTARY_DISEASES_OF_FEMALE_GENITAL_ORGAN_TOTAL

				,SUM(CASE WHEN SM.ParentId = 718 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_MALE
				,SUM(CASE WHEN SM.ParentId = 718 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 718 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NON_INFLAMMENTARY_DISORDER_OF_FEMALE_GENITALTRACT_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'N97 - Female Infertility' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FEMALE_INFERTILITY_MALE
				,SUM(CASE WHEN SM.ServiceName = 'N97 - Female Infertility' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FEMALE_INFERTILITY_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'N97 - Female Infertility' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FEMALE_INFERTILITY_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'N95 - Menopausal and other perimenopausal disorders' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MENOPOUSAL_DISORDER_MALE
				,SUM(CASE WHEN SM.ServiceName = 'N95 - Menopausal and other perimenopausal disorders' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MENOPOUSAL_DISORDER_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'N95 - Menopausal and other perimenopausal disorders' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MENOPOUSAL_DISORDER_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'Q52 - Other Congenital malformation of female genitalia' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_FEMALE_GENITAL_DISEASES_MALE
				,SUM(CASE WHEN SM.ServiceName = 'Q52 - Other Congenital malformation of female genitalia' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_FEMALE_GENITAL_DISEASES_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'Q52 - Other Congenital malformation of female genitalia' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_FEMALE_GENITAL_DISEASES_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'O00 - Ectopic pregnancy' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ECTOPIC_PREGNANCY_MALE
				,SUM(CASE WHEN SM.ServiceName = 'O00 - Ectopic pregnancy' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ECTOPIC_PREGNANCY_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'O00 - Ectopic pregnancy' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ECTOPIC_PREGNANCY_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'O03 - Spontanous abortion' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SPONTENEOUS_ABORTION_MALE
				,SUM(CASE WHEN SM.ServiceName = 'O03 - Spontanous abortion' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SPONTENEOUS_ABORTION_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'O03 - Spontanous abortion' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SPONTENEOUS_ABORTION_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'O15 - Eclampsia' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ECLAMPSIA_MALE
				,SUM(CASE WHEN SM.ServiceName = 'O15 - Eclampsia' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ECLAMPSIA_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'O15 - Eclampsia' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ECLAMPSIA_TOTAL

				,SUM(CASE WHEN SM.ParentId = 753 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_PREGNANCY_RELATED_DISEASES_MALE
				,SUM(CASE WHEN SM.ParentId = 753 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_PREGNANCY_RELATED_DISEASES_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 753 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_PREGNANCY_RELATED_DISEASES_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'O60 - Preterm Labour' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PRETERIM_DELIVERY_MALE
				,SUM(CASE WHEN SM.ServiceName = 'O60 - Preterm Labour' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PRETERIM_DELIVERY_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'O60 - Preterm Labour' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PRETERIM_DELIVERY_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POST_PERTUM_HEAMORRHAGE_MALE
				,SUM(CASE WHEN SM.ServiceName = 'Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POST_PERTUM_HEAMORRHAGE_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POST_PERTUM_HEAMORRHAGE_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'O64 - Obstucted labour due to malposition & malpresentation of fetus' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OBSTRUCTED_LABOUR_MALE
				,SUM(CASE WHEN SM.ServiceName = 'O64 - Obstucted labour due to malposition & malpresentation of fetus' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OBSTRUCTED_LABOUR_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'O64 - Obstucted labour due to malposition & malpresentation of fetus' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OBSTRUCTED_LABOUR_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'O75 - Other complications of labour and delivery NEC' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_MALE
				,SUM(CASE WHEN SM.ServiceName = 'O75 - Other complications of labour and delivery NEC' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'O75 - Other complications of labour and delivery NEC' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_COMPLICATIONS_OF_LABOUR_AND_DELIVERY_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'A41 - Sepsis' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PUERPERAL_SEPSIS_MALE
				,SUM(CASE WHEN SM.ServiceName = 'A41 - Sepsis' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PUERPERAL_SEPSIS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'A41 - Sepsis' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PUERPERAL_SEPSIS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'P21 - Birth Asphyxia' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BIRTH_ASPHYXIA_MALE
				,SUM(CASE WHEN SM.ServiceName = 'P21 - Birth Asphyxia' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BIRTH_ASPHYXIA_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'P21 - Birth Asphyxia' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BIRTH_ASPHYXIA_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'P59 - Neonatal Jaundice from other and unspecified causes' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NEONATAL_JAUNDICE_MALE
				,SUM(CASE WHEN SM.ServiceName = 'P59 - Neonatal Jaundice from other and unspecified causes' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NEONATAL_JAUNDICE_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'P59 - Neonatal Jaundice from other and unspecified causes' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NEONATAL_JAUNDICE_TOTAL

				,SUM(CASE WHEN SM.ParentId = 848 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_MALE
				,SUM(CASE WHEN SM.ParentId = 848 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 848 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CONGENITAL_MALFORMATION_AND_CHROMOSONAL_ABNORMALITIES_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'R05 - Cough' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS COUGH_MALE
				,SUM(CASE WHEN SM.ServiceName = 'R05 - Cough' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS COUGH_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'R05 - Cough' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS COUGH_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'R82 - Other abnormal findings of urine' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_MALE
				,SUM(CASE WHEN SM.ServiceName = 'R82 - Other abnormal findings of urine' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'R82 - Other abnormal findings of urine' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_SYMPTONS_SIGNS_AND_ABNORMAL_LAB_FINDINGS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'R50 - Fever of other and unknown origin' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FEVER_OF_UNKNOWN_ORIGIN_MALE
				,SUM(CASE WHEN SM.ServiceName = 'R50 - Fever of other and unknown origin' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FEVER_OF_UNKNOWN_ORIGIN_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'R50 - Fever of other and unknown origin' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FEVER_OF_UNKNOWN_ORIGIN_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'R68 - Other general symptoms and signs' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_GENERAL_SYMPTONS_AND_SIGNS_MALE
				,SUM(CASE WHEN SM.ServiceName = 'R68 - Other general symptoms and signs' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_GENERAL_SYMPTONS_AND_SIGNS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'R68 - Other general symptoms and signs' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_GENERAL_SYMPTONS_AND_SIGNS_TOTAL

				,SUM(CASE WHEN SM.ParentId = 975 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HEAD_INJURY_MALE
				,SUM(CASE WHEN SM.ParentId = 975 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HEAD_INJURY_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 975 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HEAD_INJURY_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'S09 - Other and unspecified injuries of head' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_INJURY_TO_THE_HEAD_REGION_MALE
				,SUM(CASE WHEN SM.ServiceName = 'S09 - Other and unspecified injuries of head' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_INJURY_TO_THE_HEAD_REGION_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'S09 - Other and unspecified injuries of head' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_INJURY_TO_THE_HEAD_REGION_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'T02 - Fractures involving multiple body regions' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_INJURY_POISON_FRACTURE_MALE
				,SUM(CASE WHEN SM.ServiceName = 'T02 - Fractures involving multiple body regions' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_INJURY_POISON_FRACTURE_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'T02 - Fractures involving multiple body regions' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHER_INJURY_POISON_FRACTURE_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'W44 - Foreign body entering into or through eye or natural orifice' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FOREIGN_BODY_MALE
				,SUM(CASE WHEN SM.ServiceName = 'W44 - Foreign body entering into or through eye or natural orifice' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FOREIGN_BODY_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'W44 - Foreign body entering into or through eye or natural orifice' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FOREIGN_BODY_TOTAL

				,SUM(CASE WHEN SM.ParentId = 1109 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BURNS_AND_CORROSIONS_MALE
				,SUM(CASE WHEN SM.ParentId = 1109 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BURNS_AND_CORROSIONS_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 1109 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BURNS_AND_CORROSIONS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = 'T36 - Poisoning by systematic antibiotics' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POISONS_MALE
				,SUM(CASE WHEN SM.ServiceName = 'T36 - Poisoning by systematic antibiotics' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POISONS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = 'T36 - Poisoning by systematic antibiotics' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS POISONS_TOTAL

				,SUM(CASE WHEN SM.ParentId = 1278 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TRANSPORTATION_ACCIDENTS_MALE
				,SUM(CASE WHEN SM.ParentId = 1278 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TRANSPORTATION_ACCIDENTS_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 1278 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TRANSPORTATION_ACCIDENTS_TOTAL

				,SUM(CASE WHEN SM.ParentId = 1303 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FALLS_MALE
				,SUM(CASE WHEN SM.ParentId = 1303 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FALLS_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 1303 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FALLS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS WEAPONS_MALE
				,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS WEAPONS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS WEAPONS_TOTAL

				,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GUNS_MALE
				,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GUNS_FEMALE
				--,SUM(CASE WHEN SM.ServiceName = '' AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GUNS_TOTAL

				,SUM(CASE WHEN SM.ParentId = 1460 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INTENTIONAL_SELF_HARM_MALE
				,SUM(CASE WHEN SM.ParentId = 1460 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INTENTIONAL_SELF_HARM_FEMALE
				--,SUM(CASE WHEN SM.ParentId = 1460 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS INTENTIONAL_SELF_HARM_TOTAL

				,SUM(CASE WHEN CD.Gender = 1 AND SM.ServiceName IN ('A00 - Cholera','A01 - Typhoid and parathyphoid fevers','A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin','A35 - Other Tetanus','A40 - Streptococcal Septicaemia','A64 - Unspecified sexually transmitted disease','A80 - Acute poliomyelitis','A82 - Rabies','A95 - Yellow fever','B01 - Varicella (chicken pox)','B05 - Measles','B02 - Zoster (herpes zoster)','B07 - Viral warts','B24 - Unspecified HIV diseases/Immuno suppression','B54 - Unspecified Malaria','B77 - Ascariasis','B83 - Other Helminthiases','C17 - Malignant Neoplasm of Small Intestines','C44 -  Other Malignant Neoplasm of Skin','C34 - Malignant Neoplasm of Bronchus & Lung','C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs','C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues','K74 - Fibrosis and cirrhosis of liver','C61 - Malignant Neoplasms of Prostate','C50 - MALIGNANT NEOPLASM OF BREAST','D64 - Other Anaemias','D53 - Other Nutritional Anaemias','D57 - Sickle-cell disorders','E16.2 - Hypoglyceamia','E40 - Kwashiorkor','E66 - Obesity','F32 - Depressive episode','F78 - Other mental retardation','G01 - Meningitis due to other unspecified causes','G40 - Epilepsy','G43 - Migraine','C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS','G80 - Cerebral palsy','B30 - Viral Conjuctivitis','H25 - Senile Cataract','H40 - Glaucoma','O70 - Perineal laceration during delivery','S05 - Injury of eye and orbit','I46 - Cardiac arrest','I50 - Heart failure','J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]','J20 - Acute Bronchitis','J45 - Asthma','K02 - Dental Caries','K25 - Gastric Ulcer','K35 - Acute Appendicitis','K65 - Peritonitis','R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ','N00 - Acute Nephritic syndrome','N17 - Acute renal failure','N46 - Male Infertility','Q55 - Other Congenital malformation of male genital organs','N97 - Female Infertility','N95 - Menopausal and other perimenopausal disorders','Q52 - Other Congenital malformation of female genitalia','O00 - Ectopic pregnancy','O03 - Spontanous abortion','O15 - Eclampsia','O60 - Preterm Labour','Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care','O64 - Obstucted labour due to malposition & malpresentation of fetus','O75 - Other complications of labour and delivery NEC','A41 - Sepsis','P21 - Birth Asphyxia','P59 - Neonatal Jaundice from other and unspecified causes','R05 - Cough','R82 - Other abnormal findings of urine','R50 - Fever of other and unknown origin','R68 - Other general symptoms and signs','S09 - Other and unspecified injuries of head','T02 - Fractures involving multiple body regions','W44 - Foreign body entering into or through eye or natural orifice','T36 - Poisoning by systematic antibiotics')
						THEN ISNULL(CD.DayVal,0) ELSE 0 END) +
				SUM(CASE WHEN CD.Gender = 1 AND SM.ParentId IN (96,102,112,158,184,194,200,221,323,365,372,382,463,488,505,511,533,526,560,605,622,584,636,711,718,753,848,975,1109,1278,1303,1460)
						THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MALE_TOTAL
				,SUM(CASE WHEN CD.Gender = 2 AND SM.ServiceName IN ('A00 - Cholera','A01 - Typhoid and parathyphoid fevers','A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin','A35 - Other Tetanus','A40 - Streptococcal Septicaemia','A64 - Unspecified sexually transmitted disease','A80 - Acute poliomyelitis','A82 - Rabies','A95 - Yellow fever','B01 - Varicella (chicken pox)','B05 - Measles','B02 - Zoster (herpes zoster)','B07 - Viral warts','B24 - Unspecified HIV diseases/Immuno suppression','B54 - Unspecified Malaria','B77 - Ascariasis','B83 - Other Helminthiases','C17 - Malignant Neoplasm of Small Intestines','C44 -  Other Malignant Neoplasm of Skin','C34 - Malignant Neoplasm of Bronchus & Lung','C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs','C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues','K74 - Fibrosis and cirrhosis of liver','C61 - Malignant Neoplasms of Prostate','C50 - MALIGNANT NEOPLASM OF BREAST','D64 - Other Anaemias','D53 - Other Nutritional Anaemias','D57 - Sickle-cell disorders','E16.2 - Hypoglyceamia','E40 - Kwashiorkor','E66 - Obesity','F32 - Depressive episode','F78 - Other mental retardation','G01 - Meningitis due to other unspecified causes','G40 - Epilepsy','G43 - Migraine','C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS','G80 - Cerebral palsy','B30 - Viral Conjuctivitis','H25 - Senile Cataract','H40 - Glaucoma','O70 - Perineal laceration during delivery','S05 - Injury of eye and orbit','I46 - Cardiac arrest','I50 - Heart failure','J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]','J20 - Acute Bronchitis','J45 - Asthma','K02 - Dental Caries','K25 - Gastric Ulcer','K35 - Acute Appendicitis','K65 - Peritonitis','R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ','N00 - Acute Nephritic syndrome','N17 - Acute renal failure','N46 - Male Infertility','Q55 - Other Congenital malformation of male genital organs','N97 - Female Infertility','N95 - Menopausal and other perimenopausal disorders','Q52 - Other Congenital malformation of female genitalia','O00 - Ectopic pregnancy','O03 - Spontanous abortion','O15 - Eclampsia','O60 - Preterm Labour','Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care','O64 - Obstucted labour due to malposition & malpresentation of fetus','O75 - Other complications of labour and delivery NEC','A41 - Sepsis','P21 - Birth Asphyxia','P59 - Neonatal Jaundice from other and unspecified causes','R05 - Cough','R82 - Other abnormal findings of urine','R50 - Fever of other and unknown origin','R68 - Other general symptoms and signs','S09 - Other and unspecified injuries of head','T02 - Fractures involving multiple body regions','W44 - Foreign body entering into or through eye or natural orifice','T36 - Poisoning by systematic antibiotics')
						THEN ISNULL(CD.DayVal,0) ELSE 0 END) +
				SUM(CASE WHEN CD.Gender = 2 AND SM.ParentId IN (96,102,112,158,184,194,200,221,323,365,372,382,463,488,505,511,533,526,560,605,622,584,636,711,718,753,848,975,1109,1278,1303,1460)
						THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FEMALE_TOTAL
				--,SUM(CASE WHEN CD.Gender IN (1,2) AND SM.ServiceName IN ('A00 - Cholera','A01 - Typhoid and parathyphoid fevers','A09 - Diarrhoea & Gastro-Enteritis of presumed infectious origin','A35 - Other Tetanus','A40 - Streptococcal Septicaemia','A64 - Unspecified sexually transmitted disease','A80 - Acute poliomyelitis','A82 - Rabies','A95 - Yellow fever','B01 - Varicella (chicken pox)','B05 - Measles','B02 - Zoster (herpes zoster)','B07 - Viral warts','B24 - Unspecified HIV diseases/Immuno suppression','B54 - Unspecified Malaria','B77 - Ascariasis','B83 - Other Helminthiases','C17 - Malignant Neoplasm of Small Intestines','C44 -  Other Malignant Neoplasm of Skin','C34 - Malignant Neoplasm of Bronchus & Lung','C40 - Malignant Neoplasm of Bone & Articular cartilage of limbs','C96 - Other and unspecified Malignant Neoplasm of Lymphoid hermatopoietic and related tissues','K74 - Fibrosis and cirrhosis of liver','C61 - Malignant Neoplasms of Prostate','C50 - MALIGNANT NEOPLASM OF BREAST','D64 - Other Anaemias','D53 - Other Nutritional Anaemias','D57 - Sickle-cell disorders','E16.2 - Hypoglyceamia','E40 - Kwashiorkor','E66 - Obesity','F32 - Depressive episode','F78 - Other mental retardation','G01 - Meningitis due to other unspecified causes','G40 - Epilepsy','G43 - Migraine','C72 - Malignant Neoplasms of Spinal cord, cranial nerves & other parts of CNS','G80 - Cerebral palsy','B30 - Viral Conjuctivitis','H25 - Senile Cataract','H40 - Glaucoma','O70 - Perineal laceration during delivery','S05 - Injury of eye and orbit','I46 - Cardiac arrest','I50 - Heart failure','J18 - Pneumonia, Oganism unspecified [Lobar, Broncho…]','J20 - Acute Bronchitis','J45 - Asthma','K02 - Dental Caries','K25 - Gastric Ulcer','K35 - Acute Appendicitis','K65 - Peritonitis','R29 - Other symptoms and signs involng the nervours and musculoskeletal  systems ','N00 - Acute Nephritic syndrome','N17 - Acute renal failure','N46 - Male Infertility','Q55 - Other Congenital malformation of male genital organs','N97 - Female Infertility','N95 - Menopausal and other perimenopausal disorders','Q52 - Other Congenital malformation of female genitalia','O00 - Ectopic pregnancy','O03 - Spontanous abortion','O15 - Eclampsia','O60 - Preterm Labour','Y6o - Unintentional cut, punture, perforation or heamorrhage during surgical and medical care','O64 - Obstucted labour due to malposition & malpresentation of fetus','O75 - Other complications of labour and delivery NEC','A41 - Sepsis','P21 - Birth Asphyxia','P59 - Neonatal Jaundice from other and unspecified causes','R05 - Cough','R82 - Other abnormal findings of urine','R50 - Fever of other and unknown origin','R68 - Other general symptoms and signs','S09 - Other and unspecified injuries of head','T02 - Fractures involving multiple body regions','W44 - Foreign body entering into or through eye or natural orifice','T36 - Poisoning by systematic antibiotics')
				--		THEN ISNULL(CD.DayVal,0) ELSE 0 END) +
				--SUM(CASE WHEN CD.Gender IN (1,2) AND SM.ParentId IN (96,102,112,158,184,194,200,221,323,365,372,382,463,488,505,511,533,526,560,605,622,584,636,711,718,753,848,975,1109,1278,1303,1460)
				--		THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GRAND_TOTAL
		FROM dbo.CompanyMaster AS CM
		INNER JOIN dbo.fn_CaseDetailDateWise(@FromDate,@ToDate) AS CD
		ON CM.RecId = CD.CompanyId and cm.IsActive =1
		INNER JOIN dbo.ServicesMaster AS SM
		ON CD.ServiceId = SM.RecId and SM.IsActive =1
		WHERE (CD.CompanyId = @CompanyId OR @CompanyId = 0)
		AND (CD.CaseType = 1)
		AND (CD.HType >= @HType) 
		AND (CD.HType <= @HType1)
		GROUP BY CM.CName) AS A
	END
END
GO
/****** Object:  StoredProcedure [dbo].[RptGovMHSI]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <18 Jan 2020>
-- Htype 165 For GENERAL
-- Htype 166 For MCC
-- Htype -100 For COMPLEX
-- =============================================
-- Execute RptGovMHSI 0,0,2019,0,165
-- Execute RptGovMHSI 0,0,2019,0,166
-- Execute RptGovMHSI 0,0,2019,0,-100
CREATE PROCEDURE [dbo].[RptGovMHSI]
@CMonth Int,
@EMonth Int,
@CYear Int,
@CompanyId Bigint,
@HType Int
AS
BEGIN
	SELECT 0 AS SrNo
		  ,CM.CName AS HospitalName
		  ,SUM(CASE WHEN MHM.Description = 'BED' THEN ISNULL(MH.Result,0) ELSE 0 END) AS BED_COMPLEMENT_BEDS
		  ,SUM(CASE WHEN MHM.Description = 'OTHERS' THEN ISNULL(MH.Result,0) ELSE 0 END) AS BED_COMPLEMENT_OTHERS
		  ,SUM(CASE WHEN MHM.Description = 'TOTAL ADMISSIONS' THEN ISNULL(MH.Result,0) ELSE 0 END) AS ADMISSION
		  ,SUM(CASE WHEN MHM.Description = 'TOTAL DISCHARGES' THEN ISNULL(MH.Result,0) ELSE 0 END) AS DISCHARGES
		  ,SUM(CASE WHEN MHM.Description = 'B.B.A at Unit' THEN ISNULL(MH.Result,0) ELSE 0 END) AS NO_OF_BBA_AT_THE_UNIT
		  ,SUM(CASE WHEN MHM.Description = 'No of A.N.C Sessions Held' THEN ISNULL(MH.Result,0) ELSE 0 END) AS NO_OF_ANC_SESSIONS_HELD
		  ,SUM(CASE WHEN MHM.Description = 'No of Post Natal Clinic Attendances' THEN ISNULL(MH.Result,0) ELSE 0 END) AS NO_OF_PNC_ATTENDS
		  ,SUM(CASE WHEN MHM.Description = 'No of P.N.C Sessions Held' THEN ISNULL(MH.Result,0) ELSE 0 END) AS NO_OF_PNC_SESSIONS_HELD
		  ,SUM(CASE WHEN MHM.Description = 'Total No of CAS Attendances' THEN ISNULL(MH.Result,0) ELSE 0 END) AS TOTAL_NO_OF_CAS_ATTENDS
		  ,SUM(CASE WHEN MHM.Description = 'New Booking A.N.C' THEN ISNULL(MH.Result,0) ELSE 0 END) AS NEW_BOOKING_ANC_ATTENDS
		  ,SUM(CASE WHEN MHM.Description = 'Old Booking A.N.C & Sub Visit' THEN ISNULL(MH.Result,0) ELSE 0 END) AS OLD_BOOKING_ANC_ATTENDS
		  ,SUM(CASE WHEN MHM.Description = 'Total No of A.N.C Attendances' THEN ISNULL(MH.Result,0) ELSE 0 END) AS TOTAL_ANC_ATTENDS
		  ,SUM(CASE WHEN MHM.Description = 'Total Clinic Attendances ( ANC, PNC & Casualty)' THEN ISNULL(MH.Result,0) ELSE 0 END) AS TOTAL_ANC_PNC_CAS_ATTD
		  ,SUM(CASE WHEN MHM.Description = 'Family Planning Clinic Attendances' THEN ISNULL(MH.Result,0) ELSE 0 END) AS FAMILY_PLANNING_CLINIC_ATTENDEANT
		  ,SUM(CASE WHEN MHM.Description = 'Total No of Deliveries at the unit' THEN ISNULL(MH.Result,0) ELSE 0 END) AS TOTAL_NO_OF_DELIVERIES_ATTENDEANT
		  ,SUM(CASE WHEN MHM.Description = 'Number of Booked cases' THEN ISNULL(MH.Result,0) ELSE 0 END) AS NO_OF_BOOKED_CASES
		  ,SUM(CASE WHEN MHM.Description = 'Number of Unbooked cases' THEN ISNULL(MH.Result,0) ELSE 0 END) AS NO_OF_UNBOOKED_CASES
		  ,SUM(CASE WHEN MHM.Description = 'Numbers of Singles delivered' THEN ISNULL(MH.Result,0) ELSE 0 END) AS NO_OF_SINGLE_DELIVERED
		  ,SUM(CASE WHEN MHM.Description = 'Numbers of Twins delivered' THEN ISNULL(MH.Result,0) ELSE 0 END) AS NO_OF_TWINS_DELIVERED
		  ,SUM(CASE WHEN MHM.Description = 'Numbers of Triplets delivered' THEN ISNULL(MH.Result,0) ELSE 0 END) AS NO_OF_TRIPLET_DELIVERED
		  ,SUM(CASE WHEN MHM.Description IN ('Numbers of Singles delivered','Numbers of Twins delivered','Numbers of Triplets delivered') THEN ISNULL(MH.Result,0) ELSE 0 END) AS NO_OF_DELIVERED
		  ,SUM(CASE WHEN MHM.Description = 'Types of Deliveries             1 Normal Deliveries' THEN ISNULL(MH.Result,0) ELSE 0 END) AS NORMAL_DELIVERIES
		  ,SUM(CASE WHEN MHM.Description = '                                             2 Forceps Deliveries' THEN ISNULL(MH.Result,0) ELSE 0 END) AS FORCEP_DELIVERIES
		  ,SUM(CASE WHEN MHM.Description = '                                             3 Breech Deliveries' THEN ISNULL(MH.Result,0) ELSE 0 END) AS BREECH_DELIVERIES
		  ,SUM(CASE WHEN MHM.Description = '                                             4 Vaccum Deliveries' THEN ISNULL(MH.Result,0) ELSE 0 END) AS VACCUM_EXTRACTION
		  ,SUM(CASE WHEN MHM.Description = '                                             5 Caesarean Deliveries' THEN ISNULL(MH.Result,0) ELSE 0 END) AS CESASARIAN_DELIVERIES
		  ,SUM(CASE WHEN MHM.Description = 'Total Number of BIRTHS' THEN ISNULL(MH.Result,0) ELSE 0 END) AS TOTAL_NO_OF_BIRTHS
		  ,SUM(CASE WHEN MHM.Description = 'Total Number of Live Births (Male)' THEN ISNULL(MH.Result,0) ELSE 0 END) AS TOTAL_NO_OF_LIVE_BIRTHS_MALE
		  ,SUM(CASE WHEN MHM.Description = 'Total Number of Live Births (Female)' THEN ISNULL(MH.Result,0) ELSE 0 END) AS TOTAL_NO_OF_LIVE_BIRTHS_FEMALE
		  ,SUM(CASE WHEN MHM.Description = 'Total Number of Still Births (Male)' THEN ISNULL(MH.Result,0) ELSE 0 END) AS TOTAL_NO_OF_STILL_BIRTHS_MALE
		  ,SUM(CASE WHEN MHM.Description = 'Total Number of Still Births (Female)' THEN ISNULL(MH.Result,0) ELSE 0 END) AS TOTAL_NO_OF_STILL_BIRTHS_FEMALE
		  ,SUM(CASE WHEN MHM.Description = 'Neo-natal Deaths at the unit' THEN ISNULL(MH.Result,0) ELSE 0 END) AS NEO_NATAL_DEATHS_AT_THE_UNIT
		  ,SUM(CASE WHEN MHM.Description = 'Maternal Deaths at the unit (Booked cases)' THEN ISNULL(MH.Result,0) ELSE 0 END) AS NO_OF_BOOKED_MATERNAL_DEATHS
		  ,SUM(CASE WHEN MHM.Description = 'Unbooked Cases' THEN ISNULL(MH.Result,0) ELSE 0 END) AS NO_OF_UNBOOKED_MATERNAL_DEATHS
		  ,SUM(CASE WHEN MHM.Description IN ('Maternal Deaths at the unit (Booked cases)','Unbooked Cases') THEN ISNULL(MH.Result,0) ELSE 0 END) AS TOTAL_NO_OF_MATERNAL_DEATHS
		  ,SUM(CASE WHEN MHM.Description = 'Number of B.I.D at the unit' THEN ISNULL(MH.Result,0) ELSE 0 END) AS NO_OF_BID_AT_TH_UNITS
		  ,SUM(CASE WHEN MHM.Description = 'Number of all Abortion Cases' THEN ISNULL(MH.Result,0) ELSE 0 END) AS NO_OF_ALL_ABORTION_CASES
	FROM dbo.CompanyMaster AS CM
	INNER JOIN dbo.MaternalHealth AS MH
	ON CM.RecId = MH.CompanyId
	INNER JOIN dbo.MaternalHealthMaster AS MHM
	ON MH.RefSrNo = MHM.SrNo
	WHERE ((MH.CMonth >= @CMonth AND MH.CMonth <= @EMonth) OR (@CMonth + @EMonth = 0))
	AND (MH.CYear = @CYear)
	AND (MH.CompanyId = @CompanyId OR @CompanyId = 0)
	AND (MH.Htype = @HType OR (@HType = -100 AND MH.Htype IN (165,166)))
	GROUP BY CM.CName
END
GO
/****** Object:  StoredProcedure [dbo].[RptGovNCOPCC]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <18 Jan 2020>
-- Htype 1 For GENERAL
-- Htype 2 For MCC
-- Htype -100 For COMPLEX
-- DateMode 1 For Get Data For Month and Year
-- DateMode 2 For Get Data For FromDate ToDate
-- =============================================
-- Execute RptGovNCOPCC 0,0,2019,0,1,'1900/01/01','1900/01/01',1
-- Execute RptGovNCOPCC 0,0,2019,0,2,'1900/01/01','1900/01/01',1
-- Execute RptGovNCOPCC 0,0,2019,0,-100,'1900/01/01','1900/01/01',1
-- Execute RptGovNCOPCC 0,0,2019,0,1,'2019/01/01','2019/12/31',2
-- Execute RptGovNCOPCC 0,0,2019,0,2,'2019/01/01','2019/12/31',2
-- Execute RptGovNCOPCC 0,0,2019,0,-100,'2019/01/01','2019/12/31',2
CREATE PROCEDURE [dbo].[RptGovNCOPCC]
@CMonth Int,
@EMonth Int,
@CYear Int,
@CompanyId Bigint,
@HType Int,
@FromDate Datetime,
@ToDate Datetime,
@DateMode Int
AS
BEGIN
	IF (@DateMode = 1)
		BEGIN
			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName
				  ,SUM(CASE WHEN SM.ServiceName = 'General OPD' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GOPD
				  ,SUM(CASE WHEN SM.ServiceName = 'Accident' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ACCIDENT
				  ,SUM(CASE WHEN SM.ServiceName = 'Emergency' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS [EMERGENCY]
				  ,SUM(CASE WHEN SM.ServiceName = 'Medical' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MEDICAL
				  ,SUM(CASE WHEN SM.ServiceName = 'Surgical (Non-Ort)' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SURGICAL
				  ,SUM(CASE WHEN SM.ServiceName = 'Orthopaedic' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ORTHO
				  ,SUM(CASE WHEN SM.ServiceName = 'Obs. &Gynae' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OBSSGYICAS
				  ,SUM(CASE WHEN SM.ServiceName = 'ANC' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ANC
				  ,SUM(CASE WHEN SM.ServiceName = 'Eye' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS EYE
				  ,SUM(CASE WHEN SM.ServiceName = 'E.N.T' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ENT
				  ,SUM(CASE WHEN SM.ServiceName = 'SCD' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SCD
				  ,SUM(CASE WHEN SM.ServiceName = 'Immuno' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS IMMUNO
				  ,SUM(CASE WHEN SM.ServiceName = 'NHIS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NHIS
				  ,SUM(CASE WHEN SM.ServiceName = 'V.D' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS VENERAL_DISEASE
				  ,SUM(CASE WHEN SM.ServiceName = 'N.D' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NERVOUS_DISEASE
				  ,SUM(CASE WHEN SM.ServiceName = 'Dialysis' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DIALYSIS
				  ,SUM(CASE WHEN SM.ServiceName = 'SKIN' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SKIN
				  ,SUM(CASE WHEN SM.ServiceName = 'T.B' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TB
				  ,SUM(CASE WHEN SM.ServiceName = 'Physical Med & Rehab' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PHYSICAL_MEDICINE_REHAB
				  ,SUM(CASE WHEN SM.ServiceName = 'Pediatrics' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PAEDIATRICS
				  ,SUM(CASE WHEN SM.ServiceName = 'Dental' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DENTAL
				  ,SUM(CASE WHEN SM.ServiceName = 'Haematoogy' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HAEMATOOGY
				  ,SUM(CASE WHEN SM.ServiceName = 'Urology' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS UROLOGY
				  ,SUM(CASE WHEN SM.ServiceName = 'Geriatic' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GERIATIC
				  ,SUM(CASE WHEN SM.ServiceName = 'OnCology' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ONCOLOGY
				  ,SUM(CASE WHEN SM.ServiceName IN ('General OPD','Accident','Emergency','Medical','Surgical (Non-Ort)','Orthopaedic','Obs. &Gynae','ANC','Eye','E.N.T','SCD','Immuno','NHIS','V.D','N.D','Dialysis','SKIN','T.B','Physical Med & Rehab','Pediatrics','Dental','Haematoogy','Urology','Geriatic','OnCology')
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.CaseDetail AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE ((CD.CMonth >= @CMonth AND CD.CMonth <= @EMonth) OR (@CMonth + @EMonth = 0))
			AND (CD.CYear = @CYear)
			AND (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.HType = @HType OR (@HType = -100 AND CD.HType IN (1,2)))
			AND (SM.GroupId = 1)
			AND (CD.CaseType = 1)
			GROUP BY CM.CName
		END
	ELSE IF (@DateMode = 2)
		BEGIN
			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName
				  ,SUM(CASE WHEN SM.ServiceName = 'General OPD' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GOPD
				  ,SUM(CASE WHEN SM.ServiceName = 'Accident' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ACCIDENT
				  ,SUM(CASE WHEN SM.ServiceName = 'Emergency' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS [EMERGENCY]
				  ,SUM(CASE WHEN SM.ServiceName = 'Medical' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MEDICAL
				  ,SUM(CASE WHEN SM.ServiceName = 'Surgical (Non-Ort)' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SURGICAL
				  ,SUM(CASE WHEN SM.ServiceName = 'Orthopaedic' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ORTHO
				  ,SUM(CASE WHEN SM.ServiceName = 'Obs. &Gynae' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OBSSGYICAS
				  ,SUM(CASE WHEN SM.ServiceName = 'ANC' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ANC
				  ,SUM(CASE WHEN SM.ServiceName = 'Eye' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS EYE
				  ,SUM(CASE WHEN SM.ServiceName = 'E.N.T' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ENT
				  ,SUM(CASE WHEN SM.ServiceName = 'SCD' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SCD
				  ,SUM(CASE WHEN SM.ServiceName = 'Immuno' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS IMMUNO
				  ,SUM(CASE WHEN SM.ServiceName = 'NHIS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NHIS
				  ,SUM(CASE WHEN SM.ServiceName = 'V.D' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS VENERAL_DISEASE
				  ,SUM(CASE WHEN SM.ServiceName = 'N.D' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NERVOUS_DISEASE
				  ,SUM(CASE WHEN SM.ServiceName = 'Dialysis' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DIALYSIS
				  ,SUM(CASE WHEN SM.ServiceName = 'SKIN' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SKIN
				  ,SUM(CASE WHEN SM.ServiceName = 'T.B' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TB
				  ,SUM(CASE WHEN SM.ServiceName = 'Physical Med & Rehab' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PHYSICAL_MEDICINE_REHAB
				  ,SUM(CASE WHEN SM.ServiceName = 'Pediatrics' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PAEDIATRICS
				  ,SUM(CASE WHEN SM.ServiceName = 'Dental' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DENTAL
				  ,SUM(CASE WHEN SM.ServiceName = 'Haematoogy' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HAEMATOOGY
				  ,SUM(CASE WHEN SM.ServiceName = 'Urology' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS UROLOGY
				  ,SUM(CASE WHEN SM.ServiceName = 'Geriatic' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GERIATIC
				  ,SUM(CASE WHEN SM.ServiceName = 'OnCology' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ONCOLOGY
				  ,SUM(CASE WHEN SM.ServiceName IN ('General OPD','Accident','Emergency','Medical','Surgical (Non-Ort)','Orthopaedic','Obs. &Gynae','ANC','Eye','E.N.T','SCD','Immuno','NHIS','V.D','N.D','Dialysis','SKIN','T.B','Physical Med & Rehab','Pediatrics','Dental','Haematoogy','Urology','Geriatic','OnCology')
							THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.fn_CaseDetailDateWise(@FromDate,@ToDate) AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.HType = @HType OR (@HType = -100 AND CD.HType IN (1,2)))
			AND (SM.GroupId = 1)
			AND (CD.CaseType = 1)
			GROUP BY CM.CName
		END
END
GO
/****** Object:  StoredProcedure [dbo].[RptGovOCOPCC]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <18 Jan 2020>
-- Htype 1 For GENERAL
-- Htype 2 For MCC
-- Htype -100 For COMPLEX
-- DateMode 1 For Get Data For Month and Year
-- DateMode 2 For Get Data For FromDate ToDate
-- =============================================
-- Execute RptGovOCOPCC 0,0,2019,0,1,'1900/01/01','1900/01/01',1
-- Execute RptGovOCOPCC 0,0,2019,0,2,'1900/01/01','1900/01/01',1
-- Execute RptGovOCOPCC 0,0,2019,0,-100,'1900/01/01','1900/01/01',1
-- Execute RptGovOCOPCC 0,0,2019,0,1,'2019/01/01','2019/12/31',2
-- Execute RptGovOCOPCC 0,0,2019,0,2,'2019/01/01','2019/12/31',2
-- Execute RptGovOCOPCC 0,0,2019,0,-100,'2019/01/01','2019/12/31',2
CREATE PROCEDURE [dbo].[RptGovOCOPCC]
@CMonth Int,
@EMonth Int,
@CYear Int,
@CompanyId Bigint,
@HType Int,
@FromDate Datetime,
@ToDate Datetime,
@DateMode Int
AS
BEGIN
	IF (@DateMode = 1)
		BEGIN
			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName
				  ,SUM(CASE WHEN SM.ServiceName = 'General OPD' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GOPD
				  ,SUM(CASE WHEN SM.ServiceName = 'Accident' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ACCIDENT
				  ,SUM(CASE WHEN SM.ServiceName = 'Emergency' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS [EMERGENCY]
				  ,SUM(CASE WHEN SM.ServiceName = 'Medical' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MEDICAL
				  ,SUM(CASE WHEN SM.ServiceName = 'Surgical (Non-Ort)' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SURGICAL
				  ,SUM(CASE WHEN SM.ServiceName = 'Orthopaedic' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ORTHO
				  ,SUM(CASE WHEN SM.ServiceName = 'Obs. &Gynae' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OBSSGYICAS
				  ,SUM(CASE WHEN SM.ServiceName = 'ANC' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ANC
				  ,SUM(CASE WHEN SM.ServiceName = 'Eye' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS EYE
				  ,SUM(CASE WHEN SM.ServiceName = 'E.N.T' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ENT
				  ,SUM(CASE WHEN SM.ServiceName = 'SCD' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SCD
				  ,SUM(CASE WHEN SM.ServiceName = 'Immuno' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS IMMUNO
				  ,SUM(CASE WHEN SM.ServiceName = 'NHIS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NHIS
				  ,SUM(CASE WHEN SM.ServiceName = 'V.D' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS VENERAL_DISEASE
				  ,SUM(CASE WHEN SM.ServiceName = 'N.D' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NERVOUS_DISEASE
				  ,SUM(CASE WHEN SM.ServiceName = 'Dialysis' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DIALYSIS
				  ,SUM(CASE WHEN SM.ServiceName = 'SKIN' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SKIN
				  ,SUM(CASE WHEN SM.ServiceName = 'T.B' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TB
				  ,SUM(CASE WHEN SM.ServiceName = 'Physical Med & Rehab' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PHYSICAL_MEDICINE_REHAB
				  ,SUM(CASE WHEN SM.ServiceName = 'Pediatrics' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PAEDIATRICS
				  ,SUM(CASE WHEN SM.ServiceName = 'Dental' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DENTAL
				  ,SUM(CASE WHEN SM.ServiceName = 'Haematoogy' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS HAEMATOOGY
				  ,SUM(CASE WHEN SM.ServiceName = 'Urology' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS UROLOGY
				  ,SUM(CASE WHEN SM.ServiceName = 'Geriatic' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GERIATIC
				  ,SUM(CASE WHEN SM.ServiceName = 'OnCology' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ONCOLOGY
				  ,SUM(CASE WHEN SM.ServiceName IN ('General OPD','Accident','Emergency','Medical','Surgical (Non-Ort)','Orthopaedic','Obs. &Gynae','ANC','Eye','E.N.T','SCD','Immuno','NHIS','V.D','N.D','Dialysis','SKIN','T.B','Physical Med & Rehab','Pediatrics','Dental','Haematoogy','Urology','Geriatic','OnCology')
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.CaseDetail AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE ((CD.CMonth >= @CMonth AND CD.CMonth <= @EMonth) OR (@CMonth + @EMonth = 0))
			AND (CD.CYear = @CYear)
			AND (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.HType = @HType OR (@HType = -100 AND CD.HType IN (1,2)))
			AND (SM.GroupId = 1)
			AND (CD.CaseType = 2)
			GROUP BY CM.CName
		END
	ELSE IF (@DateMode = 2)
		BEGIN
			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName
				  ,SUM(CASE WHEN SM.ServiceName = 'General OPD' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GOPD
				  ,SUM(CASE WHEN SM.ServiceName = 'Accident' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ACCIDENT
				  ,SUM(CASE WHEN SM.ServiceName = 'Emergency' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS [EMERGENCY]
				  ,SUM(CASE WHEN SM.ServiceName = 'Medical' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MEDICAL
				  ,SUM(CASE WHEN SM.ServiceName = 'Surgical (Non-Ort)' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SURGICAL
				  ,SUM(CASE WHEN SM.ServiceName = 'Orthopaedic' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ORTHO
				  ,SUM(CASE WHEN SM.ServiceName = 'Obs. &Gynae' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OBSSGYICAS
				  ,SUM(CASE WHEN SM.ServiceName = 'ANC' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ANC
				  ,SUM(CASE WHEN SM.ServiceName = 'Eye' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS EYE
				  ,SUM(CASE WHEN SM.ServiceName = 'E.N.T' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ENT
				  ,SUM(CASE WHEN SM.ServiceName = 'SCD' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SCD
				  ,SUM(CASE WHEN SM.ServiceName = 'Immuno' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS IMMUNO
				  ,SUM(CASE WHEN SM.ServiceName = 'NHIS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NHIS
				  ,SUM(CASE WHEN SM.ServiceName = 'V.D' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS VENERAL_DISEASE
				  ,SUM(CASE WHEN SM.ServiceName = 'N.D' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NERVOUS_DISEASE
				  ,SUM(CASE WHEN SM.ServiceName = 'Dialysis' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DIALYSIS
				  ,SUM(CASE WHEN SM.ServiceName = 'SKIN' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SKIN
				  ,SUM(CASE WHEN SM.ServiceName = 'T.B' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TB
				  ,SUM(CASE WHEN SM.ServiceName = 'Physical Med & Rehab' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PHYSICAL_MEDICINE_REHAB
				  ,SUM(CASE WHEN SM.ServiceName = 'Pediatrics' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PAEDIATRICS
				  ,SUM(CASE WHEN SM.ServiceName = 'Dental' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DENTAL
				  ,SUM(CASE WHEN SM.ServiceName = 'Haematoogy' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS HAEMATOOGY
				  ,SUM(CASE WHEN SM.ServiceName = 'Urology' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS UROLOGY
				  ,SUM(CASE WHEN SM.ServiceName = 'Geriatic' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GERIATIC
				  ,SUM(CASE WHEN SM.ServiceName = 'OnCology' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ONCOLOGY
				  ,SUM(CASE WHEN SM.ServiceName IN ('General OPD','Accident','Emergency','Medical','Surgical (Non-Ort)','Orthopaedic','Obs. &Gynae','ANC','Eye','E.N.T','SCD','Immuno','NHIS','V.D','N.D','Dialysis','SKIN','T.B','Physical Med & Rehab','Pediatrics','Dental','Haematoogy','Urology','Geriatic','OnCology')
							THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.fn_CaseDetailDateWise(@FromDate,@ToDate) AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.HType = @HType OR (@HType = -100 AND CD.HType IN (1,2)))
			AND (SM.GroupId = 1)
			AND (CD.CaseType = 2)
			GROUP BY CM.CName
		END
END
GO
/****** Object:  StoredProcedure [dbo].[RptGovOPNCBAG]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <18 Jan 2020>
-- Htype 16 For GENERAL
-- Htype 12 For MCC
-- Htype -100 For COMPLEX
-- DateMode 1 For Get Data For Month and Year
-- DateMode 2 For Get Data For FromDate ToDate
-- =============================================
-- Execute RptGovOPNCBAG 0,0,2019,0,16,'1900/01/01','1900/01/01',1
-- Execute RptGovOPNCBAG 0,0,2019,0,12,'1900/01/01','1900/01/01',1
-- Execute RptGovOPNCBAG 0,0,2019,0,-100,'1900/01/01','1900/01/01',1
-- Execute RptGovOPNCBAG 0,0,2019,0,16,'2019/01/01','2019/12/31',2
-- Execute RptGovOPNCBAG 0,0,2019,0,12,'2019/01/01','2019/12/31',2
-- Execute RptGovOPNCBAG 0,0,2019,0,-100,'2019/01/01','2019/12/31',2
CREATE PROCEDURE [dbo].[RptGovOPNCBAG]
@CMonth Int,
@EMonth Int,
@CYear Int,
@CompanyId Bigint,
@HType Int,
@FromDate Datetime,
@ToDate Datetime,
@DateMode Int
AS
BEGIN
	IF (@DateMode = 1)
		BEGIN
			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName
				  ,SUM(CASE WHEN SM.ServiceName = 'UNDER 1 MONTHS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS UNDER_1_MTH
				  ,SUM(CASE WHEN SM.ServiceName = '1-11 MONTHS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'MTHS_1_11'
				  ,SUM(CASE WHEN SM.ServiceName = '1- 2 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_1_2'
				  ,SUM(CASE WHEN SM.ServiceName = '3 - 4 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_3_4'
				  ,SUM(CASE WHEN SM.ServiceName = '5 - 9 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_5_9'
				  ,SUM(CASE WHEN SM.ServiceName = '10 - 14 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_10_14'
				  ,SUM(CASE WHEN SM.ServiceName = '15 - 19 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_15_19'
				  ,SUM(CASE WHEN SM.ServiceName = '20 - 24 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_20_24'
				  ,SUM(CASE WHEN SM.ServiceName = '25 - 29 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_25_29'
				  ,SUM(CASE WHEN SM.ServiceName = '30 - 34 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_30_34'
				  ,SUM(CASE WHEN SM.ServiceName = '35 - 39 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_35_39'
				  ,SUM(CASE WHEN SM.ServiceName = '40 - 44 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_40_44'
				  ,SUM(CASE WHEN SM.ServiceName = '45 - 49 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_45_49'
				  ,SUM(CASE WHEN SM.ServiceName = '50 - 54 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_50_54'
				  ,SUM(CASE WHEN SM.ServiceName = ' 55- 59 YEARS ' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_55_59'
				  ,SUM(CASE WHEN SM.ServiceName = '60 - 64 YEARS ' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_60_64'
				  ,SUM(CASE WHEN SM.ServiceName = '65 - 69 YEARS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_65_69'
				  ,SUM(CASE WHEN SM.ServiceName = '70 - 74 YEARS ' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_70_74'
				  ,SUM(CASE WHEN SM.ServiceName = '75 - 79 YEARS ' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_75_79'
				  ,SUM(CASE WHEN SM.ServiceName = '80 - 84 YEARS ' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_80_84'
				  ,SUM(CASE WHEN SM.ServiceName = '85 YEARS & ABOVE' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS 'YRS_85_ABOVE'
				  ,SUM(CASE WHEN SM.ServiceName = 'UNKNOWN' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS UNKNOWN
				  ,SUM(CASE WHEN SM.ServiceName IN ('UNDER 1 MONTHS','1-11 MONTHS','1- 2 YEARS','3 - 4 YEARS','5 - 9 YEARS','10 - 14 YEARS','15 - 19 YEARS','20 - 24 YEARS','25 - 29 YEARS','30 - 34 YEARS','35 - 39 YEARS','40 - 44 YEARS','45 - 49 YEARS','50 - 54 YEARS',' 55- 59 YEARS ','60 - 64 YEARS ','65 - 69 YEARS','70 - 74 YEARS ','75 - 79 YEARS ','80 - 84 YEARS ','85 YEARS & ABOVE','UNKNOWN')
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.CaseDetail AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE ((CD.CMonth >= @CMonth AND CD.CMonth <= @EMonth) OR (@CMonth + @EMonth = 0))
			AND (CD.CYear = @CYear)
			AND (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.HType = @HType OR (@HType = -100 AND CD.HType IN (16,12)))
			AND (CD.CaseType = 1)
			GROUP BY CM.CName
		END
	ELSE IF (@DateMode = 2)
		BEGIN
			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName
				  ,SUM(CASE WHEN SM.ServiceName = 'UNDER 1 MONTHS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS UNDER_1_MTH
				  ,SUM(CASE WHEN SM.ServiceName = '1-11 MONTHS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'MTHS_1_11'
				  ,SUM(CASE WHEN SM.ServiceName = '1- 2 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_1_2'
				  ,SUM(CASE WHEN SM.ServiceName = '3 - 4 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_3_4'
				  ,SUM(CASE WHEN SM.ServiceName = '5 - 9 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_5_9'
				  ,SUM(CASE WHEN SM.ServiceName = '10 - 14 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_10_14'
				  ,SUM(CASE WHEN SM.ServiceName = '15 - 19 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_15_19'
				  ,SUM(CASE WHEN SM.ServiceName = '20 - 24 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_20_24'
				  ,SUM(CASE WHEN SM.ServiceName = '25 - 29 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_25_29'
				  ,SUM(CASE WHEN SM.ServiceName = '30 - 34 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_30_34'
				  ,SUM(CASE WHEN SM.ServiceName = '35 - 39 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_35_39'
				  ,SUM(CASE WHEN SM.ServiceName = '40 - 44 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_40_44'
				  ,SUM(CASE WHEN SM.ServiceName = '45 - 49 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_45_49'
				  ,SUM(CASE WHEN SM.ServiceName = '50 - 54 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_50_54'
				  ,SUM(CASE WHEN SM.ServiceName = ' 55- 59 YEARS ' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_55_59'
				  ,SUM(CASE WHEN SM.ServiceName = '60 - 64 YEARS ' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_60_64'
				  ,SUM(CASE WHEN SM.ServiceName = '65 - 69 YEARS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_65_69'
				  ,SUM(CASE WHEN SM.ServiceName = '70 - 74 YEARS ' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_70_74'
				  ,SUM(CASE WHEN SM.ServiceName = '75 - 79 YEARS ' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_75_79'
				  ,SUM(CASE WHEN SM.ServiceName = '80 - 84 YEARS ' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_80_84'
				  ,SUM(CASE WHEN SM.ServiceName = '85 YEARS & ABOVE' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS 'YRS_85_ABOVE'
				  ,SUM(CASE WHEN SM.ServiceName = 'UNKNOWN' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS UNKNOWN
				  ,SUM(CASE WHEN SM.ServiceName IN ('UNDER 1 MONTHS','1-11 MONTHS','1- 2 YEARS','3 - 4 YEARS','5 - 9 YEARS','10 - 14 YEARS','15 - 19 YEARS','20 - 24 YEARS','25 - 29 YEARS','30 - 34 YEARS','35 - 39 YEARS','40 - 44 YEARS','45 - 49 YEARS','50 - 54 YEARS',' 55- 59 YEARS ','60 - 64 YEARS ','65 - 69 YEARS','70 - 74 YEARS ','75 - 79 YEARS ','80 - 84 YEARS ','85 YEARS & ABOVE','UNKNOWN')
							THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.fn_CaseDetailDateWise(@FromDate,@ToDate) AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.HType = @HType OR (@HType = -100 AND CD.HType IN (16,12)))
			AND (CD.CaseType = 1)
			GROUP BY CM.CName
		END
END
GO
/****** Object:  StoredProcedure [dbo].[RptGovOPTA]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <18 Jan 2020>
-- Htype 1 For GENERAL
-- Htype 2 For MCC
-- Htype -100 For COMPLEX
-- DateMode 1 For Get Data For Month and Year
-- DateMode 2 For Get Data For FromDate ToDate
-- =============================================
-- Execute RptGovOPTA 0,0,2019,0,1,'1900/01/01','1900/01/01',1
-- Execute RptGovOPTA 0,0,2019,0,2,'1900/01/01','1900/01/01',1
-- Execute RptGovOPTA 0,0,2019,0,-100,'1900/01/01','1900/01/01',1
-- Execute RptGovOPTA 0,0,2019,0,1,'2019/01/01','2019/12/31',2
-- Execute RptGovOPTA 0,0,2019,0,2,'2019/01/01','2019/12/31',2
-- Execute RptGovOPTA 0,0,2019,0,-100,'2019/01/01','2019/12/31',2
CREATE PROCEDURE [dbo].[RptGovOPTA]
@CMonth Int,
@EMonth Int,
@CYear Int,
@CompanyId Bigint,
@HType Int,
@FromDate Datetime,
@ToDate Datetime,
@DateMode Int
AS
BEGIN
	DECLARE @DayCount AS INT,@ParentId BIGINT,@RecIdOPDDeath BIGINT,@RecIdBID BIGINT

	SELECT @ParentId = SM.RecId from ServicesMaster AS SM where SM.ServiceName = 'MISCELLANEOUS'
	SELECT @RecIdOPDDeath = SM.RecId FROM dbo.ServicesMaster AS SM WHERE SM.ServiceName = 'OPD DEATH'
	SELECT @RecIdBID = SM.RecId FROM dbo.ServicesMaster AS SM WHERE SM.ServiceName = 'BROUGHT IN DEATHS'

	IF (@DateMode = 1)
		BEGIN
			SELECT @DayCount = SUM(MonthTotalDays)
			FROM dbo.MonthDays
			WHERE (MonthId >= @CMonth AND MonthId <= @EMonth)
			OR (@CMonth = 0 AND @EMonth = 0)

			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName
				  ,SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 1 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NEW_CASES_MALE
				  ,SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 1 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NEW_CASES_FEMALE
				  ,SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 1 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NEW_CASES_TOTAL
		  
				  ,SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 2 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OLD_CASES_MALE
				  ,SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 2 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OLD_CASES_FEMALE
				  ,SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 2 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OLD_CASES_TOTAL
		  
				  ,SUM(CASE WHEN SM.ParentId = @ParentId AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MISCELLANEOUS_ATTENDANCE_MALE
				  ,SUM(CASE WHEN SM.ParentId = @ParentId AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MISCELLANEOUS_ATTENDANCE_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = @ParentId AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS MISCELLANEOUS_ATTENDANCE_TOTAL
		  
				  ,ISNULL(SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 1 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END),0)+
				   ISNULL(SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 2 AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END),0)+
				   ISNULL(SUM(CASE WHEN SM.ParentId = @ParentId AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END),0) AS TOTAL_ATTENDANCE_MALE

				  ,ISNULL(SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 1 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END),0)+
				   ISNULL(SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 2 AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END),0)+
				   ISNULL(SUM(CASE WHEN SM.ParentId = @ParentId AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END),0) AS TOTAL_ATTENDANCE_FEMALE
		  
				  ,ISNULL(SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 1 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END),0)+
				   ISNULL(SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 2 AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END),0)+
				   ISNULL(SUM(CASE WHEN SM.ParentId = @ParentId AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END),0) AS TOTAL_ATTENDANCE_TOTAL
		  
				  ,@DayCount AS W_DAYS
				  ,CONVERT(DECIMAL(10,2),CONVERT(DECIMAL(10,2),SUM(CASE WHEN SM.GroupId IN (1,10) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END)) / CONVERT(DECIMAL(10,2),(CASE WHEN @DayCount > 0 THEN @DayCount ELSE 1 END))) AS AV_DAILY_ATTENDS
				  ,0 AS [PERCENT]

				  ,SUM(CASE WHEN SM.RecId = @RecIdOPDDeath AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OUT_PATIENT_DEATH_MALE
				  ,SUM(CASE WHEN SM.RecId = @RecIdOPDDeath AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OUT_PATIENT_DEATH_FEMALE
				  ,SUM(CASE WHEN SM.RecId = @RecIdOPDDeath AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OUT_PATIENT_DEATH_TOTAL

				  ,SUM(CASE WHEN SM.RecId = @RecIdBID AND CD.Gender = 1 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BROUGHT_IN_DEAD_MALE
				  ,SUM(CASE WHEN SM.RecId = @RecIdBID AND CD.Gender = 2 THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BROUGHT_IN_DEAD_FEMALE
				  ,SUM(CASE WHEN SM.RecId = @RecIdBID AND CD.Gender IN (1,2) THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BROUGHT_IN_DEAD_TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.CaseDetail AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE ((CD.CMonth >= @CMonth AND CD.CMonth <= @EMonth) OR (@CMonth + @EMonth = 0))
			AND (CD.CYear = @CYear)
			AND (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.HType = @HType OR (@HType = -100 AND CD.HType IN (1,2)))
			AND (SM.ParentId > 0)
			AND (SM.GroupId = 1 OR SM.GroupId = 10 OR SM.GroupId = 15)
			GROUP BY CM.CName
		END
	ELSE IF (@DateMode = 2)
		BEGIN
			SELECT @DayCount = DATEDIFF(DAY,@FromDate,@ToDate)

			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName
				  ,SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 1 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NEW_CASES_MALE
				  ,SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 1 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NEW_CASES_FEMALE
				  ,SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 1 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NEW_CASES_TOTAL
		  
				  ,SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 2 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OLD_CASES_MALE
				  ,SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 2 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OLD_CASES_FEMALE
				  ,SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 2 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OLD_CASES_TOTAL
		  
				  ,SUM(CASE WHEN SM.ParentId = @ParentId AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MISCELLANEOUS_ATTENDANCE_MALE
				  ,SUM(CASE WHEN SM.ParentId = @ParentId AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MISCELLANEOUS_ATTENDANCE_FEMALE
				  ,SUM(CASE WHEN SM.ParentId = @ParentId AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS MISCELLANEOUS_ATTENDANCE_TOTAL
		  
				  ,ISNULL(SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 1 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END),0)+
				   ISNULL(SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 2 AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END),0)+
				   ISNULL(SUM(CASE WHEN SM.ParentId = @ParentId AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END),0) AS TOTAL_ATTENDANCE_MALE

				  ,ISNULL(SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 1 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END),0)+
				   ISNULL(SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 2 AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END),0)+
				   ISNULL(SUM(CASE WHEN SM.ParentId = @ParentId AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END),0) AS TOTAL_ATTENDANCE_FEMALE
		  
				  ,ISNULL(SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 1 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END),0)+
				   ISNULL(SUM(CASE WHEN SM.ParentId <> @ParentId AND CD.CaseType = 2 AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END),0)+
				   ISNULL(SUM(CASE WHEN SM.ParentId = @ParentId AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END),0) AS TOTAL_ATTENDANCE_TOTAL
		  
				  ,@DayCount AS W_DAYS
				  ,CONVERT(DECIMAL(10,2),CONVERT(DECIMAL(10,2),SUM(CASE WHEN SM.GroupId IN (1,10) THEN ISNULL(CD.DayVal,0) ELSE 0 END)) / CONVERT(DECIMAL(10,2),(CASE WHEN @DayCount > 0 THEN @DayCount ELSE 1 END))) AS AV_DAILY_ATTENDS
				  ,0 AS [PERCENT]

				  ,SUM(CASE WHEN SM.RecId = @RecIdOPDDeath AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OUT_PATIENT_DEATH_MALE
				  ,SUM(CASE WHEN SM.RecId = @RecIdOPDDeath AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OUT_PATIENT_DEATH_FEMALE
				  ,SUM(CASE WHEN SM.RecId = @RecIdOPDDeath AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OUT_PATIENT_DEATH_TOTAL

				  ,SUM(CASE WHEN SM.RecId = @RecIdBID AND CD.Gender = 1 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BROUGHT_IN_DEAD_MALE
				  ,SUM(CASE WHEN SM.RecId = @RecIdBID AND CD.Gender = 2 THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BROUGHT_IN_DEAD_FEMALE
				  ,SUM(CASE WHEN SM.RecId = @RecIdBID AND CD.Gender IN (1,2) THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BROUGHT_IN_DEAD_TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.fn_CaseDetailDateWise(@FromDate,@ToDate) AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.HType = @HType OR (@HType = -100 AND CD.HType IN (1,2)))
			AND (SM.ParentId > 0)
			AND (SM.GroupId = 1 OR SM.GroupId = 10 OR SM.GroupId = 15)
			GROUP BY CM.CName
		END
END
GO
/****** Object:  StoredProcedure [dbo].[RptGovUOHSATSOO]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <18 Jan 2020>
-- Htype 7,Htype1 29 For GENERAL
-- Htype 8,Htype1 31 For MCC
-- Htype -100,Htype1 -100 For COMPLEX
-- DateMode 1 For Get Data For Month and Year
-- DateMode 2 For Get Data For FromDate ToDate
-- =============================================
-- Execute RptGovUOHSATSOO 0,0,2019,0,7,29,'1900/01/01','1900/01/01',1
-- Execute RptGovUOHSATSOO 0,0,2019,0,8,31,'1900/01/01','1900/01/01',1
-- Execute RptGovUOHSATSOO 0,0,2019,0,-100,-100,'1900/01/01','1900/01/01',1
-- Execute RptGovUOHSATSOO 0,0,2019,0,7,29,'2019/01/01','2019/12/31',2
-- Execute RptGovUOHSATSOO 0,0,2019,0,8,31,'2019/01/01','2019/12/31',2
-- Execute RptGovUOHSATSOO 0,0,2019,0,-100,-100,'2019/01/01','2019/12/31',2
CREATE PROCEDURE [dbo].[RptGovUOHSATSOO]
@CMonth Int,
@EMonth Int,
@CYear Int,
@CompanyId Bigint,
@HType Int,
@HType1 Int,
@FromDate Datetime,
@ToDate Datetime,
@DateMode Int
AS
BEGIN
	IF (@DateMode = 1)
		BEGIN
			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName
				  ,SUM(CASE WHEN SM.ServiceName = 'ABIA' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ABIA
				  ,SUM(CASE WHEN SM.ServiceName = 'ADAMAWA' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ADAMAWA
				  ,SUM(CASE WHEN SM.ServiceName = 'AKWA-IBOM' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS AKWAIBOM
				  ,SUM(CASE WHEN SM.ServiceName = 'ANAMBRA' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ANAMBRA
				  ,SUM(CASE WHEN SM.ServiceName = 'BAUCHI' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BAUCHI
				  ,SUM(CASE WHEN SM.ServiceName = 'BAYELSA' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BAYELSA
				  ,SUM(CASE WHEN SM.ServiceName = 'BENUE' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BENUE
				  ,SUM(CASE WHEN SM.ServiceName = 'BORNO' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS BORNO
				  ,SUM(CASE WHEN SM.ServiceName = 'CROSS-RIVER' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS CROSSRIVER
				  ,SUM(CASE WHEN SM.ServiceName = 'DELTA' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS DELTA
				  ,SUM(CASE WHEN SM.ServiceName = 'EBONYI' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS EBONYI
				  ,SUM(CASE WHEN SM.ServiceName = 'EDO' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS EDO
				  ,SUM(CASE WHEN SM.ServiceName = 'EKITI' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS EKITI
				  ,SUM(CASE WHEN SM.ServiceName = 'ENUGU' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ENUGU
				  ,SUM(CASE WHEN SM.ServiceName = 'FED. CAP. TER' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS FCT
				  ,SUM(CASE WHEN SM.ServiceName = 'GOMBE' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS GOMBE
				  ,SUM(CASE WHEN SM.ServiceName = 'IMO' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS IMO
				  ,SUM(CASE WHEN SM.ServiceName = 'JIGAWA' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS JIGAWA
				  ,SUM(CASE WHEN SM.ServiceName = 'KADUNA' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS KADUNA
				  ,SUM(CASE WHEN SM.ServiceName = 'KANO' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS KANO
				  ,SUM(CASE WHEN SM.ServiceName = 'KATSINA' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS KATSINA
				  ,SUM(CASE WHEN SM.ServiceName = 'KEBBI' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS KEBBI
				  ,SUM(CASE WHEN SM.ServiceName = 'KOGI' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS KOGI
				  ,SUM(CASE WHEN SM.ServiceName = 'KWARA' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS KWARA
				  ,SUM(CASE WHEN SM.ServiceName = 'LAGOS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS LAGOS
				  ,SUM(CASE WHEN SM.ServiceName = 'NASSARAWA' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NASSARAWA
				  ,SUM(CASE WHEN SM.ServiceName = 'NIGER' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS NIGER
				  ,SUM(CASE WHEN SM.ServiceName = 'OGUN' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OGUN
				  ,SUM(CASE WHEN SM.ServiceName = 'ONDO' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ONDO
				  ,SUM(CASE WHEN SM.ServiceName = 'OSUN' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OSUN
				  ,SUM(CASE WHEN SM.ServiceName = 'OYO' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OYO
				  ,SUM(CASE WHEN SM.ServiceName = 'PLATEAU' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS PLATEAU
				  ,SUM(CASE WHEN SM.ServiceName = 'RIVERS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS RIVERS
				  ,SUM(CASE WHEN SM.ServiceName = 'SOKOTO' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS SOKOTO
				  ,SUM(CASE WHEN SM.ServiceName = 'TARABA' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TARABA
				  ,SUM(CASE WHEN SM.ServiceName = 'YOBE' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS YOBE
				  ,SUM(CASE WHEN SM.ServiceName = 'ZAMFARA' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS ZAMFARA
				  ,SUM(CASE WHEN SM.ServiceName = 'OTHERS' THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS OTHERS
				  ,SUM(CASE WHEN SM.ServiceName IN('ABIA','ADAMAWA','AKWA-IBOM','ANAMBRA','BAUCHI','BAYELSA','BENUE','BORNO','CROSS-RIVER','DELTA','EBONYI','EDO','EKITI','ENUGU','FED. CAP. TER','GOMBE','IMO','JIGAWA','KADUNA','KANO','KATSINA','KEBBI','KOGI','KWARA','LAGOS','NASSARAWA','NIGER','OGUN','ONDO','OSUN','OYO','PLATEAU','RIVERS','SOKOTO','TARABA','YOBE','ZAMFARA','OTHERS')
							THEN ISNULL(CD.Date1,0) + ISNULL(CD.Date2,0) + ISNULL(CD.Date3,0) + ISNULL(CD.Date4,0) + ISNULL(CD.Date5,0) + ISNULL(CD.Date6,0) + ISNULL(CD.Date7,0) + ISNULL(CD.Date8,0) + ISNULL(CD.Date9,0) + ISNULL(CD.Date10,0) + ISNULL(CD.Date11,0) + ISNULL(CD.Date12,0) + ISNULL(CD.Date13,0) + ISNULL(CD.Date14,0) + ISNULL(CD.Date15,0) + ISNULL(CD.Date16,0) + ISNULL(CD.Date17,0) + ISNULL(CD.Date18,0) + ISNULL(CD.Date19,0) + ISNULL(CD.Date20,0) + ISNULL(CD.Date21,0) + ISNULL(CD.Date22,0) + ISNULL(CD.Date23,0) + ISNULL(CD.Date24,0) + ISNULL(CD.Date25,0) + ISNULL(CD.Date26,0) + ISNULL(CD.Date27,0) + ISNULL(CD.Date28,0) + ISNULL(CD.Date29,0) + ISNULL(CD.Date30,0) + ISNULL(CD.Date31,0) ELSE 0 END) AS TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.CaseDetail AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE ((CD.CMonth >= @CMonth AND CD.CMonth <= @EMonth) OR (@CMonth + @EMonth = 0))
			AND (CD.CYear = @CYear)
			AND (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.HType IN (@HType,@HType1) OR (@HType = -100 AND CD.HType IN (7,29,8,31)))
			GROUP BY CM.CName
		END
	ELSE IF (@DateMode = 2)
		BEGIN
			SELECT 0 AS SrNo
				  ,CM.CName AS HospitalName
				  ,SUM(CASE WHEN SM.ServiceName = 'ABIA' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ABIA
				  ,SUM(CASE WHEN SM.ServiceName = 'ADAMAWA' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ADAMAWA
				  ,SUM(CASE WHEN SM.ServiceName = 'AKWA-IBOM' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS AKWAIBOM
				  ,SUM(CASE WHEN SM.ServiceName = 'ANAMBRA' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ANAMBRA
				  ,SUM(CASE WHEN SM.ServiceName = 'BAUCHI' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BAUCHI
				  ,SUM(CASE WHEN SM.ServiceName = 'BAYELSA' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BAYELSA
				  ,SUM(CASE WHEN SM.ServiceName = 'BENUE' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BENUE
				  ,SUM(CASE WHEN SM.ServiceName = 'BORNO' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS BORNO
				  ,SUM(CASE WHEN SM.ServiceName = 'CROSS-RIVER' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS CROSSRIVER
				  ,SUM(CASE WHEN SM.ServiceName = 'DELTA' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS DELTA
				  ,SUM(CASE WHEN SM.ServiceName = 'EBONYI' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS EBONYI
				  ,SUM(CASE WHEN SM.ServiceName = 'EDO' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS EDO
				  ,SUM(CASE WHEN SM.ServiceName = 'EKITI' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS EKITI
				  ,SUM(CASE WHEN SM.ServiceName = 'ENUGU' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ENUGU
				  ,SUM(CASE WHEN SM.ServiceName = 'FED. CAP. TER' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS FCT
				  ,SUM(CASE WHEN SM.ServiceName = 'GOMBE' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS GOMBE
				  ,SUM(CASE WHEN SM.ServiceName = 'IMO' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS IMO
				  ,SUM(CASE WHEN SM.ServiceName = 'JIGAWA' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS JIGAWA
				  ,SUM(CASE WHEN SM.ServiceName = 'KADUNA' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS KADUNA
				  ,SUM(CASE WHEN SM.ServiceName = 'KANO' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS KANO
				  ,SUM(CASE WHEN SM.ServiceName = 'KATSINA' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS KATSINA
				  ,SUM(CASE WHEN SM.ServiceName = 'KEBBI' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS KEBBI
				  ,SUM(CASE WHEN SM.ServiceName = 'KOGI' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS KOGI
				  ,SUM(CASE WHEN SM.ServiceName = 'KWARA' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS KWARA
				  ,SUM(CASE WHEN SM.ServiceName = 'LAGOS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS LAGOS
				  ,SUM(CASE WHEN SM.ServiceName = 'NASSARAWA' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NASSARAWA
				  ,SUM(CASE WHEN SM.ServiceName = 'NIGER' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS NIGER
				  ,SUM(CASE WHEN SM.ServiceName = 'OGUN' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OGUN
				  ,SUM(CASE WHEN SM.ServiceName = 'ONDO' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ONDO
				  ,SUM(CASE WHEN SM.ServiceName = 'OSUN' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OSUN
				  ,SUM(CASE WHEN SM.ServiceName = 'OYO' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OYO
				  ,SUM(CASE WHEN SM.ServiceName = 'PLATEAU' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS PLATEAU
				  ,SUM(CASE WHEN SM.ServiceName = 'RIVERS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS RIVERS
				  ,SUM(CASE WHEN SM.ServiceName = 'SOKOTO' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS SOKOTO
				  ,SUM(CASE WHEN SM.ServiceName = 'TARABA' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TARABA
				  ,SUM(CASE WHEN SM.ServiceName = 'YOBE' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS YOBE
				  ,SUM(CASE WHEN SM.ServiceName = 'ZAMFARA' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS ZAMFARA
				  ,SUM(CASE WHEN SM.ServiceName = 'OTHERS' THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS OTHERS
				  ,SUM(CASE WHEN SM.ServiceName IN('ABIA','ADAMAWA','AKWA-IBOM','ANAMBRA','BAUCHI','BAYELSA','BENUE','BORNO','CROSS-RIVER','DELTA','EBONYI','EDO','EKITI','ENUGU','FED. CAP. TER','GOMBE','IMO','JIGAWA','KADUNA','KANO','KATSINA','KEBBI','KOGI','KWARA','LAGOS','NASSARAWA','NIGER','OGUN','ONDO','OSUN','OYO','PLATEAU','RIVERS','SOKOTO','TARABA','YOBE','ZAMFARA','OTHERS')
							THEN ISNULL(CD.DayVal,0) ELSE 0 END) AS TOTAL
			FROM dbo.CompanyMaster AS CM
			INNER JOIN dbo.fn_CaseDetailDateWise(@FromDate,@ToDate) AS CD
			ON CM.RecId = CD.CompanyId
			INNER JOIN dbo.ServicesMaster AS SM
			ON CD.ServiceId = SM.RecId
			WHERE (CD.CompanyId = @CompanyId OR @CompanyId = 0)
			AND (CD.HType IN (@HType,@HType1) OR (@HType = -100 AND CD.HType IN (7,29,8,31)))
			GROUP BY CM.CName
		END
END
GO
/****** Object:  StoredProcedure [dbo].[RptMonthlyData]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <07 July 2019>
-- Description:	<omtechsoft.com>
-- =============================================
-- EXECUTE [dbo].[RptMonthlyData] 7,2019,1,1,'',1,12
-- EXECUTE [dbo].[RptMonthlyData] 0,2019,1,1,'',1,0
CREATE PROCEDURE [dbo].[RptMonthlyData]
	@CMonth Int,
	@CYear Int,
	@HType Int, 
	@StateId int,
	@ReffNo Nvarchar(100),
	@CompanyId Bigint,
	@EMonth Int
AS
BEGIN
	SET NOCOUNT ON;
	Declare @CompanyName as Nvarchar(500)
	Declare @CAdd as Nvarchar(500)
	Declare @SubTitle as Nvarchar(100)

	SELECT @CompanyName =C.CName,@CAdd =C.City +', ' + S.StateName FROM DBO.CompanyMaster AS C
	INNER JOIN DBO.StateMaster AS S ON C.State =S.RecId 
	WHERE C.RecId =@CompanyId 	
	
	select @SubTitle =CASE WHEN @HType=1 OR @HType=4 THEN 'OUTPATIENT CASES AND ATTENDANCE (DOPCA) GENERAL' WHEN @HType=2 OR @HType=5 THEN 'OUTPATIENT CASES AND ATTENDANCE (DOPCA) MCC' WHEN @HType=3 OR @HType=6 THEN  'OUTPATIENT CASES AND ATTENDANCE (DOPCA) COMPLEX' ELSE 'OUTPATIENT CASES AND ATTENDANCE (DOPCA)' END + ' (' + CASE WHEN [dbo].[GetMonthName](@CMonth) = '' THEN '' ELSE [dbo].[GetMonthName](@CMonth) +' - ' END + Convert(nvarchar(4),@CYear) + ')'	
	
	;with cte as (SELECT 
		SM.RecId ,
		SM.ServiceName,
		(SELECT SM1.ServiceName FROM dbo.ServicesMaster AS SM1 WHERE SM1.RecId =SM.ParentId) AS PServiceName
	FROM dbo.ServicesMaster AS SM
	WHERE SM.ParentId >0 and (GroupId=1 OR GroupId=10))
		
	SELECT 
		(ROW_NUMBER() OVER(PARTITION BY SMT.PServiceName ORDER BY SMT.RecId ASC)) as SrNo,
		@CompanyName as CompanyName,
		@CAdd AS CAdd,
		CD.ServiceId,
		SMT.ServiceName,
		SMT.PServiceName ,
		SUM(CASE WHEN CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS NewMale,
		SUM(CASE WHEN CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS NewFeMale,
		SUM(CASE WHEN CD.CaseType =2 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS OldMale,
		SUM(CASE WHEN CD.CaseType =2 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS OldFeMale,
		SUM(CASE WHEN CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS TotMale,
		SUM(CASE WHEN CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS TotFeMale,
		@SubTitle AS SubTitle,
		(CASE WHEN @HType=1 THEN 'GENERAL' WHEN @HType=2 THEN 'MCC' WHEN @HType=3 THEN 'COMPLEX' WHEN @HType=4 THEN 'GENERAL' WHEN @HType=5 THEN 'MCC' WHEN @HType=6 THEN 'COMPLEX' ELSE '' END) AS HType,		
		@ReffNo AS ReffNo
	FROM cte AS SMT
	LEFT OUTER JOIN CaseDetail AS CD
	ON SMT.RecId =CD.ServiceId 
	AND CD.CYear =@CYear 
	AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
	AND (CD.HType =@HType OR (@HType=3 AND (CD.HType=1 OR CD.HType=2)) OR (@HType=6 AND (CD.HType=4 OR CD.HType=5)))
	--AND CD.StateId =@StateId	 
	AND CD.CompanyId =@CompanyId
	GROUP BY CD.ServiceId ,SMT.RecId,SMT.ServiceName,SMT.PServiceName 
	ORDER BY SMT.RecId
END
GO
/****** Object:  StoredProcedure [dbo].[RptMonthlySummary]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <10 July 2019>
-- Description:	<omtechsoft.com>
-- =============================================
-- EXECUTE RptMonthlySummary 4,2020,1,15,1,12
-- EXECUTE RptMonthlySummary 4,2019,1,1,1,0
CREATE PROCEDURE [dbo].[RptMonthlySummary]
	@CMonth Int,
	@CYear Int,
	@HType Int, 
	@StateId int,
	@CompanyId Bigint,
	@EMonth Int
AS
BEGIN
	SET NOCOUNT ON;
	DECLARE @Title as nvarchar(200)
	SELECT @Title=Case when @HType < 4 THEN 'SUMMARY OF O.P.D CASES ATTENDANT AND DEATH' ELSE 'SUMMARY OF I.P.D CASES ATTENDANT AND DEATH' END
	
	Declare @NoOfDay as int
	if(@CMonth+@EMonth=0)
	BEGIN
		SELECT @NoOfDay = SUM(MonthTotalDays)
		FROM dbo.MonthDays
	END
	ELSE
	BEGIN
		SELECT @NoOfDay = SUM(MonthTotalDays)
		FROM dbo.MonthDays
		WHERE MonthId >= @CMonth 
		AND MonthId <= @EMonth
		--DECLARE @StartDate as datetime
		--DECLARE @EndDate as datetime
		--SELECT @StartDate= convert(nvarchar(4),@CYear) +'-'+ convert(nvarchar(4),@CMonth) + '-1'
		--SELECT @EndDate= convert(nvarchar(4),@CYear) +'-'+ convert(nvarchar(4),@EMonth) + '-1'
		--SELECT @NoOfDay=DATEDIFF(day,@StartDate,DATEADD(day,-1,DATEADD(month,1,@EndDate)))
		----select @StartDate,DATEADD(day,-1,DATEADD(month,1,@EndDate)),@NoOfDay
	END
	
	Declare @NewCasesM bigint,@NewCasesF bigint,@NewCasesT bigint
		   ,@OldCasesM bigint,@OldCasesF bigint,@OldCasesT bigint
		   ,@MCCasesM bigint,@MCCasesF bigint,@MCCasesT bigint
		   ,@ONMCasesM bigint,@ONMCasesF bigint,@ONMCasesT bigint
		   ,@AVGCasesM Decimal(10,2),@AVGCasesF Decimal(10,2),@AVGCasesT Decimal(10,2)
		   ,@NoofClinicM Decimal(10,2),@NoofClinicF Decimal(10,2),@NoofClinicT Decimal(10,2)
		   ,@NoofDeathM bigint,@NoofDeathF bigint,@NoofDeathT bigint
		   ,@NoofunitM bigint,@NoofunitF bigint,@NoofunitT bigint
		   ,@FatalityM Decimal(10,2),@FatalityF Decimal(10,2),@FatalityT Decimal(10,2)
		   ,@BroughtM bigint,@BroughtF bigint,@BroughtT bigint
		   ,@TotalConsultantOPDM bigint,@TotalConsultantOPDF bigint,@TotalConsultantOPDT bigint
		   ,@AvgNoOfAttClinicClinicSessionM Decimal(10,2),@AvgNoOfAttClinicClinicSessionF Decimal(10,2),@AvgNoOfAttClinicClinicSessionT Decimal(10,2)
		   ,@ParentId bigint,@ParentIdTotalConOPD bigint
		   --,@TTotalConsultantOPD bigint
		   --,@TNoofClinic bigint

	
	SELECT @ParentId = SM.RecId from ServicesMaster AS SM where SM.ServiceName='MISCELLANEOUS'
	SELECT @ParentIdTotalConOPD = SM.RecId from ServicesMaster AS SM where SM.ServiceName='Consultant OPD'

	SELECT 
		@NewCasesM = SUM(CASE WHEN SMT.ParentId<>@ParentId AND CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@NewCasesF =SUM(CASE WHEN SMT.ParentId<>@ParentId AND CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@NewCasesT =SUM(CASE WHEN SMT.ParentId<>@ParentId AND CD.CaseType =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@OldCasesM =SUM(CASE WHEN SMT.ParentId<>@ParentId AND CD.CaseType =2 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@OldCasesF =SUM(CASE WHEN SMT.ParentId<>@ParentId AND CD.CaseType =2 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@OldCasesT =SUM(CASE WHEN SMT.ParentId<>@ParentId AND CD.CaseType =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@MCCasesM =SUM(CASE WHEN SMT.ParentId =@ParentId AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@MCCasesF =SUM(CASE WHEN SMT.ParentId =@ParentId AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@MCCasesT =SUM(CASE WHEN SMT.ParentId =@ParentId THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@ONMCasesM =SUM(CASE WHEN CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@ONMCasesF =SUM(CASE WHEN CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@ONMCasesT =SUM(ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0)),
		@AVGCasesM =CONVERT(DECIMAL(10,2),SUM(CASE WHEN CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END))/CONVERT(DECIMAL(10,2),(CASE WHEN @NoOfDay>0 THEN @NoOfDay ELSE 1 END)),
		@AVGCasesF =CONVERT(DECIMAL(10,2),SUM(CASE WHEN CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END))/CONVERT(DECIMAL(10,2),(CASE WHEN @NoOfDay>0 THEN @NoOfDay ELSE 1 END)),
		@AVGCasesT =CONVERT(DECIMAL(10,2),SUM(ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0)))/CONVERT(DECIMAL(10,2),(CASE WHEN @NoOfDay>0 THEN @NoOfDay ELSE 1 END)),
		@TotalConsultantOPDM = SUM(CASE WHEN CD.Gender =1 AND SMT.ParentId = @ParentIdTotalConOPD THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@TotalConsultantOPDF = SUM(CASE WHEN CD.Gender =2 AND SMT.ParentId = @ParentIdTotalConOPD THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@TotalConsultantOPDT = SUM(CASE WHEN SMT.ParentId = @ParentIdTotalConOPD THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)
	FROM CaseDetail AS CD
	INNER JOIN (
	SELECT 
		SM.RecId ,
		SM.ServiceName,
		(SELECT SM1.ServiceName FROM dbo.ServicesMaster AS SM1 WHERE SM1.RecId =SM.ParentId) AS PServiceName,
		SM.ParentId
	FROM dbo.ServicesMaster AS SM
	WHERE SM.ParentId >0 and (SM.GroupId =1 OR SM.GroupId =10)) SMT
	ON SMT.RecId =CD.ServiceId 
	WHERE CD.CYear =@CYear 
	AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
	AND (CD.HType =@HType OR @HType=3)
	--AND CD.StateId =@StateId 
	AND CD.CompanyId =@CompanyId


	DECLARE @RecIdNoOfClinic bigint,@RecIdNoofDeath bigint
		   ,@RecIdNoofunit bigint,@RecIdBrought bigint
		   
	SELECT @RecIdNoOfClinic = SM.RecId FROM dbo.ServicesMaster AS SM WHERE SM.ServiceName = 'No. of Clinic Sessions Held (Consultant Clinic)'
	SELECT @RecIdNoofDeath = SM.RecId FROM dbo.ServicesMaster AS SM WHERE SM.ServiceName = 'OPD DEATH'
	SELECT @RecIdNoofunit = SM.RecId FROM dbo.ServicesMaster AS SM WHERE SM.ServiceName = 'Total Number of Deaths at Unit'
	SELECT @RecIdBrought = SM.RecId FROM dbo.ServicesMaster AS SM WHERE SM.ServiceName = 'BROUGHT IN DEATHS'

	SELECT @NoofClinicM = CONVERT(DECIMAL(10,2),SUM(CASE WHEN SMT.RecId = @RecIdNoOfClinic AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)),
		   @NoofClinicF = CONVERT(DECIMAL(10,2),SUM(CASE WHEN SMT.RecId = @RecIdNoOfClinic AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)),
		   --@NoofClinicT = CONVERT(DECIMAL(10,2),SUM(CASE WHEN SMT.RecId = @RecIdNoOfClinic THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)),
		   @NoofDeathM =CONVERT(DECIMAL(10,2),SUM(CASE WHEN SMT.RecId = @RecIdNoofDeath AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)),
  		   @NoofDeathF =CONVERT(DECIMAL(10,2),SUM(CASE WHEN SMT.RecId = @RecIdNoofDeath AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)),
		   @NoofDeathT =CONVERT(DECIMAL(10,2),SUM(CASE WHEN SMT.RecId = @RecIdNoofDeath THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)),
		   @NoofunitM =CONVERT(DECIMAL(10,2),SUM(CASE WHEN SMT.RecId = @RecIdNoofunit AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)),
		   @NoofunitF =CONVERT(DECIMAL(10,2),SUM(CASE WHEN SMT.RecId = @RecIdNoofunit AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)),
		   @NoofunitT =CONVERT(DECIMAL(10,2),SUM(CASE WHEN SMT.RecId = @RecIdNoofunit THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)),
		   @BroughtM =CONVERT(DECIMAL(10,2),SUM(CASE WHEN SMT.RecId = @RecIdBrought AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)),
		   @BroughtF =CONVERT(DECIMAL(10,2),SUM(CASE WHEN SMT.RecId = @RecIdBrought AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)),
		   @BroughtT =CONVERT(DECIMAL(10,2),SUM(CASE WHEN SMT.RecId = @RecIdBrought THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END))
	FROM CaseDetail AS CD
	INNER JOIN (
	SELECT 
		SM.RecId ,
		SM.ServiceName,
		(SELECT SM1.ServiceName FROM dbo.ServicesMaster AS SM1 WHERE SM1.RecId =SM.ParentId) AS PServiceName,
		SM.ParentId
	FROM dbo.ServicesMaster AS SM
	WHERE SM.ParentId > 0 and SM.GroupId =15) SMT
	ON SMT.RecId =CD.ServiceId 
	WHERE CD.CYear =@CYear 
	AND ((CMonth >=@CMonth AND CMonth <=@EMonth) OR @CMonth+@EMonth=0)
	AND (CD.HType =@HType OR @HType=3)
	--AND CD.StateId =@StateId 
	AND CD.CompanyId =@CompanyId

	Select @NoofClinicT=CASE WHEN @NoofClinicF>@NoofClinicM THEN @NoofClinicF ELSE @NoofClinicM END
	SELECT @NoofClinicF=null,@NoofClinicM=null

select @AvgNoOfAttClinicClinicSessionM = isnull(@TotalConsultantOPDM,0)/case when isnull(@NoofClinicM,0)>0 then @NoofClinicM else 1 end
		,@AvgNoOfAttClinicClinicSessionF = isnull(@TotalConsultantOPDF,0)/case when isnull(@NoofClinicF,0)>0 then @NoofClinicF else 1 end
		,@AvgNoOfAttClinicClinicSessionT = isnull(@TotalConsultantOPDT,0)/case when isnull(@NoofClinicT,0)>0 then @NoofClinicT else 1 end

select @FatalityM = Convert(decimal(10,2),isnull(@NoofDeathM,0))*100/Convert(decimal(10,2),case when isnull(@NewCasesM,0)>0 then @NewCasesM else 1 end)
		,@FatalityF = Convert(decimal(10,2),isnull(@NoofDeathF,0))*100/Convert(decimal(10,2),case when isnull(@NewCasesF,0)>0 then @NewCasesF else 1 end)
		,@FatalityT = Convert(decimal(10,2),isnull(@NoofDeathT,0))*100/Convert(decimal(10,2),case when isnull(@NewCasesT,0)>0 then @NewCasesT else 1 end)

--select @TTotalConsultantOPD=isnull(@TotalConsultantOPDM,0) + isnull(@TotalConsultantOPDF,0)
--select @TNoofClinic=isnull(@NoofClinicM,0) + isnull(@NoofClinicF,0)

	SELECT	@NewCasesM AS NewCasesM,
			@NewCasesF AS NewCasesF,
			@NewCasesT AS NewCasesT,
			'New Cases' AS ServiceName,
			@Title AS Title
	UNION ALL
	SELECT	@OldCasesM AS OldCasesM,
			@OldCasesF AS OldCasesF, 
			@OldCasesT AS OldCasesT,
			'Old Cases'  AS ServiceName,
			@Title AS Title
	UNION ALL
	SELECT	@MCCasesM AS MCCasesM,
			@MCCasesF AS MCCasesF,	
			@MCCasesT AS MCCasesT,	
			'Miscellanous Cases'  AS ServiceName,
			@Title AS Title
	UNION ALL
	SELECT	@ONMCasesM AS ONMCasesM,
			@ONMCasesF AS ONMCasesF,
			@ONMCasesT AS ONMCasesT,
			'Total attendances(New, Old and Miscellanous Cases)'  AS ServiceName,
			@Title AS Title
	UNION ALL
	SELECT	@AVGCasesM AS AVGCasesM,
			@AVGCasesF AS AVGCasesF,
			@AVGCasesT AS AVGCasesT,
			'Avg. No. of attendances per day'  AS ServiceName,
			@Title AS Title
	UNION ALL
	SELECT	@NoofClinicM AS NoofClinicM,
			@NoofClinicF AS NoofClinicF,	
			@NoofClinicT AS NoofClinicT,	
			'No. Of Clinic Session held (Consultant Clinic)'  AS ServiceName,
			@Title AS Title
	UNION ALL
	SELECT @AvgNoOfAttClinicClinicSessionM AS AvgNoOfAttClinicClinicSessionM
		  ,@AvgNoOfAttClinicClinicSessionF AS AvgNoOfAttClinicClinicSessionF
		  ,@AvgNoOfAttClinicClinicSessiont AS AvgNoOfAttClinicClinicSessionT
		  ,'Avg. No. of attendances per Clinic Session'  AS ServiceName
		  ,@Title AS Title
	UNION ALL
	SELECT	@NoofDeathM AS NoofDeathM,
			@NoofDeathF AS NoofDeathF,
			@NoofDeathT AS NoofDeathT,
			'Total No of Deaths at O.P.D.'  AS ServiceName,
			@Title AS Title
	UNION ALL
	SELECT	@NoofunitM AS NoofunitM,
			@NoofunitF AS NoofunitF,
			@NoofunitT AS NoofunitT,
			'Total No of Death at Unit'  AS ServiceName,
			@Title AS Title
	UNION ALL
	SELECT	@FatalityM AS FatalityM,
			@FatalityF AS FatalityF,
			@FatalityT AS FatalityT,
			'Case Fatality {Death 100% New Case}'  AS ServiceName,
			@Title AS Title
	UNION ALL
	SELECT	@BroughtM AS BroughtM,
			@BroughtF AS BroughtF,
			@BroughtT AS BroughtT,
			'Brought in Death (B.I.D)'  AS ServiceName,
			@Title AS Title

END
GO
/****** Object:  StoredProcedure [dbo].[RptQuarterlyData]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <07 July 2019>
-- Description:	<omtechsoft.com>
-- =============================================
-- EXECUTE [dbo].[RptQuarterlyData] 1,2019,1,1,''
CREATE PROCEDURE [dbo].[RptQuarterlyData]
	@Quarter Int,
	@CYear Int,
	@HType Int, 
	@StateId int,
	@ReffNo Nvarchar(100),
	@CompanyId Bigint
AS
BEGIN
	SET NOCOUNT ON;
	Declare @CompanyName as Nvarchar(500)
	Declare @CAdd as Nvarchar(500)
	Declare @SubTitle as Nvarchar(100)

	SELECT @CompanyName =C.CName,@CAdd =C.City +', ' + S.StateName FROM DBO.CompanyMaster AS C
	INNER JOIN DBO.StateMaster AS S ON C.State =S.RecId 
	WHERE C.RecId =@CompanyId 	

	Declare @SMont Int,@EMonth Int
	SELECT @SMont=(CASE @Quarter WHEN 1 THEN 1 WHEN 2 THEN 5 WHEN 3 THEN 9 END),
	@EMonth=(CASE @Quarter WHEN 4 THEN 1 WHEN 2 THEN 8 WHEN 3 THEN 12 END)
	
	select @SubTitle =CASE WHEN @HType<4 THEN 'OUTPATIENT CASES AND ATTENDANCE' ELSE 'INPATIENT CASES AND ATTENDANCE' END + ' (' + caSE @Quarter WHEN 1 THEN '1st Quarter' WHEN 2 THEN '2nd Quarter' WHEN 3 THEN '3rd Quarter' WHEN 4 THEN '4th Quarter' ELSE '' END + ')'
		
	;with cte as (
	SELECT 
		SM.RecId ,
		SM.ServiceName,
		(SELECT SM1.ServiceName FROM dbo.ServicesMaster AS SM1 WHERE SM1.RecId =SM.ParentId) AS PServiceName
	FROM dbo.ServicesMaster AS SM
	WHERE SM.ParentId >0 and GroupId=1)
	
	
	SELECT 
		(ROW_NUMBER() OVER(PARTITION BY SMT.PServiceName ORDER BY SMT.RecId ASC)) as SrNo,
		@CompanyName as CompanyName,
		@CAdd AS CAdd,
		CD.ServiceId,
		SMT.ServiceName,
		SMT.PServiceName ,
		SUM(CASE WHEN CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS NewMale,
		SUM(CASE WHEN CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS NewFeMale,
		SUM(CASE WHEN CD.CaseType =2 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS OldMale,
		SUM(CASE WHEN CD.CaseType =2 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS OldFeMale,
		SUM(CASE WHEN CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS TotMale,
		SUM(CASE WHEN CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS TotFeMale,
		@SubTitle AS SubTitle,
		(CASE WHEN @HType=1 THEN 'GENERAL' WHEN @HType=2 THEN 'MCC' WHEN @HType=3 THEN 'COMPLEX' WHEN @HType=4 THEN 'GENERAL' WHEN @HType=5 THEN 'MCC' WHEN @HType=6 THEN 'COMPLEX' ELSE '' END) AS HType,		
		@ReffNo AS ReffNo
	FROM cte SMT
	LEFT OUTER JOIN CaseDetail AS CD
	ON SMT.RecId =CD.ServiceId 
	AND CD.CYear =@CYear 
	AND (CD.CMonth >=@SMont AND CD.CMonth <=@EMonth)  
	AND (CD.HType =@HType OR (@HType=3 AND CD.HType=1 AND CD.HType=2) OR (@HType=6 AND CD.HType=4 AND CD.HType=5))
	--AND CD.StateId =@StateId 
	AND CD.CompanyId =@CompanyId
	GROUP BY CD.ServiceId ,SMT.RecId,SMT.ServiceName,SMT.PServiceName 
	ORDER BY SMT.RecId
END
GO
/****** Object:  StoredProcedure [dbo].[RptQuarterlySummary]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <07 July 2019>
-- Description:	<omtechsoft.com>
-- =============================================
-- EXECUTE [dbo].[RptQuarterlySummary] 2,2019,1,1
CREATE PROCEDURE [dbo].[RptQuarterlySummary]
	@Quarter Int,
	@CYear Int,
	@HType Int, 
	@StateId int,
	@CompanyId Bigint
AS
BEGIN
	SET NOCOUNT ON;
	
	DECLARE @Title as nvarchar(200)
	SELECT @Title=Case when @HType < 4 THEN 'SUMMARY OF O.P.D CASES ATTENDANT AND DEATH' ELSE 'SUMMARY OF I.P.D CASES ATTENDANT AND DEATH' END	
	Declare @SMont Int,@EMonth Int
	SELECT @SMont=(CASE @Quarter WHEN 1 THEN 1 WHEN 2 THEN 5 WHEN 3 THEN 9 END),
	@EMonth=(CASE @Quarter WHEN 4 THEN 1 WHEN 2 THEN 8 WHEN 3 THEN 12 END)
	
	DECLARE @StartDate as datetime
	SELECT @StartDate= convert(nvarchar(4),@CYear) +'-'+ convert(nvarchar(4),@SMont) + '-1'
	DECLARE @EndDate as datetime
	SELECT @EndDate= convert(nvarchar(4),@CYear) +'-'+ convert(nvarchar(4),@EMonth) + '-1'
	Declare @NoOfDay as int
	SELECT @NoOfDay=datediff(DAY,@StartDate,DATEADD(day,-1,DATEADD(month,1,@EndDate)))
	--SELECT @NoOfDay
	
	Declare @NewCasesM bigint,@NewCasesF bigint,@OldCasesM bigint,@OldCasesF bigint,
	@MCCasesM bigint,@MCCasesF bigint,@ONMCasesM bigint,@ONMCasesF bigint,
	@AVGCasesM Decimal(10,2),@AVGCasesF Decimal(10,2),@NoofClinicM Decimal(10,2),@NoofClinicF Decimal(10,2),	
	@NoofDeathM bigint,@NoofDeathF bigint,@NoofunitM bigint,@NoofunitF bigint,
	@FatalityM Decimal(10,2),@FatalityF Decimal(10,2),@BroughtM bigint,@BroughtF bigint
	SELECT 
		@NewCasesM = SUM(CASE WHEN CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@NewCasesF =SUM(CASE WHEN CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@OldCasesM =SUM(CASE WHEN CD.CaseType =2 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@OldCasesF =SUM(CASE WHEN CD.CaseType =2 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@MCCasesM =SUM(CASE WHEN SMT.ParentId =28 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@MCCasesF =SUM(CASE WHEN SMT.ParentId =28 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@ONMCasesM =SUM(CASE WHEN CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@ONMCasesF =SUM(CASE WHEN CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@AVGCasesM =SUM(CASE WHEN CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)/(CASE WHEN @NoOfDay>0 THEN 1 ELSE @NoOfDay END),
		@AVGCasesF =SUM(CASE WHEN CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)/(CASE WHEN @NoOfDay>0 THEN 1 ELSE @NoOfDay END),
		@NoofClinicM =SUM(CASE WHEN CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@NoofClinicF =SUM(CASE WHEN CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)
	FROM CaseDetail AS CD
	INNER JOIN (
	SELECT 
		SM.RecId ,
		SM.ServiceName,
		(SELECT SM1.ServiceName FROM dbo.ServicesMaster AS SM1 WHERE SM1.RecId =SM.ParentId) AS PServiceName,
		SM.ParentId
	FROM dbo.ServicesMaster AS SM
	WHERE SM.ParentId >0 AND SM.GroupId =1) SMT
	ON SMT.RecId =CD.ServiceId 
	WHERE CD.CYear =@CYear 
	AND (CD.CMonth >=@SMont AND CD.CMonth <=@EMonth)  
	AND (CD.HType =@HType OR @HType=3)
	--AND CD.StateId =@StateId 
	AND CD.CompanyId =@CompanyId
	
	SELECT 		
		@NoofDeathM =SUM(CASE WHEN CD.ServiceId =47 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@NoofDeathF =SUM(CASE WHEN CD.ServiceId =48 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@NoofunitM =0,
		@NoofunitF =0,
		@FatalityM =Convert(decimal(10,2),isnull(SUM(CASE WHEN CD.ServiceId =47 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),1))/case when @NewCasesM=0 then 1 else @NewCasesM end,
		@FatalityF =Convert(decimal(10,2),isnull(SUM(CASE WHEN CD.ServiceId =48 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),1))/case when @NewCasesF=0 then 1 else @NewCasesF end,
		@BroughtM =0,
		@BroughtF =0
	FROM CaseDetail AS CD
	INNER JOIN (
	SELECT 
		SM.RecId ,
		SM.ServiceName,
		(SELECT SM1.ServiceName FROM dbo.ServicesMaster AS SM1 WHERE SM1.RecId =SM.ParentId) AS PServiceName,
		SM.ParentId
	FROM dbo.ServicesMaster AS SM
	WHERE SM.ParentId >0 AND SM.GroupId =2) SMT
	ON SMT.RecId =CD.ServiceId 
	WHERE CD.CYear =@CYear 
	AND (CD.CMonth >=@SMont AND CD.CMonth <=@EMonth)  
	AND (CD.HType =@HType OR @HType=3)
	--AND CD.StateId =@StateId 
	AND CD.CompanyId =@CompanyId
	
	SELECT @NewCasesM AS NewCasesM,@NewCasesF AS NewCasesF,'New Cases' AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @OldCasesM AS OldCasesM,@OldCasesF AS OldCasesF, 'Old Cases'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @MCCasesM AS MCCasesM,@MCCasesF AS MCCasesF,	'Miscellanous Cases'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @ONMCasesM AS ONMCasesM,@ONMCasesF AS ONMCasesF,'Total attendances(New, Old and Miscellanous Cases)'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @AVGCasesM AS AVGCasesM,@AVGCasesF AS AVGCasesF,'Avg. No. of attendances per day'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @NoofClinicM AS NoofClinicM,@NoofClinicF AS NoofClinicF,	'No. Of Clicnic Sessopn held (Consultant Clinic)'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @NoofClinicM AS NoofClinicM,@NoofClinicF AS NoofClinicF,	'Avg. No. of attendances per Clinic Session'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @NoofDeathM AS NoofDeathM,@NoofDeathF AS NoofDeathF,'Total No of Deaths at O.P.D.'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @NoofunitM AS NoofunitM,@NoofunitF AS NoofunitF,'Total No of Death at Unit'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @FatalityM AS FatalityM,@FatalityF AS FatalityF,'Case Fatality {Death 100% New Case}'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @BroughtM AS BroughtM,@BroughtF AS BroughtF,'Brought in Death (B.I.D)'  AS ServiceName,@Title AS Title
END
GO
/****** Object:  StoredProcedure [dbo].[RptYearlyData]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <07 July 2019>
-- Description:	<omtechsoft.com>
-- =============================================
CREATE PROCEDURE [dbo].[RptYearlyData]	
	@CYear Int,
	@HType Int, 
	@StateId int,
	@ReffNo Nvarchar(100),
	@CompanyId Bigint
AS
BEGIN
	SET NOCOUNT ON;
	Declare @CompanyName as Nvarchar(500)
	Declare @CAdd as Nvarchar(500)
	Declare @SubTitle as Nvarchar(100)
			
	SELECT @CompanyName =C.CName,@CAdd =C.City +', ' + S.StateName FROM DBO.CompanyMaster AS C
	INNER JOIN DBO.StateMaster AS S ON C.State =S.RecId 
	WHERE C.RecId =@CompanyId 	
	
	select @SubTitle =CASE WHEN @HType<4 THEN 'OUTPATIENT CASES AND ATTENDANCE' ELSE 'INPATIENT CASES AND ATTENDANCE' END + ' (' + Convert(nvarchar(4),@CYear) + ')'
	
	;with cte as (
	SELECT 
		SM.RecId ,
		SM.ServiceName,
		(SELECT SM1.ServiceName FROM dbo.ServicesMaster AS SM1 WHERE SM1.RecId =SM.ParentId) AS PServiceName
	FROM dbo.ServicesMaster AS SM
	WHERE SM.ParentId >0 and GroupId=1)
	
	
	SELECT 
		(ROW_NUMBER() OVER(PARTITION BY SMT.PServiceName ORDER BY SMT.RecId ASC)) as SrNo,
		@CompanyName as CompanyName,
		@CAdd AS CAdd,
		CD.ServiceId,
		SMT.ServiceName,
		SMT.PServiceName ,
		SUM(CASE WHEN CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS NewMale,
		SUM(CASE WHEN CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS NewFeMale,
		SUM(CASE WHEN CD.CaseType =2 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS OldMale,
		SUM(CASE WHEN CD.CaseType =2 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS OldFeMale,
		SUM(CASE WHEN CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS TotMale,
		SUM(CASE WHEN CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END) AS TotFeMale,
		@SubTitle as SubTitle,
		(CASE WHEN @HType=1 THEN 'GENERAL' WHEN @HType=2 THEN 'MCC' WHEN @HType=3 THEN 'COMPLEX' WHEN @HType=4 THEN 'GENERAL' WHEN @HType=5 THEN 'MCC' WHEN @HType=6 THEN 'COMPLEX' ELSE '' END) AS HType,		
		@ReffNo AS ReffNo
	FROM cte SMT
	LEFT OUTER JOIN CaseDetail AS CD
	ON SMT.RecId =CD.ServiceId 
	AND CD.CYear =@CYear 
	AND (CD.HType =@HType OR (@HType=3 AND CD.HType=1 AND CD.HType=2) OR (@HType=6 AND CD.HType=4 AND CD.HType=5))
	--AND CD.StateId =@StateId 
	AND CD.CompanyId =@CompanyId
	GROUP BY CD.ServiceId ,SMT.RecId,SMT.ServiceName,SMT.PServiceName 
	ORDER BY SMT.RecId
END
GO
/****** Object:  StoredProcedure [dbo].[RptYearlySummary]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <07 July 2019>
-- Description:	<omtechsoft.com>
-- =============================================
CREATE PROCEDURE [dbo].[RptYearlySummary]	
	@CYear Int,
	@HType Int,
	@StateId int,
	@CompanyId Bigint
AS
BEGIN
	SET NOCOUNT ON;

	DECLARE @Title as nvarchar(200)
	SELECT @Title=Case when @HType < 4 THEN 'SUMMARY OF O.P.D CASES ATTENDANT AND DEATH' ELSE 'SUMMARY OF I.P.D CASES ATTENDANT AND DEATH' END

	DECLARE @StartDate as datetime
	SELECT @StartDate= convert(nvarchar(4),@CYear) +'-'+ convert(nvarchar(4),01) + '-1'
	DECLARE @EndDate as datetime
	SELECT @EndDate= convert(nvarchar(4),@CYear) +'-'+ convert(nvarchar(4),12) + '-1'
	Declare @NoOfDay as int
	SELECT @NoOfDay=datediff(DAY,@StartDate,DATEADD(day,-1,DATEADD(month,1,@EndDate)))
	
	Declare @NewCasesM bigint,@NewCasesF bigint,@OldCasesM bigint,@OldCasesF bigint,
	@MCCasesM bigint,@MCCasesF bigint,@ONMCasesM bigint,@ONMCasesF bigint,
	@AVGCasesM Decimal(10,2),@AVGCasesF Decimal(10,2),@NoofClinicM Decimal(10,2),@NoofClinicF Decimal(10,2),	
	@NoofDeathM bigint,@NoofDeathF bigint,@NoofunitM bigint,@NoofunitF bigint,
	@FatalityM Decimal(10,2),@FatalityF Decimal(10,2),@BroughtM bigint,@BroughtF bigint
	SELECT 
		@NewCasesM = SUM(CASE WHEN CD.CaseType =1 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@NewCasesF =SUM(CASE WHEN CD.CaseType =1 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@OldCasesM =SUM(CASE WHEN CD.CaseType =2 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@OldCasesF =SUM(CASE WHEN CD.CaseType =2 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@MCCasesM =SUM(CASE WHEN SMT.ParentId =28 AND CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@MCCasesF =SUM(CASE WHEN SMT.ParentId =28 AND CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@ONMCasesM =SUM(CASE WHEN CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@ONMCasesF =SUM(CASE WHEN CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@AVGCasesM =SUM(CASE WHEN CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)/(CASE WHEN @NoOfDay>0 THEN 1 ELSE @NoOfDay END),
		@AVGCasesF =SUM(CASE WHEN CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)/(CASE WHEN @NoOfDay>0 THEN 1 ELSE @NoOfDay END),
		@NoofClinicM =SUM(CASE WHEN CD.Gender =1 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END),
		@NoofClinicF =SUM(CASE WHEN CD.Gender =2 THEN ISNULL(Date1,0)+ISNULL(Date2,0)+ISNULL(Date3,0)+ISNULL(Date4,0)+ISNULL(Date5,0)+ISNULL(Date6,0)+ISNULL(Date7,0)+ISNULL(Date8,0)+ISNULL(Date9,0)+ISNULL(Date10,0)+ISNULL(Date11,0)+ISNULL(Date12,0)+ISNULL(Date13,0)+ISNULL(Date14,0)+ISNULL(Date15,0)+ISNULL(Date16,0)+ISNULL(Date17,0)+ISNULL(Date18,0)+ISNULL(Date19,0)+ISNULL(Date20,0)+ISNULL(Date21,0)+ISNULL(Date22,0)+ISNULL(Date23,0)+ISNULL(Date24,0)+ISNULL(Date25,0)+ISNULL(Date26,0)+ISNULL(Date27,0)+ISNULL(Date28,0)+ISNULL(Date29,0)+ISNULL(Date30,0)+ISNULL(Date31,0) ELSE 0 END)		
	FROM CaseDetail AS CD
	INNER JOIN (
	SELECT 
		SM.RecId ,
		SM.ServiceName,
		(SELECT SM1.ServiceName FROM dbo.ServicesMaster AS SM1 WHERE SM1.RecId =SM.ParentId) AS PServiceName,
		SM.ParentId
	FROM dbo.ServicesMaster AS SM
	WHERE SM.ParentId >0 AND SM.GroupId = 1) SMT
	ON SMT.RecId =CD.ServiceId 
	WHERE CD.CYear =@CYear 
	AND (CD.HType =@HType OR @HType=3)
	--AND CD.StateId =@StateId 
	AND CD.CompanyId =@CompanyId
	
	SELECT 
		@NoofDeathM =0,
		@NoofDeathF =0,
		@NoofunitM =0,
		@NoofunitF =0,
		@FatalityM =0.0,
		@FatalityF =0.0,
		@BroughtM =0,
		@BroughtF =0
	FROM CaseDetail AS CD
	INNER JOIN (
	SELECT 
		SM.RecId ,
		SM.ServiceName,
		(SELECT SM1.ServiceName FROM dbo.ServicesMaster AS SM1 WHERE SM1.RecId =SM.ParentId) AS PServiceName,
		SM.ParentId
	FROM dbo.ServicesMaster AS SM
	WHERE SM.ParentId >0 AND SM.GroupId =2) SMT
	ON SMT.RecId =CD.ServiceId 
	WHERE CD.CYear =@CYear 
	AND (CD.HType =@HType OR @HType=3)
	--AND CD.StateId =@StateId 
	AND CD.CompanyId =@CompanyId
	
	SELECT @NewCasesM AS NewCasesM,@NewCasesF AS NewCasesF,'New Cases' AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @OldCasesM AS OldCasesM,@OldCasesF AS OldCasesF, 'Old Cases'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @MCCasesM AS MCCasesM,@MCCasesF AS MCCasesF,	'Miscellanous Cases'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @ONMCasesM AS ONMCasesM,@ONMCasesF AS ONMCasesF,'Total attendances(New, Old and Miscellanous Cases)'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @AVGCasesM AS AVGCasesM,@AVGCasesF AS AVGCasesF,'Avg. No. of attendances per day'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @NoofClinicM AS NoofClinicM,@NoofClinicF AS NoofClinicF,	'No. Of Clicnic Sessopn held (Consultant Clinic)'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @NoofClinicM AS NoofClinicM,@NoofClinicF AS NoofClinicF,	'Avg. No. of attendances per Clinic Session'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @NoofDeathM AS NoofDeathM,@NoofDeathF AS NoofDeathF,'Total No of Deaths at O.P.D.'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @NoofunitM AS NoofunitM,@NoofunitF AS NoofunitF,'Total No of Death at Unit'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @FatalityM AS FatalityM,@FatalityF AS FatalityF,'Case Fatality {Death 100% New Case}'  AS ServiceName,@Title AS Title
	UNION ALL
	SELECT @BroughtM AS BroughtM,@BroughtF AS BroughtF,'Brought in Death (B.I.D)'  AS ServiceName,@Title AS Title
END
GO
/****** Object:  StoredProcedure [dbo].[Web_DeleteDeaths]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <02 July 2019>
-- =============================================
-- Execute Web_DeleteDeaths 1
CREATE PROCEDURE [dbo].[Web_DeleteDeaths]
@RecId bigint
AS
BEGIN
	DELETE dbo.DeathsDetails
	WHERE RecId = @RecId
END
GO
/****** Object:  StoredProcedure [dbo].[Web_DeleteUser]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <02 July 2019>
-- =============================================
-- Execute Web_DeleteUser
CREATE PROCEDURE [dbo].[Web_DeleteUser]
@RecId bigint
AS
BEGIN
	DELETE dbo.UserMaster
	WHERE RecId = @RecId
END
GO
/****** Object:  StoredProcedure [dbo].[Web_ForgotPassword]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Web_ForgotPassword 'superadmin'
CREATE PROCEDURE [dbo].[Web_ForgotPassword]
@UserId nvarchar(50)
AS
BEGIN
	SELECT UM.UserId
		  ,UM.UserName
		  ,UM.EmailId
	FROM dbo.UserMaster AS UM
	WHERE UM.UserId = @UserId
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetAllHosptBEDS]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <23 Sept 2019>
-- Description:	<Get/Save Allocation Of Hospital BEDS.>
-- =============================================
-- EXECUTE Web_GetAllHosptBEDS 1,1,'OMIT-1-PC',10,2019,150
CREATE PROCEDURE [dbo].[Web_GetAllHosptBEDS]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int
AS
BEGIN
SELECT HM.SrNo AS RecId
		,0 AS SMRecId
		,DepartMent As ServiceName
		,HB.Beds
		,HB.Cradles
		,HB.Cots
		,HB.Incubator
		,(isnull(HB.Beds,0) + isnull(HB.Cradles,0) + isnull(HB.Cots,0) + isnull(HB.Incubator,0)) AS Total
		,HB.Admission
		,HB.Dicharge
		,HB.Deaths
	FROM dbo.HospitalBedMaster AS HM
	LEFT OUTER JOIN dbo.HospitalBeds   AS HB
	ON HB.RefSrNo = HM.SrNo 
	AND (HB.CompanyId = @CompanyId)
	--And (HB.StateId = @StateId)
	--And (HB.Machine = @Machine)
	--AND (HM.DepartMent<>'TOTAL')
	And (HB.CMonth = @CMonth)
	And (HB.CYear = @CYear)
	AND (HM.DepartMent<>'TOTAL')
	AND (HB.Htype = @Htype) 
	UNION ALL 
	SELECT 8 AS RecId
		,0 AS SMRecId
		,'TOTAL' As ServiceName
		,SUM(isnull(HB.Beds,0)) AS Beds
		,SUM(isnull(HB.Cradles,0)) AS Cradles
		,SUM(isnull(HB.Cots,0)) AS Cots
		,SUM(isnull(HB.Incubator,0)) AS Incubator
		,SUM(isnull(HB.Beds,0) + isnull(HB.Cradles,0) + isnull(HB.Cots,0) + isnull(HB.Incubator,0)) AS Total
		,SUM(isnull(HB.Admission,0)) AS Admission
		,SUM(isnull(HB.Dicharge,0)) AS Dicharge
		,SUM(isnull(HB.Deaths,0)) AS Deaths
	FROM dbo.HospitalBeds   AS HB
	WHERE (HB.CompanyId = @CompanyId)
	--And (HB.StateId = @StateId)
	--And (HB.Machine = @Machine)
	And (HB.CMonth = @CMonth)
	And (HB.CYear = @CYear)	
	AND (HB.Htype = @Htype)
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetBlindnessPrevProg]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <23 Sept 2019>
-- Description:	<Get Blindess Patient Details.>
-- =============================================
-- execute Web_GetBlindnessPrevProg 1,1,'OMIT-1-PC',10,2019
CREATE PROCEDURE [dbo].[Web_GetBlindnessPrevProg]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int
AS
BEGIN
		SELECT BM.SrNo AS RecId
			,INTERVENSIONS AS ServiceName
			,B.M019
			,B.F019
			,B.M2039
			,B.F2039
			,B.M4059
			,B.F4059
			,B.M6079
			,B.F6079
			,B.M80
			,B.F80
			,(Isnull(B.M019,0)+Isnull(B.M2039,0)+Isnull(B.M4059,0)+Isnull(B.M6079,0)+Isnull(B.M80,0)) AS MTOTAL
			,(Isnull(B.F019,0)+Isnull(B.F2039,0)+Isnull(B.F4059,0)+Isnull(B.F6079,0)+Isnull(B.F80,0)) AS FTOTAL
			,(Isnull(B.M019,0)+Isnull(B.F019,0)+Isnull(B.M2039,0)+Isnull(B.F2039,0)+Isnull(B.M4059,0)+Isnull(B.F4059,0)+Isnull(B.M6079,0)+Isnull(B.F6079,0)+Isnull(B.M80,0)+Isnull(B.F80,0)) AS TOTAL
		FROM dbo.BlindnessMaster AS BM
		LEFT OUTER JOIN dbo.Blindness   AS B
		ON B.RefSrNo = BM.SrNo 
		AND(B.COMPANTID = @CompanyId)
		--AND(B.StateId = @StateId)
		--And (HB.Machine = @Machine)
		AND(B.CMonth = @CMonth)
		AND(B.CYear = @CYear)
		AND(B.Htype = @Htype)
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetCaseDetail]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Web_GetCaseDetail 1,7,2019,1,1,1,4,7,'A'
CREATE PROCEDURE [dbo].[Web_GetCaseDetail]
	@GroupId int,
	@CMonth int,
	@CYear int,
	@HType int,
	@CaseType int,
	@Gender int,
	@StateId bigint,
	@CompanyId bigint,
	@SearchVal nvarchar(5)
AS
BEGIN
	if(@HType<101)
	BEGIN
		SET @SearchVal=''
	END	
	DECLARE @DayDate as datetime
	SELECT @DayDate= convert(nvarchar(4),@CYear) +'-'+ convert(nvarchar(4),@CMonth) + '-1'
	Declare @NoOfDay as int
	SELECT @NoOfDay=Day(DATEADD(day,-1,DATEADD(month,1,@DayDate)))

	SELECT SM.RecId AS OrderId
		  ,0 AS SMRecId
		  ,9999 AS SMParentId
		  ,'TOTAL' AS ServiceName
		  ,0 AS CDRecId
		  ,0 AS CDServiceId
		  ,0 AS Gender
		  ,0 AS CMonth
		  ,0 AS CYear
		  ,0 AS StateId
		  ,0 AS Date1
		  ,0 AS Date2
		  ,0 AS Date3
		  ,0 AS Date4
		  ,0 AS Date5
		  ,0 AS Date6
		  ,0 AS Date7
		  ,0 AS Date8
		  ,0 AS Date9
		  ,0 AS Date10
		  ,0 AS Date11
		  ,0 AS Date12
		  ,0 AS Date13
		  ,0 AS Date14
		  ,0 AS Date15
		  ,0 AS Date16
		  ,0 AS Date17
		  ,0 AS Date18
		  ,0 AS Date19
		  ,0 AS Date20
		  ,0 AS Date21
		  ,0 AS Date22
		  ,0 AS Date23
		  ,0 AS Date24
		  ,0 AS Date25
		  ,0 AS Date26
		  ,0 AS Date27
		  ,0 AS Date28
		  ,0 AS Date29
		  ,0 AS Date30
		  ,0 AS Date31
		  ,NULL AS RowTotal
		  ,0 AS CreatedBy
		  ,0 AS CreateDate
		  ,(Case when @NoOfDay>28 then '' else 'd-none' end) AS VDate29
		  ,(Case when @NoOfDay>29 then '' else 'd-none' end) AS VDate30
		  ,(Case when @NoOfDay>30 then '' else 'd-none' end) AS VDate31
		  ,@NoOfDay+2 as TotDay
	FROM dbo.ServicesMaster AS SM
	LEFT OUTER JOIN dbo.CaseDetail AS CD
	ON SM.RecId = CD.ServiceId
	AND CD.HType=@HType
	AND CD.CaseType = @CaseType
	AND CD.Gender = @Gender
	AND CD.CMonth = @CMonth
	AND CD.CYear = @CYear
	--AND CD.StateId = @StateId
	And CD.CompanyId=@CompanyId
	WHERE (SM.ParentId = 0)
	AND (SM.IsActive = 1)
	AND SM.GroupId=@GroupId
	AND (SM.ServiceName like @SearchVal + '%' OR @SearchVal='')
	
	UNION ALL
	
	SELECT (CASE WHEN SM.ParentId = 0 THEN SM.RecId ELSE SM.ParentId END) AS OrderId
		  ,SM.RecId AS SMRecId
		  ,SM.ParentId AS SMParentId
		  ,left(SM.ServiceName,120) AS ServiceName
		  ,CD.RecId AS CDRecId
		  ,CD.ServiceId AS CDServiceId
		  ,CD.Gender
		  ,CD.CMonth
		  ,CD.CYear
		  ,CD.StateId
		  ,CD.Date1
		  ,CD.Date2
		  ,CD.Date3
		  ,CD.Date4
		  ,CD.Date5
		  ,CD.Date6
		  ,CD.Date7
		  ,CD.Date8
		  ,CD.Date9
		  ,CD.Date10
		  ,CD.Date11
		  ,CD.Date12
		  ,CD.Date13
		  ,CD.Date14
		  ,CD.Date15
		  ,CD.Date16
		  ,CD.Date17
		  ,CD.Date18
		  ,CD.Date19
		  ,CD.Date20
		  ,CD.Date21
		  ,CD.Date22
		  ,CD.Date23
		  ,CD.Date24
		  ,CD.Date25
		  ,CD.Date26
		  ,CD.Date27
		  ,CD.Date28
		  ,CD.Date29
		  ,CD.Date30
		  ,CD.Date31
		  ,NULL AS RowTotal
		  ,CD.CreatedBy
		  ,CD.CreateDate
		  ,(Case when @NoOfDay>28 then '' else 'd-none' end) AS VDate29
		  ,(Case when @NoOfDay>29 then '' else 'd-none' end) AS VDate30
		  ,(Case when @NoOfDay>30 then '' else 'd-none' end) AS VDate31
		  ,@NoOfDay+2 as TotDay
	FROM dbo.ServicesMaster AS SM
	LEFT OUTER JOIN dbo.CaseDetail AS CD
	ON SM.RecId = CD.ServiceId
	AND CD.HType=@HType
	AND CD.CaseType = @CaseType
	AND CD.Gender = @Gender
	AND CD.CMonth = @CMonth
	AND CD.CYear = @CYear
	--AND CD.StateId = @StateId
	And CD.CompanyId=@CompanyId
	WHERE (SM.IsActive = 1)
	AND SM.GroupId=@GroupId 
	AND (SM.ServiceName like @SearchVal + '%' OR @SearchVal='')
	ORDER BY OrderId,SMParentId
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetCausesDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute [Web_GetCausesDrp]
CREATE PROCEDURE [dbo].[Web_GetCausesDrp]
AS
BEGIN
	--SELECT 0 AS RecId,'--All--' AS Causes
	--UNION ALL
		SELECT DISTINCT UM.CausesDeath AS RecId
			  ,UM.CausesDeath AS Causes
		FROM dbo.DeathsDetails AS UM
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetCompanyMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <02 July 2019>
-- =============================================
-- Execute GetCompanyMaster
CREATE PROCEDURE [dbo].[Web_GetCompanyMaster]
@RecId bigint
AS
BEGIN
	SELECT CM.RecId
		  ,CM.CName
		  ,CM.City
		  ,CM.State
		  ,CM.Logo
		  ,CM.Contact
		  ,CM.Email
		  ,CM.CreatedBy
		  ,CM.CreateDate
		  ,CM.Header1
		  ,CM.Header2
		  ,CM.Header3
	FROM dbo.CompanyMaster AS CM
	WHERE CM.RecId = @RecId
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetDeathsList]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Dadu Kamaliya>
-- Create date: <03 August 2019>
-- =============================================
-- Execute Web_GetDeathsList '',22,1,1
CREATE PROCEDURE [dbo].[Web_GetDeathsList]
	@SearchText nvarchar(200),
	@Htype int,
	@StateId bigint,
	@CompanyId bigint
AS
BEGIN
	SELECT UM.RecId
		  ,UM.Decease
		  ,(CASE WHEN UM.Sex = 1 THEN 'Male' WHEN UM.Sex = 2 THEN 'Female' ELSE '' END)AS Sex
		  ,UM.RefNo
		  --,CONVERT(nvarchar,UM.Age,10) + ' Age' AS Age 
		  ,UM.Age
		  ,UM.Address
		  ,CONVERT(NVARCHAR(10),UM.DOA,101) AS DOA
		  ,CONVERT(NVARCHAR(10),UM.DOD,101) AS DOD
		  ,UM.CausesDeath As CausesDeath
		  ,UM.CreatedBy
		  ,UM.CreateDate
		  
			FROM dbo.DeathsDetails AS UM
			WHERE (@SearchText = '' OR UM.Decease LIKE '%' + @SearchText + '%')
			AND
				(@Htype = 0 OR UM.Htype = @Htype)
			--AND (UM.StateId = @StateId)
			AND
				(UM.CompanyId = @CompanyId)	 
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetDeathsMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Web_GetDeathsMaster 1
CREATE PROCEDURE [dbo].[Web_GetDeathsMaster]
@RecId bigint
AS
BEGIN
	SELECT UM.RecId
		  ,UM.Htype
		  ,UM.Decease
		  ,UM.Age
		  ,UM.Sex
		  ,UM.RefNo
		  ,CONVERT(NVARCHAR(10),UM.DOA,101) AS DOA
		  ,CONVERT(NVARCHAR(10),UM.DOD,101) AS DOD
		  ,UM.Address
		  ,UM.CompanyId
		  ,UM.StateId
		  ,UM.CausesDeath
		  ,UM.CreatedBy
		  ,UM.CreateDate
	FROM [dbo].[DeathsDetails] AS UM
	WHERE (UM.RecId = @RecId)
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetDentalProcedure]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <23 Sept 2019>
-- Description:	<GET DENTAL PROCEDURE>
-- =============================================
-- execute [Web_GetDentalProcedure] 1,1,'OMIT-1-PC',10,2019,160
CREATE PROCEDURE [dbo].[Web_GetDentalProcedure]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int
AS
BEGIN
	SELECT DM.SrNo As RecId
	   ,[DProcedure] As ServiceName
       ,D.[M012]
       ,D.[F012]
       ,D.[M1359]
       ,D.[F1359]
       ,D.[M60]
       ,D.[F60]
       ,(IsNull(D.[M012],0) +IsNull(D.[M1359],0)+IsNull(D.[M60],0)) AS [Mtot]
       ,(IsNull(D.[F012],0)+IsNull(D.[F1359],0)+IsNull(D.[F60],0)) AS [Ftot]
       --,(IsNull(D.[M012],0) +IsNull(D.[F012],0)+IsNull(D.[M1359],0)+IsNull(D.[F1359],0)+IsNull(D.[M60],0)+IsNull(D.[F60],0)) AS Total
     FROM dbo.DentalMaster AS DM
     LEFT OUTER JOIN Dental AS D
     ON D.RefSrNo = DM.SrNo
     AND(D.CompanyId = @CompanyId)
	 --AND(D.StateId = @StateId)
	 --And (D.Machine = @Machine)
	 AND(D.CMonth = @CMonth)
	 AND(D.CYear = @CYear)
	 AND(D.Htype = @Htype)
	 --Group By DM.SrNo,DM.DProcedure
	 
	UNION ALL
	SELECT 25 As RecId
	   ,'TOTAL' As ServiceName
       ,SUM(isnull(D.[M012],0)) AS M012 
       ,SUM(isnull(D.[F012],0)) AS F012
       ,SUM(isnull(D.[M1359],0)) AS M1359
       ,SUM(isnull(D.[F1359],0)) AS F1359 
       ,SUM(isnull(D.[M60],0)) AS M60
       ,SUM(isnull(D.[F60],0)) AS F60
       ,SUM(IsNull(D.[M012],0) +IsNull(D.[M1359],0)+IsNull(D.[M60],0)) AS [Mtot]
       ,SUM(IsNull(D.[F012],0)+IsNull(D.[F1359],0)+IsNull(D.[F60],0)) AS [Ftot]
       --,SUM(IsNull(D.[M012],0) +IsNull(D.[F012],0)+IsNull(D.[M1359],0)+IsNull(D.[F1359],0)+IsNull(D.[M60],0)+IsNull(D.[F60],0)) AS Total
     FROM Dental AS D
     WHERE (D.CompanyId = @CompanyId)
	 --AND(D.StateId = @StateId)
	 --And (D.Machine = @Machine)
	 AND(D.CMonth = @CMonth)
	 AND(D.CYear = @CYear)
	 AND(D.Htype = @Htype)
	 
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetForgotTrans]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<DK>
-- Create date: <17 Jan 2019>
-- =============================================
-- Execute Web_GetForgotTrans 'FC3596DD-52FA-44B0-9F4B-676652C8F6DF'
CREATE PROCEDURE [dbo].[Web_GetForgotTrans]
@Key nvarchar(100)
AS
BEGIN
	SELECT OM.RECID
		  ,OM.USERID
		  ,OM.USERNAME
		  ,OM.OTP
		  ,OM.MACHINENAME
		  ,OM.ISSUCCESS
		  ,OM.EMAILID
		  ,OM.CREATEDDATE
	FROM dbo.OTPMASTER AS OM
	WHERE OM.OTP = @Key
	AND OM.ISSUCCESS = 0
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetHospitalDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Web_GetHospitalDrp 1
CREATE PROCEDURE [dbo].[Web_GetHospitalDrp]
@UserId Bigint
AS
BEGIN
	Declare @CompanyId as bigint
	SELECT @CompanyId=CompanyId From dbo.UserMaster Where RecId =@UserId 
	--if(@CompanyId=-1)
	--	BEGIN
			--SET @CompanyId=-1	
				SELECT 0 AS RecId,'--SELECT--' AS CName
				UNION ALL
				SELECT UM.RecId
					  ,UM.CName
				FROM dbo.CompanyMaster AS UM
				WHERE UM.IsActive=1 AND (@CompanyId=-1 OR @CompanyId=UM.RecId)
	--	END
	--ELSE
	--	BEGIN
	--		SELECT UM.RecId
	--			  ,UM.CName
	--			FROM dbo.CompanyMaster AS UM
	--			WHERE UM.IsActive=1 AND (@CompanyId=UM.RecId)
	--	END
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetHospitalDrpReport]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Web_GetHospitalDrpReport -1,3
CREATE PROCEDURE [dbo].[Web_GetHospitalDrpReport]
@CompanyId Bigint,
@userType Bigint
AS
BEGIN
	if(@userType=3)  SET @CompanyId=0
	if(@CompanyId>0)
	BEGIN
		SELECT UM.RecId
			  ,UM.CName
		FROM dbo.CompanyMaster AS UM
		WHERE UM.IsActive=1 AND (RecId =@CompanyId OR @CompanyId=-1)
	END
	ELSE
	BEGIN		
		SELECT UM.RecId
			  ,UM.CName
		FROM dbo.CompanyMaster AS UM
		WHERE UM.IsActive=1
	END
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetHospitalDrpReportV1]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Web_GetHospitalDrpReportV1
CREATE PROCEDURE [dbo].[Web_GetHospitalDrpReportV1]

AS
BEGIN
	SELECT 0 AS RecId,'ALL' AS CName,0 AS SrtOrder
	UNION ALL
	SELECT CM.RecId,CM.CName,1 AS SrtOrder
	FROM dbo.CompanyMaster AS CM
	WHERE CM.IsActive = 1
	ORDER BY SrtOrder,CName
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetHospitalList]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Web_GetHospitalList ''
CREATE PROCEDURE [dbo].[Web_GetHospitalList]
@SearchText nvarchar(200)
AS
BEGIN
	SELECT UM.RecId
		  ,UM.CName
		  ,UM.City
		  ,UM.State
		  ,(select StateName FROM dbo.StateMaster WHERE RecId = UM.State) As StateName
		  ,UM.Contact
		  ,UM.Email
		  ,UM.CGuid
		  ,UM.Logo
		  ,UM.IsActive
		  ,(Case When UM.IsActive =1 THEN 'Active' Else 'DeActive' End) AS IsActive_W
		  ,(Case When UM.IsActive = 1 THEN 'far fa-check-circle mr-1' Else 'far fa-times-circle mr-1' END) AS IsActiveCss_W
	FROM dbo.CompanyMaster AS UM
	WHERE (@SearchText = ''
	OR UM.CName LIKE '%' + @SearchText + '%'
	OR UM.Contact LIKE '%' + @SearchText + '%'
	OR UM.CGuid LIKE '%' + @SearchText + '%'
	OR UM.City LIKE '%' + @SearchText + '%'
	OR UM.State LIKE '%' + @SearchText + '%'
	OR UM.Email LIKE '%' + @SearchText + '%')
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetLiveBirthWeight]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <28 Sept 2019>
-- Description:	<Get Live Birth Weight Data.>
-- =============================================
-- execute web_GetLiveBirthWeight 1,1,'OMIT-2',10,2019
CREATE PROCEDURE [dbo].[Web_GetLiveBirthWeight]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int
AS
BEGIN
	SELECT LM.SrNo As RecId
		,LM.LiveBirthWeight As ServiceName
		,LW.Male
		,LW.Female 
	FROM dbo.LiveBirthWeightMaster AS LM
	LEFT OUTER JOIN LiveBirthWeight AS LW
	ON LW.RefSrno = LM.SrNo
	AND(LW.CompanyId = @CompanyId)
	--AND(LW.StateId = @StateId)
	--And (HB.Machine = @Machine)
	AND(LW.CMonth = @CMonth)
	AND(LW.CYear = @CYear)
	AND(LW.Htype = @Htype) 
	
	UNION ALL
	SELECT 14 As RecId
		,'TOTAL' As ServiceName
		,SUM(isnull(LW.Male,0)) AS Male
		,SUM(isnull(LW.Female,0)) AS Female
	FROM dbo.LiveBirthWeight AS LW
	WHERE (LW.CompanyId = @CompanyId)
	--AND(LW.StateId = @StateId)
	AND(LW.CMonth = @CMonth)
	AND(LW.CYear = @CYear)
	AND(LW.Htype = @Htype)
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetLogin]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Web_GetLogin 'admin','admin'
-- Execute [Web_GetLogin] 'superadmin','superadmin'
CREATE PROCEDURE [dbo].[Web_GetLogin]
@UserId nvarchar(50),
@PWD nvarchar(50)
AS
BEGIN
	DECLARE @StateId AS BIGINT
	DECLARE @StateName AS NVARCHAR(200)	
	
	
	
	SELECT UM.RecId
		  ,UM.UserId
		  ,UM.PWD
		  ,UM.UserName
		  ,UM.State AS StateId
		  ,(SELECT TOP 1 SM.StateName FROM dbo.StateMaster AS SM WHERE SM.RecId = UM.state) AS StateName
		  ,CONVERT(NVARCHAR(10),UM.DOB,101) AS DOB
		  ,(CASE WHEN UM.Gender = 1 THEN 'Male' WHEN UM.Gender = 2 THEN 'Female' ELSE '' END)AS Gender
		  ,UM.EmailId
		  ,UM.Contact
		  ,UM.UserType
		  ,UM.IsActive
		  ,UM.CompanyId
	FROM dbo.UserMaster AS UM
	WHERE (UM.UserId = @UserId)
		   AND
		  (UM.PWD = @PWD)
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetMaternalHealth]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <28 Sept 2019>
-- Description:	<Get Maternal Health Data.>
-- =============================================
-- execute [Web_GetMaternalHealth] 1,1,'',10,2019,165
CREATE PROCEDURE [dbo].[Web_GetMaternalHealth]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int
AS
BEGIN
	SELECT MM.[SrNo] As RecId
	  ,CASE WHEN MM.[SrNo] in (19) THEN REPLACE(MM.[Description],' ','&nbsp;')
			WHEN MM.[SrNo] in (20,21,22,35) THEN '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + REPLACE(MM.[Description],' ','&nbsp;')
			ELSE MM.[Description] END AS ServiceName
      ,MH.[Result]
	  ,MM.SortOrder
    FROM [dbo].[MaternalHealthMaster] AS MM
    LEFT OUTER JOIN  MaternalHealth AS MH
    ON MH.RefSrNo = MM.SrNo
    AND(MH.CompanyId = @CompanyId)
	--AND(MH.StateId = @StateId)
	--And (HB.Machine = @Machine)
	AND(MH.CMonth = @CMonth)
	AND(MH.CYear = @CYear)
	AND(MH.Htype = @Htype)
	UNION ALL
	SELECT 36 As RecId
	  ,'Total' AS ServiceName
      ,SUM(isnull(MH.[Result],0)) AS Result
	  ,36 AS SortOrder
    FROM MaternalHealth AS MH    
    WHERE (MH.CompanyId = @CompanyId)
	--AND(MH.StateId = @StateId)	
	AND(MH.CMonth = @CMonth)
	AND(MH.CYear = @CYear)
	AND(MH.Htype = @Htype)
	order by SortOrder
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetMonthDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <30 June 2019>
-- =============================================
-- Execute Web_GetMonthDrp
CREATE PROCEDURE [dbo].[Web_GetMonthDrp]

AS
BEGIN
	SELECT 'January' AS MontName,1 AS MonthId
	UNION ALL
	SELECT 'February' AS MontName,2 AS MonthId
	UNION ALL
	SELECT 'March' AS MontName,3 AS MonthId
	UNION ALL
	SELECT 'April' AS MontName,4 AS MonthId
	UNION ALL
	SELECT 'May' AS MontName,5 AS MonthId
	UNION ALL
	SELECT 'June' AS MontName,6 AS MonthId
	UNION ALL
	SELECT 'July' AS MontName,7 AS MonthId
	UNION ALL
	SELECT 'August' AS MontName,8 AS MonthId
	UNION ALL
	SELECT 'September' AS MontName,9 AS MonthId
	UNION ALL
	SELECT 'October' AS MontName,10 AS MonthId
	UNION ALL
	SELECT 'November' AS MontName,11 AS MonthId
	UNION ALL
	SELECT 'December' AS MontName,12 AS MonthId	
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetPatientAdmitOutcomes]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <23 Sept 2019>
-- Description:	<Patient Hospital InCome - Outcome>
-- =============================================
-- execute [Web_GetPatientAdmitOutcomes] 1,1,'',2,2020,150
CREATE PROCEDURE [dbo].[Web_GetPatientAdmitOutcomes]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int
AS
BEGIN
	Declare @Days as int
	SELECT @Days =MD.MonthTotalDays From [dbo].[MonthDays] AS MD 
	Where MD.MonthId =@CMonth 


	SELECT IM.SRNO AS RecId
		  ,0 AS SMRecId	
		  ,IM.BEDCOMPLEMENT As ServiceName
		  ,IC.MALE
		  ,IC.FEMALE
		  ,(isnull(IC.MALE,0) + isnull(IC.FEMALE,0)) AS TOTAL 
		  ,@Days AS 'Days'
	FROM dbo.IPDOutcomeMaster AS IM
	LEFT OUTER JOIN dbo.IPDOutcome AS IC
	ON IC.RefSrNo = IM.SrNo 
	AND (IC.CompanyId = @CompanyId)
	--And (IC.StateId = @StateId)
	--And (HB.Machine = @Machine)
	And (IC.CMonth = @CMonth)
	And (IC.CYear = @CYear)
	AND (IC.Htype = @Htype)
	
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetPermission]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <10 Aug 2019>
-- =============================================
-- Execute Web_GetPermission 0
-- Execute Web_GetPermission 1
-- Execute Web_GetPermission 2
CREATE PROCEDURE [dbo].[Web_GetPermission]
@TypeId bigint
AS
BEGIN
	SELECT PM.MenuId,isnull(MM.PMenuId,0) AS PMenuId
	FROM dbo.PermissionMaster AS PM
	INNER JOIN DBO.MenuMaster AS MM
	ON MM.MenuId =PM.MenuId 
	WHERE PM.TypeId = @TypeId 
	AND PM.IsActive =1 and MM.IsActive =1
	--and PM.MenuId =65
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetQuarterlyDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <30 June 2019>
-- =============================================
-- Execute Web_GetQuarterlyDrp
Create PROCEDURE [dbo].[Web_GetQuarterlyDrp]

AS
BEGIN
	SELECT '1st Quarter' AS QuarterName,1 AS QuarterId
	UNION ALL
	SELECT '2nd Quarter' AS QuarterName,2 AS QuarterId
	UNION ALL
	SELECT '3rd Quarterly' AS QuarterName,3 AS QuarterId
	
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetServicesDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Web_GetServicesDrp
CREATE PROCEDURE [dbo].[Web_GetServicesDrp]

AS
BEGIN
	SELECT 0 AS RecId,'--Select--' AS ServiceName
	UNION ALL
	SELECT RecId,ServiceName
	FROM dbo.ServicesMaster
	WHERE (IsActive = 1)
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetServicesList]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Web_GetServicesList ''
CREATE PROCEDURE [dbo].[Web_GetServicesList]
@SearchText nvarchar(200)
AS
BEGIN
	SELECT SM.RecId
		  ,SM.ParentId
		  ,SM.ServiceName
		  ,ISNULL((SELECT SM1.ServiceName
		   FROM dbo.ServicesMaster AS SM1
		   WHERE SM1.RecId = SM.ParentId),'') AS ParentServiceName
		  ,SM.Description
		  ,SM.SortOrd
		  ,SM.IsActive
		  ,SM.CreatedBy
		  ,SM.CreateDate
		  ,(Case When SM.IsActive =1 THEN 'Active' Else 'DeActive' End) AS IsActive_W
		  ,(Case When SM.IsActive = 1 THEN 'far fa-check-circle mr-1' Else 'far fa-times-circle mr-1' END) AS IsActiveCss_W
	FROM dbo.ServicesMaster AS SM
	WHERE (@SearchText = ''
	OR SM.ServiceName LIKE '%' + @SearchText + '%'
	OR SM.Description LIKE '%' + @SearchText + '%')
	ORDER BY SM.SortOrd
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetServicesMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Web_GetServicesMaster 1
CREATE PROCEDURE [dbo].[Web_GetServicesMaster]
@RecId bigint
AS
BEGIN
	SELECT SM.RecId
		  ,SM.ParentId
		  ,SM.ServiceName
		  ,SM.Description
		  ,SM.SortOrd
		  ,SM.IsActive
		  ,SM.CreatedBy
		  ,SM.CreateDate
	FROM dbo.ServicesMaster AS SM
	WHERE SM.RecId = @RecId
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetStateDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute GetStateDrp
CREATE PROCEDURE [dbo].[Web_GetStateDrp]

AS
BEGIN
	SELECT 0 AS RecId,'--Select--' AS StateName
	UNION ALL
	SELECT RecId,StateName
	FROM dbo.StateMaster
	WHERE (IsActive = 1)
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetStateList]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Web_GetStateList ''
CREATE PROCEDURE [dbo].[Web_GetStateList]
@SearchText nvarchar(200)
AS
BEGIN
	SELECT ST.RecId
		  ,ST.StateName
		  ,ST.Description
		  ,ST.IsActive
		  ,ST.CreatedBy
		  ,(Case When ST.IsActive =1 THEN 'Active' Else 'DeActive' End) AS IsActive_W
		  ,(Case When ST.IsActive = 1 THEN 'far fa-check-circle mr-1' Else 'far fa-times-circle mr-1' END) AS IsActiveCss_W
		  ,ST.CreateDate
	FROM dbo.StateMaster AS ST
	WHERE (@SearchText = ''
	OR ST.StateName LIKE '%' + @SearchText + '%'
	OR ST.Description LIKE '%' + @SearchText + '%')
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetStateMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Web_GetStateMaster 1
CREATE PROCEDURE [dbo].[Web_GetStateMaster]
@RecId bigint
AS
BEGIN
	SELECT ST.RecId
		  ,ST.StateName
		  ,ST.Description
		  ,ST.IsActive
		  ,ST.CreatedBy
		  ,ST.CreateDate
	FROM dbo.StateMaster AS ST
	WHERE ST.RecId = @RecId
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetUserList]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Web_GetUserList '',1
CREATE PROCEDURE [dbo].[Web_GetUserList]
@SearchText nvarchar(200),
@UserId Bigint
AS
BEGIN
	
	Declare @CompanyId as bigint
	Declare @UserType as bigint
	SELECT @UserType=UserType,@CompanyId=CompanyId From dbo.UserMaster Where RecId =@UserId 
	if(@UserType=1)
	BEGIN
		SET @CompanyId=-1	
	END

	SELECT UM.RecId
		  ,UM.UserId
		  ,UM.PWD
		  ,UM.UserName
		  ,CONVERT(NVARCHAR(10),UM.DOB,101) AS DOB
		  ,(CASE WHEN UM.Gender = 1 THEN 'Male' WHEN UM.Gender = 2 THEN 'Female' ELSE '' END)AS Gender
		  ,UM.EmailId
		  ,UM.Contact
		  ,UM.Address
		  ,UM.City
		  ,UM.State
		  ,UM.ZipCode
		  ,UM.ProfilePic
		  ,UM.UserType
		  ,(SELECT TOP 1 UTM.TypeName FROM dbo.UserTypeMaster AS UTM WHERE UTM.TypeId = UM.UserType) AS UserTypeName
		  ,UM.IsActive
		  ,(Case When UM.IsActive =1 THEN 'Active' Else 'DeActive' End) AS IsActive_W
		  ,(Case When UM.IsActive = 1 THEN 'far fa-check-circle mr-1' Else 'far fa-times-circle mr-1' END) AS IsActiveCss_W
		  ,UM.CompanyId
		  --,(select CName from dbo.CompanyMaster where RecId=UM.CompanyId) As CompanyName
		  ,(CASE WHEN UM.CompanyId = 0 THEN 'All' ELSE (select CName from dbo.CompanyMaster where RecId=UM.CompanyId) END) AS CompanyName
		  ,UM.CreatedBy
		  ,UM.CreateDate
		  
	FROM dbo.UserMaster AS UM
	WHERE (@SearchText = ''
	OR UM.UserId LIKE '%' + @SearchText + '%'
	OR UM.UserName LIKE '%' + @SearchText + '%'
	OR UM.EmailId LIKE '%' + @SearchText + '%'
	OR UM.Contact LIKE '%' + @SearchText + '%'
	OR UM.Address LIKE '%' + @SearchText + '%'
	OR UM.City LIKE '%' + @SearchText + '%'
	OR UM.State LIKE '%' + @SearchText + '%'
	OR UM.ZipCode LIKE '%' + @SearchText + '%')
	AND (@CompanyId=-1 OR @CompanyId=UM.CompanyId)
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetUserMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Web_GetUserMaster 1
CREATE PROCEDURE [dbo].[Web_GetUserMaster]
@RecId bigint
AS
BEGIN
	SELECT UM.RecId
		  ,UM.UserId
		  ,UM.PWD
		  ,UM.UserName
		  ,CONVERT(NVARCHAR(10),UM.DOB,101) AS DOB
		  ,UM.Gender
		  ,UM.EmailId
		  ,UM.Contact
		  ,UM.Address
		  ,UM.City
		  ,UM.State
		  ,UM.ZipCode
		  ,UM.CompanyId
		  ,UM.ProfilePic
		  ,UM.UserType
		  ,UM.IsActive
		  ,UM.CreatedBy
		  ,UM.CreateDate
	FROM dbo.UserMaster AS UM
	WHERE (UM.RecId = @RecId)
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetUserPermission]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <10 Aug 2019>
-- =============================================
-- Execute Web_GetUserPermission 0
-- Execute Web_GetUserPermission 1
-- Execute Web_GetUserPermission 2
CREATE PROCEDURE [dbo].[Web_GetUserPermission]
@TypeId bigint
AS
BEGIN
	SELECT MM.MenuName
		  ,MM.MenuId
		  ,ISNULL(PM.IsActive,0) AS PMIsActive
		  ,PM.IsActive AS PMIsActive
		  ,MM.RecId AS MMRecId
		  ,ISNULL(PM.RecId,0) AS PMRecId
	FROM dbo.MenuMaster AS MM
	LEFT OUTER JOIN dbo.PermissionMaster AS PM
	ON MM.MenuId = PM.MenuId AND PM.TypeId = @TypeId 
	WHERE @TypeId <> 0 
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetUserTypeDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <10 Aug 2019>
-- =============================================
-- Execute Web_GetUserTypeDrp 2
CREATE PROCEDURE [dbo].[Web_GetUserTypeDrp]
@TypeId bigint
AS
BEGIN
	SELECT 0 AS TypeId,'-- Select --' AS TypeName
	UNION ALL
	SELECT UT.TypeId,UT.TypeName
	FROM dbo.UserTypeMaster AS UT
	WHERE UT.IsActive = 1
	AND ((@TypeId=2 AND (UT.TypeId=2 OR UT.TypeId =4))
	OR (@TypeId=3 AND UT.TypeId=3)
	OR (@TypeId=1 AND (UT.TypeId =1 OR UT.TypeId =2 OR UT.TypeId =3 OR UT.TypeId =4))
	OR (UT.TypeId = @TypeId))
	
END
GO
/****** Object:  StoredProcedure [dbo].[Web_GetYearDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <30 June 2019>
-- =============================================
-- Execute GetYearDrp
CREATE PROCEDURE [dbo].[Web_GetYearDrp]

AS
BEGIN
	;WITH CTE
	AS
	(
		SELECT YearID = 2018
		UNION ALL
		SELECT YearID = YearID + 1
		FROM CTE WHERE YearID < YEAR(GETDATE())
	)
	SELECT YearID AS YearName,YearID
	FROM CTE
END
GO
/****** Object:  StoredProcedure [dbo].[Web_SaveBlindnessPrevProg]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <01 Oct 2019>
-- =============================================
-- execute [Web_SaveBlindnessPrevProg] 1,0,1,1,9,2019,'Cradles',7,2
CREATE PROCEDURE [dbo].[Web_SaveBlindnessPrevProg]
	@RecId bigint,
	@ServiceId bigint,
	@CompanyId bigint,
	@StateId bigint,
	--@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@CDay nvarchar(100),
	@CVal int,
	@CreatedBy bigint,
	@Htype int
	
AS
BEGIN

	DECLARE @COMID AS BIGINT
	SELECT @COMID=CompanyId FROM dbo.UserMaster WHERE RecId =@CreatedBy
	DECLARE @MACHINE AS NVARCHAR(120)
	SELECT @MACHINE=HOST_NAME()
	DECLARE @Q AS NVARCHAR(Max)
	IF (@RecId > 0)
	/*BEGIN
	   SELECT @Q=N'Update [dbo].[HospitalBeds] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE SrNo ='+ convert(nvarchar(10),@RecId) +'and CompanyId='+convert(nvarchar(10),@COMID) 
	END*/
	--AND CD.StateId=@StateId 
	IF EXISTS(SELECT 1 FROM DBO.Blindness AS CD WHERE CD.RefSrNo =@RecId AND CD.CYear =@CYear AND CD.CMonth =@CMonth AND CD.COMPANTID=@COMID AND CD.Htype = @Htype)
	BEGIN
	--+ ' AND StateId=' + convert(nvarchar(10),@StateId) 
	SELECT @Q=N'Update [dbo].[Blindness] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE RefSrNo =' + convert(nvarchar(10),@RecId) + ' AND CYear = ' + convert(nvarchar(10),@CYear) + ' AND CMonth = ' + convert(nvarchar(10),@CMonth) + ' AND COMPANTID=' + convert(nvarchar(10),@COMID) + 'AND Htype = ' + convert(nvarchar(10),@Htype) 
	END
	ELSE
	BEGIN
	   SELECT @Q=N'INSERT INTO [dbo].[Blindness]([RefSrNo],[ServiceId],[COMPANTID],[StateId],[CMonth],[CYear],['+ @CDay +'],[CreatedBy],[Machine],[Htype])VALUES ('+ convert(nvarchar(10),@RecId) +','+ convert(nvarchar(10),@ServiceId) +','+ convert(nvarchar(10),@CompanyId) +','+ convert(nvarchar(10),@StateId) + ',' + convert(nvarchar(10),@CMonth) +','+ convert(nvarchar(10),@CYear) + ',' + convert(nvarchar(10),@CVal) + ',' + convert(nvarchar(10),@CreatedBy) + ',''' + @MACHINE + ''',' + CONVERT(nvarchar(10),@Htype) +')'	
	END
	EXECUTE(@Q)
	--PRINT(@Q)
END
GO
/****** Object:  StoredProcedure [dbo].[Web_SaveCaseDetail]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <01 July 2019>
-- =============================================
-- Execute Web_SaveCaseDetail 0,2,1,1,07,2019,'Date1',1,1,1
/*
Execute Web_SaveCaseDetail 0,1,1,1,1,7,2019,'Date13',0,4,1
{"RecId":0,"ServiceId":1,"HType":1,"CaseType":1,"Gender":1,"CMonth":7,"CYear":2019,"CDay":13,"CVal":0,"CreatedBy":4,"StateId":1}
*/
CREATE PROCEDURE [dbo].[Web_SaveCaseDetail]
@RecId bigint,
@ServiceId bigint,
@CaseType int,
@HType int,
@Gender int,
@CMonth int,
@CYear int,
@CDay nvarchar(100),
@CVal int,
@CreatedBy bigint,
@StateId bigint
AS
BEGIN

	DECLARE @COMID AS BIGINT
	SELECT @COMID=CompanyId FROM dbo.UserMaster WHERE RecId =@CreatedBy
	DECLARE @MACHINE AS NVARCHAR(120)
	SELECT @MACHINE=HOST_NAME()
	DECLARE @Q AS NVARCHAR(Max)
	IF (@RecId > 0)
	BEGIN
		SELECT @Q=N'Update [dbo].[CaseDetail] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE RecId ='+ convert(nvarchar(10),@RecId) +'and CompanyId='+convert(nvarchar(10),@COMID) 
	END
	--AND CD.StateId=@StateId 
	ELSE IF EXISTS(SELECT 1 FROM DBO.CaseDetail AS CD WHERE CD.ServiceId =@ServiceId AND CD.CYear =@CYear AND CD.CMonth =@CMonth AND CD.HType =@HType AND CD.CaseType=@CaseType AND CD.Gender=@Gender AND CD.CompanyId=@COMID)
	BEGIN
	--+ ' AND StateId=' + convert(nvarchar(10),@StateId) 
		SELECT @Q=N'Update [dbo].[CaseDetail] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE ServiceId =' + convert(nvarchar(10),@ServiceId) + ' AND CYear = ' + convert(nvarchar(10),@CYear) + ' AND CMonth = ' + convert(nvarchar(10),@CMonth) + ' AND CaseType=' + convert(nvarchar(10),@CaseType) +' AND Gender=' + convert(nvarchar(10),@Gender) + ' AND HType=' + convert(nvarchar(10),@HType) + ' AND CompanyId=' + convert(nvarchar(10),@COMID)
	END
	ELSE
	BEGIN
		SELECT @Q=N'INSERT INTO [dbo].[CaseDetail]([ServiceId],[HType],[CaseType],[Gender],[CMonth],[CYear],[CreatedBy],['+ @CDay +'],[StateId],[CompanyId],[Machine])VALUES ('+ convert(nvarchar(10),@ServiceId) +','+ convert(nvarchar(10),@HType) +','+ convert(nvarchar(10),@CaseType) + ',' + convert(nvarchar(10),@Gender) + ',' + convert(nvarchar(10),@CMonth) +','+ convert(nvarchar(10),@CYear) + ',' + convert(nvarchar(10),@CreatedBy) + ',' + convert(nvarchar(10),@CVal) + ',' + convert(nvarchar(10),@StateId) +',' + CONVERT(nvarchar(20),@COMID) + ',''' + @MACHINE + ''')'
	END
	EXECUTE(@Q)
	--PRINT(@Q)
END
GO
/****** Object:  StoredProcedure [dbo].[Web_SaveCompanyMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <02 July 2019>
-- =============================================
-- Execute Web_SaveCompanyMaster 3,'sdsdffsdf-ABCD','sdfsfdsfsf@gmail.com',17,'1234567890','sdfsfdsfsf@gmail.com',1,'',1,'test1','test2','test3'
CREATE PROCEDURE [dbo].[Web_SaveCompanyMaster]
	@RecId bigint,
	@CName nvarchar(100),
	@City nvarchar(100),
	@State bigint,
	@Contact nvarchar(50),
	@Email nvarchar(50),
	@IsActive int,
	@LogoString ntext,
	@CreatedBy bigint,
	@ReportTitle1 nvarchar(500),
	@ReportTitle2 nvarchar(500),
	@ReportTitle3 nvarchar(500)
AS
BEGIN
	IF(@RecId = 0)
		BEGIN
			INSERT INTO [dbo].[CompanyMaster]
					   ([CName]
					   ,[City]
					   ,[State]
					   ,[Contact]
					   ,[Email]
					   ,[Logo]
					   ,[IsActive]
					   ,[CreatedBy]
					   ,[CreateDate]
					   ,[Header1]
					   ,[Header2]
					   ,[Header3])
				 VALUES
					   (@CName
					   ,@City
					   ,@State
					   ,@Contact
					   ,@Email
					   ,@LogoString
					   ,@IsActive
					   ,@CreatedBy
					   ,GETDATE()
					   ,@ReportTitle1
					   ,@ReportTitle2
					   ,@ReportTitle3)
			SELECT @RecId = SCOPE_IDENTITY()
		END	
	 ELSE
		BEGIN
			if(@LogoString is null or convert(nvarchar(10),@LogoString)='')
			BEGIN
				SELECT @LogoString=LOGO FROM [dbo].[CompanyMaster] WHERE RecId =@RecId 
			END
			
			UPDATE [dbo].[CompanyMaster]
				SET [CName] = @CName
				  ,[City] = @City
				  ,[State] = @State
				  ,[Contact] = @Contact
				  ,[Email] = @Email
				  ,[Logo] = @LogoString
				  ,[Header1]=@ReportTitle1
				  ,[Header2]=@ReportTitle2
			      ,[Header3]=@ReportTitle3
			 WHERE [RecId] = @RecId
			 
			 UPDATE DBO.UserMaster 
			 SET State =@State
			 WHERE CompanyId =@RecId 
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Web_SaveDeathsDetails]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <02 July 2019>
-- =============================================
-- Execute Web_SaveDeathsDetails
CREATE PROCEDURE [dbo].[Web_SaveDeathsDetails]
@RecId bigint,
@Htype int,
@StateId bigint,
@CompanyId bigint,
@Decease nvarchar(200),
@Sex int,
@Age int,
@Address nvarchar(250),
@DOA datetime,
@DOD datetime,
@CausesDeath nvarchar(500),
@CreatedBy bigint,
@RefNo nvarchar(150),
@Machine nvarchar(250)
AS
BEGIN
	
	IF(@RecId = 0)
		BEGIN
			INSERT INTO [dbo].[DeathsDetails]
					   ([Htype]
					   ,[StateId]
					   ,[CompanyId]
					   ,[Decease]
					   ,[Sex]
					   ,[Age]
					   ,[RefNo]
					   ,[Address]
					   ,[DOA]
					   ,[DOD]
					   ,[CausesDeath]
					   ,[CreatedBy]
					   ,[CreateDate]
					   ,[Machine] )
				 VALUES
					   (@Htype
					   ,@StateId
					   ,@CompanyId
					   ,@Decease
					   ,@Sex
					   ,@Age
					   ,@RefNo
					   ,@Address
					   ,@DOA
					   ,@DOD
					   ,@CausesDeath
					   ,@CreatedBy
					   ,GETDATE()
					   ,@Machine)
			--SELECT @RecId = SCOPE_IDENTITY()	   
		END
	ELSE
		BEGIN
			UPDATE [dbo].[DeathsDetails]
			   SET [Htype] = @Htype
				  ,[Decease] =  @Decease
				  ,[Sex] = @Sex
				  ,[Age] = @Age
				  ,[RefNo] = @RefNo
				  ,[Address] = @Address
				  ,[DOA] = @DOA
				  ,[DOD] = @DOD
				  ,[CausesDeath] = @CausesDeath
				  ,[CreatedBy] = @CreatedBy
				  ,[Machine] = @Machine 
			 WHERE [RecId] = @RecId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Web_SaveDentalProcedure]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <01 Oct 2019>
-- =============================================
-- execute Web_SaveDentalProcedure 1,0,1,1,9,2019,'Cradles',7,2
CREATE PROCEDURE [dbo].[Web_SaveDentalProcedure]
	@RecId bigint,
	@ServiceId bigint,
	@CompanyId bigint,
	@StateId bigint,
	--@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@CDay nvarchar(100),
	@CVal int,
	@CreatedBy bigint,
	@Htype int
	
AS
BEGIN

	DECLARE @COMID AS BIGINT
	SELECT @COMID=CompanyId FROM dbo.UserMaster WHERE RecId =@CreatedBy
	DECLARE @MACHINE AS NVARCHAR(120)
	SELECT @MACHINE=HOST_NAME()
	DECLARE @Q AS NVARCHAR(Max)
	IF (@RecId > 0)
	/*BEGIN
	   SELECT @Q=N'Update [dbo].[HospitalBeds] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE SrNo ='+ convert(nvarchar(10),@RecId) +'and CompanyId='+convert(nvarchar(10),@COMID) 
	END*/
	--AND CD.StateId=@StateId 
	IF EXISTS(SELECT 1 FROM DBO.Dental AS CD WHERE CD.RefSrNo =@RecId AND CD.CYear =@CYear AND CD.CMonth =@CMonth AND CD.CompanyId=@COMID AND CD.Htype = @Htype)
	BEGIN
	--+ ' AND StateId=' + convert(nvarchar(10),@StateId) 
	SELECT @Q=N'Update [dbo].[Dental] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE RefSrNo =' + convert(nvarchar(10),@RecId) + ' AND CYear = ' + convert(nvarchar(10),@CYear) + ' AND CMonth = ' + convert(nvarchar(10),@CMonth) + ' AND CompanyId=' + convert(nvarchar(10),@COMID) + 'AND Htype=' +CONVERT(nvarchar(10),@Htype)
	END
	ELSE
	BEGIN
	   SELECT @Q=N'INSERT INTO [dbo].[Dental]([RefSrNo],[ServiceId],[CompanyId],[StateId],[CMonth],[CYear],['+ @CDay +'],[CreatedBy],[Machine],[Htype])VALUES ('+ convert(nvarchar(10),@RecId) +','+ convert(nvarchar(10),@ServiceId) +','+ convert(nvarchar(10),@CompanyId) +','+ convert(nvarchar(10),@StateId) + ',' + convert(nvarchar(10),@CMonth) +','+ convert(nvarchar(10),@CYear) + ',' + convert(nvarchar(10),@CVal) + ',' + convert(nvarchar(10),@CreatedBy) + ',''' + @MACHINE + ''',' + CONVERT(nvarchar(10),@Htype) +')'	
	END
	EXECUTE(@Q)
	--PRINT(@Q)
END
GO
/****** Object:  StoredProcedure [dbo].[Web_SaveHospitalBedsDetails]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <28 Sept 2019>
-- =============================================
-- execute [Web_SaveHospitalBedsDetails] 1,0,1,1,9,2019,'Beds',7,2,150
CREATE PROCEDURE [dbo].[Web_SaveHospitalBedsDetails]
	@RecId bigint,
	@ServiceId bigint,
	@CompanyId bigint,
	@StateId bigint,
	--@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@CDay nvarchar(100),
	@CVal int,
	@CreatedBy bigint,
	@Htype int
AS
BEGIN

	DECLARE @COMID AS BIGINT
	SELECT @COMID=CompanyId FROM dbo.UserMaster WHERE RecId =@CreatedBy
	DECLARE @MACHINE AS NVARCHAR(120)
	SELECT @MACHINE=HOST_NAME()
	DECLARE @Q AS NVARCHAR(Max)
	IF (@RecId > 0)
	--CD.StateId=@StateId AND 
	IF EXISTS(SELECT 1 FROM DBO.HospitalBeds AS CD WHERE CD.RefSrNo =@RecId AND CD.CYear =@CYear AND CD.CMonth =@CMonth AND CD.CompanyId=@COMID AND CD.Htype = @Htype) 
		BEGIN	
		--+ ' AND StateId=' + convert(nvarchar(10),@StateId) 
			SELECT @Q=N'Update [dbo].[HospitalBeds] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE RefSrNo =' + convert(nvarchar(10),@RecId) + ' AND CYear = ' + convert(nvarchar(10),@CYear) + ' AND CMonth = ' + convert(nvarchar(10),@CMonth) + ' AND CompanyId=' + convert(nvarchar(10),@COMID) + ' AND Htype='+ convert(nvarchar(10),@Htype)		
		END
	ELSE
		BEGIN
			SELECT @Q=N'INSERT INTO [dbo].[HospitalBeds]([RefSrNo],[ServiceId],[CompanyId],[StateId],[CMonth],[CYear],['+ @CDay +'],[CreatedBy],[Machine],[Htype])VALUES ('+ convert(nvarchar(10),@RecId) +','+ convert(nvarchar(10),@ServiceId) +','+ convert(nvarchar(10),@CompanyId) +','+ convert(nvarchar(10),@StateId) + ',' + convert(nvarchar(10),@CMonth) +','+ convert(nvarchar(10),@CYear) + ',' + convert(nvarchar(10),@CVal) + ',' + convert(nvarchar(10),@CreatedBy) + ',''' + @MACHINE + ''',' +  convert(nvarchar(10),@Htype) +')'	
		END
	EXECUTE(@Q)
	--PRINT(@Q)
END
GO
/****** Object:  StoredProcedure [dbo].[Web_SaveLiveBirthWeight]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <01 Oct 2019>
-- =============================================
-- execute [Web_SaveLiveBirthWeight] 1,0,1,1,9,2019,'Cradles',7,2
CREATE PROCEDURE [dbo].[Web_SaveLiveBirthWeight]
	@RecId bigint,
	@ServiceId bigint,
	@CompanyId bigint,
	@StateId bigint,
	--@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@CDay nvarchar(100),
	@CVal int,
	@CreatedBy bigint,
	@Htype int
	
AS
BEGIN

	DECLARE @COMID AS BIGINT
	SELECT @COMID=CompanyId FROM dbo.UserMaster WHERE RecId =@CreatedBy
	DECLARE @MACHINE AS NVARCHAR(120)
	SELECT @MACHINE=HOST_NAME()
	DECLARE @Q AS NVARCHAR(Max)
	IF (@RecId > 0)
	/*BEGIN
	   SELECT @Q=N'Update [dbo].[HospitalBeds] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE SrNo ='+ convert(nvarchar(10),@RecId) +'and CompanyId='+convert(nvarchar(10),@COMID) 
	END*/
	--AND CD.StateId=@StateId 
	IF EXISTS(SELECT 1 FROM DBO.LiveBirthWeight AS CD WHERE CD.RefSrNo =@RecId AND CD.CYear =@CYear AND CD.CMonth =@CMonth AND CD.CompanyId=@COMID AND CD.Htype = @Htype)
	BEGIN
	--+ ' AND StateId=' + convert(nvarchar(10),@StateId) 
	SELECT @Q=N'Update [dbo].[LiveBirthWeight] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE RefSrNo =' + convert(nvarchar(10),@RecId) + ' AND CYear = ' + convert(nvarchar(10),@CYear) + ' AND CMonth = ' + convert(nvarchar(10),@CMonth) + ' AND CompanyId=' + convert(nvarchar(10),@COMID) + 'AND Htype=' + CONVERT(nvarchar(10),@Htype)
	END
	ELSE
	BEGIN
	   SELECT @Q=N'INSERT INTO [dbo].[LiveBirthWeight]([RefSrNo],[ServiceId],[CompanyId],[StateId],[CMonth],[CYear],['+ @CDay +'],[CreatedBy],[Machine],[Htype])VALUES ('+ convert(nvarchar(10),@RecId) +','+ convert(nvarchar(10),@ServiceId) +','+ convert(nvarchar(10),@CompanyId) +','+ convert(nvarchar(10),@StateId) + ',' + convert(nvarchar(10),@CMonth) +','+ convert(nvarchar(10),@CYear) + ',' + convert(nvarchar(10),@CVal) + ',' + convert(nvarchar(10),@CreatedBy) + ',''' + @MACHINE + ''',' + CONVERT(nvarchar(10),@Htype) +')'	
	END
	EXECUTE(@Q)
	--PRINT(@Q)
END
GO
/****** Object:  StoredProcedure [dbo].[Web_SaveMaternalHealth]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <01 Oct 2019>
-- =============================================
-- execute [Web_SaveMaternalHealth] 1,0,1,1,10,2019,'M60',7,2
CREATE PROCEDURE [dbo].[Web_SaveMaternalHealth]
	@RecId bigint,
	@ServiceId bigint,
	@CompanyId bigint,
	@StateId bigint,
	--@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@CDay nvarchar(100),
	@CVal int,
	@CreatedBy bigint,
	@Htype int
	
AS
BEGIN

	DECLARE @COMID AS BIGINT
	SELECT @COMID=CompanyId FROM dbo.UserMaster WHERE RecId =@CreatedBy
	DECLARE @MACHINE AS NVARCHAR(120)
	SELECT @MACHINE=HOST_NAME()
	DECLARE @Q AS NVARCHAR(Max)
	IF (@RecId > 0)
	/*BEGIN
	   SELECT @Q=N'Update [dbo].[HospitalBeds] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE SrNo ='+ convert(nvarchar(10),@RecId) +'and CompanyId='+convert(nvarchar(10),@COMID) 
	END*/
	--AND CD.StateId=@StateId 
	IF EXISTS(SELECT 1 FROM DBO.MaternalHealth AS CD WHERE CD.RefSrNo =@RecId AND CD.CYear =@CYear AND CD.CMonth =@CMonth AND CD.CompanyId=@COMID AND CD.Htype = @Htype)
	BEGIN
	--+ ' AND StateId=' + convert(nvarchar(10),@StateId) 
	SELECT @Q=N'Update [dbo].[MaternalHealth] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE RefSrNo =' + convert(nvarchar(10),@RecId) + ' AND CYear = ' + convert(nvarchar(10),@CYear) + ' AND CMonth = ' + convert(nvarchar(10),@CMonth) + ' AND CompanyId=' + convert(nvarchar(10),@COMID) + ' AND Htype=' + CONVERT(nvarchar(10),@Htype)
	END
	ELSE
	BEGIN
	   SELECT @Q=N'INSERT INTO [dbo].[MaternalHealth]([RefSrNo],[ServiceId],[CompanyId],[StateId],[CMonth],[CYear],['+ @CDay +'],[CreatedBy],[Machine],[Htype])VALUES ('+ convert(nvarchar(10),@RecId) +','+ convert(nvarchar(10),@ServiceId) +','+ convert(nvarchar(10),@CompanyId) +','+ convert(nvarchar(10),@StateId) + ',' + convert(nvarchar(10),@CMonth) +','+ convert(nvarchar(10),@CYear) + ',' + convert(nvarchar(10),@CVal) + ',' + convert(nvarchar(10),@CreatedBy) + ',''' + @MACHINE + ''',' + CONVERT(nvarchar(10),@Htype)+ ')'	
	END
	EXECUTE(@Q)
	--PRINT(@Q)
END
GO
/****** Object:  StoredProcedure [dbo].[Web_SaveOTPMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<DK>
-- Create date: <17 Jan 2019>
-- =============================================
-- Execute Web_SaveOTPMaster
CREATE PROCEDURE [dbo].[Web_SaveOTPMaster]
@USERID nvarchar(20),
@USERNAME nvarchar(50),
@OTP nvarchar(100) Output,
@MACHINENAME nvarchar(50),
@ISSUCCESS int,
@EMAILID as nvarchar(70)
AS
BEGIN
	SELECT @OTP = NEWID()
	IF (@OTP <> '')
		BEGIN
			INSERT INTO [dbo].[OTPMASTER]
					   ([USERID]
					   ,[USERNAME]
					   ,[OTP]
					   ,[MACHINENAME]
					   ,[ISSUCCESS]
					   ,[EMAILID]
					   ,[CREATEDDATE])
				 VALUES
					   (@USERID
					   ,@USERNAME
					   ,@OTP
					   ,@MACHINENAME
					   ,@ISSUCCESS
					   ,@EMAILID
					   ,GETDATE())
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Web_SavePassword]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<DK>
-- Create date: <17 Jan 2019>
-- =============================================
-- Execute [Web_SavePassword] 'superadmin','123123123','0109D425-0836-4F7D-95EB-29B4868BB5DF'
CREATE PROCEDURE [dbo].[Web_SavePassword]
@UserId nvarchar(50),
@Password nvarchar(50),
@Key nvarchar(100)
AS
BEGIN
	UPDATE dbo.UserMaster
	SET PWD = @Password
	WHERE UserId = @UserId
	
	UPDATE dbo.OTPMASTER
	SET ISSUCCESS = 1
	WHERE OTP = @Key
END
GO
/****** Object:  StoredProcedure [dbo].[Web_SavePatientAdmitOutcomes]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <01 Oct 2019>
-- =============================================
-- execute [Web_SavePatientAdmitOutcomes] 1,0,1,1,9,2019,'Cradles',7,2,151
CREATE PROCEDURE [dbo].[Web_SavePatientAdmitOutcomes]
	@RecId bigint,
	@ServiceId bigint,
	@CompanyId bigint,
	@StateId bigint,
	--@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@CDay nvarchar(100),
	@CVal int,
	@CreatedBy bigint,
	@Htype int
AS
BEGIN

	DECLARE @COMID AS BIGINT
	SELECT @COMID=CompanyId FROM dbo.UserMaster WHERE RecId =@CreatedBy
	DECLARE @MACHINE AS NVARCHAR(120)
	SELECT @MACHINE=HOST_NAME()
	DECLARE @Q AS NVARCHAR(Max)
	IF (@RecId > 0)
	--AND CD.StateId=@StateId 
	IF EXISTS(SELECT 1 FROM DBO.IPDOutcome AS CD WHERE CD.RefSrNo =@RecId AND CD.CYear =@CYear AND CD.CMonth =@CMonth AND CD.CompanyId=@COMID AND CD.Htype = @Htype)
		BEGIN
		--+ ' AND StateId=' + convert(nvarchar(10),@StateId) 
			SELECT @Q=N'Update [dbo].[IPDOutcome] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE RefSrNo =' + convert(nvarchar(10),@RecId) + ' AND CYear = ' + convert(nvarchar(10),@CYear) + ' AND CMonth = ' + convert(nvarchar(10),@CMonth) + ' AND CompanyId=' + convert(nvarchar(10),@COMID) + ' AND Htype=' + convert(nvarchar(10),@Htype)
		END
	ELSE
		BEGIN
			SELECT @Q=N'INSERT INTO [dbo].[IPDOutcome]([RefSrNo],[ServiceId],[CompanyId],[StateId],[CMonth],[CYear],['+ @CDay +'],[CreatedBy],[Machine],[Htype])VALUES ('+ convert(nvarchar(10),@RecId) +','+ convert(nvarchar(10),@ServiceId) +','+ convert(nvarchar(10),@CompanyId) +','+ convert(nvarchar(10),@StateId) + ',' + convert(nvarchar(10),@CMonth) +','+ convert(nvarchar(10),@CYear) + ',' + convert(nvarchar(10),@CVal) + ',' + convert(nvarchar(10),@CreatedBy) + ',''' + @MACHINE + ''',' + convert(nvarchar(10),@Htype) + ')'	
		END
	EXECUTE(@Q)
	--PRINT(@Q)
END
GO
/****** Object:  StoredProcedure [dbo].[Web_SavePermissionMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <10 Aug 2019>
-- =============================================
-- Execute Web_SavePermissionMaster
CREATE PROCEDURE [dbo].[Web_SavePermissionMaster]
@RecId bigint output,
@MenuId bigint,
@TypeId bigint,
@IsActive int,
@CreatedBy bigint
AS
BEGIN
	IF NOT EXISTS(SELECT 1 FROM dbo.PermissionMaster WHERE RecId = @RecId AND TypeId = @TypeId)
		BEGIN
			INSERT INTO [dbo].[PermissionMaster]
					   ([MenuId]
					   ,[TypeId]
					   ,[IsActive]
					   ,[CreatedBy]
					   ,[CreateDate])
				 VALUES
					   (@MenuId
					   ,@TypeId
					   ,@IsActive
					   ,@CreatedBy
					   ,GETDATE())
			SELECT @RecId = SCOPE_IDENTITY()
		END
	ELSE
		BEGIN
			UPDATE [dbo].[PermissionMaster]
			   SET [IsActive] = @IsActive
			 WHERE RecId = @RecId AND TypeId = @TypeId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Web_SaveServicesMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Web_SaveServicesMaster
CREATE PROCEDURE [dbo].[Web_SaveServicesMaster]
@RecId bigint output,
@ParentId bigint,
@ServiceName nvarchar(100),
@Description nvarchar(500),
@IsActive int,
@CreatedBy bigint
AS
BEGIN
	IF(@RecId = 0)
		BEGIN
			DECLARE @MaxSortOrd AS INT
			SELECT @MaxSortOrd = ISNULL(MAX(SortOrd),0) + 1 FROM dbo.ServicesMaster
			
			INSERT INTO [dbo].[ServicesMaster]
					   ([ParentId]
					   ,[ServiceName]
					   ,[Description]
					   ,[SortOrd]
					   ,[IsActive]
					   ,[CreatedBy]
					   ,[CreateDate])
				 VALUES
					   (@ParentId
					   ,@ServiceName
					   ,@Description
					   ,@MaxSortOrd
					   ,@IsActive
					   ,@CreatedBy
					   ,GETDATE())
			SELECT @RecId = SCOPE_IDENTITY()
		END
	ELSE
		BEGIN
			UPDATE [dbo].[ServicesMaster]
			   SET [ParentId] = @ParentId
				  ,[ServiceName] = @ServiceName
				  ,[Description] = @Description
			 WHERE [RecId] = @RecId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Web_SaveStateMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Web_SaveStateMaster
CREATE PROCEDURE [dbo].[Web_SaveStateMaster]
@RecId bigint output,
@StateName nvarchar(200),
@Description nvarchar(500),
@IsActive int,
@CreatedBy bigint
AS
BEGIN
	IF(@RecId = 0)
		BEGIN
			INSERT INTO [dbo].[StateMaster]
					   ([StateName]
					   ,[Description]
					   ,[IsActive]
					   ,[CreatedBy]
					   ,[CreateDate])
				 VALUES
					   (@StateName
					   ,@Description
					   ,@IsActive
					   ,@CreatedBy
					   ,GETDATE())
			SELECT @RecId = SCOPE_IDENTITY()
		END
	ELSE
		BEGIN
			UPDATE [dbo].[StateMaster]
			   SET [StateName] = @StateName
				  ,[Description] = @Description
			 WHERE [RecId] = @RecId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Web_SaveUser]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <02 July 2019>
-- =============================================
-- Execute Web_SaveUser
CREATE PROCEDURE [dbo].[Web_SaveUser]
@RecId bigint output,
@UserId nvarchar(50),
@PWD nvarchar(50),
@UserName nvarchar(100),
@DOB datetime,
@Gender int,
@EmailId nvarchar(50),
@Contact nvarchar(50),
@Address nvarchar(500),
@City nvarchar(50),
@State nvarchar(50),
@ZipCode nvarchar(10),
@ProfilePic nvarchar(100),
@UserType int,
@IsActive int,
@CreatedBy bigint,
@CompanyId int
AS
BEGIN

	SELECT TOP 1 @State =State FROM DBO.CompanyMaster WHERE RecId=@CompanyId 
	
	IF(@RecId = 0)
		BEGIN
			INSERT INTO [dbo].[UserMaster]
					   ([UserId]
					   ,[PWD]
					   ,[UserName]
					   ,[DOB]
					   ,[Gender]
					   ,[EmailId]
					   ,[Contact]
					   ,[Address]
					   ,[City]
					   ,[State]
					   ,[ZipCode]
					   ,[ProfilePic]
					   ,[UserType]
					   ,[IsActive]
					   ,[CompanyId]
					   ,[CreatedBy]
					   ,[CreateDate])
				 VALUES
					   (@UserId
					   ,@PWD
					   ,@UserName
					   ,@DOB
					   ,@Gender
					   ,@EmailId
					   ,@Contact
					   ,@Address
					   ,@City
					   ,@State
					   ,@ZipCode
					   ,@ProfilePic
					   ,@UserType
					   ,@IsActive
					   ,(case when @UserType=1 or @UserType=3 then -1 else @CompanyId end)
					   ,@CreatedBy
					   ,GETDATE())
			SELECT @RecId = SCOPE_IDENTITY()	   
		END
	ELSE
		BEGIN
			UPDATE [dbo].[UserMaster]
			   SET [UserId] = @UserId
				  ,[PWD] = @PWD
				  ,[UserName] = @UserName
				  ,[DOB] = @DOB
				  ,[Gender] = @Gender
				  ,[EmailId] = @EmailId
				  ,[Contact] = @Contact
				  ,[Address] = @Address
				  ,[City] = @City
				  ,[State] = @State
				  ,[ZipCode] = @ZipCode
				  ,[ProfilePic] = @ProfilePic
				  ,[UserType] = @UserType
				  ,[CompanyId]=(case when @UserType=1 or @UserType=3 then -1 else @CompanyId end)
			 WHERE [RecId] = @RecId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Web_UpdateHospitalIsActive]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Web_UpdateHospitalIsActive 26
CREATE PROCEDURE [dbo].[Web_UpdateHospitalIsActive]
	@RecId bigint
AS
BEGIN
	DECLARE @IsActive int
	SELECT @IsActive = IsActive FROM CompanyMaster WHERE RecId = @RecId
	SELECT @IsActive
	IF(@IsActive = 0)
		BEGIN
			UPDATE dbo.CompanyMaster
			SET IsActive = 1
			WHERE RecId = @RecId
		END
	IF(@IsActive = 1)
		BEGIN
			UPDATE dbo.CompanyMaster
			SET IsActive = 0
			WHERE RecId = @RecId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Web_UpdateServicesIsActive]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Web_UpdateServicesIsActive 26
Create PROCEDURE [dbo].[Web_UpdateServicesIsActive]
	@RecId bigint
AS
BEGIN
	DECLARE @IsActive int
	SELECT @IsActive = IsActive FROM ServicesMaster WHERE RecId = @RecId
	SELECT @IsActive
	IF(@IsActive = 0)
		BEGIN
			UPDATE dbo.ServicesMaster
			SET IsActive = 1
			WHERE RecId = @RecId
		END
	IF(@IsActive = 1)
		BEGIN
			UPDATE dbo.ServicesMaster
			SET IsActive = 0
			WHERE RecId = @RecId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Web_UpdateStateIsActive]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Web_UpdateStateIsActive 26
CREATE PROCEDURE [dbo].[Web_UpdateStateIsActive]
	@RecId bigint
AS
BEGIN
	DECLARE @IsActive int
	SELECT @IsActive = IsActive FROM StateMaster WHERE RecId = @RecId
	SELECT @IsActive
	IF(@IsActive = 0)
		BEGIN
			UPDATE dbo.StateMaster
			SET IsActive = 1
			WHERE RecId = @RecId
		END
	IF(@IsActive = 1)
		BEGIN
			UPDATE dbo.StateMaster
			SET IsActive = 0
			WHERE RecId = @RecId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Web_UpdateUserIsActive]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Web_UpdateUserIsActive 26
CREATE PROCEDURE [dbo].[Web_UpdateUserIsActive]
	@RecId bigint
AS
BEGIN
	DECLARE @IsActive int
	SELECT @IsActive = IsActive FROM UserMaster WHERE RecId = @RecId
	SELECT @IsActive
	IF(@IsActive = 0)
		BEGIN
			UPDATE dbo.UserMaster
			SET IsActive = 1
			WHERE RecId = @RecId
		END
	IF(@IsActive = 1)
		BEGIN
			UPDATE dbo.UserMaster
			SET IsActive = 0
			WHERE RecId = @RecId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Win_DeleteDeaths]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <02 July 2019>
-- =============================================
-- Execute Win_DeleteDeaths 1
CREATE PROCEDURE [dbo].[Win_DeleteDeaths]
@RecId bigint
AS
BEGIN
	DELETE dbo.DeathsDetails
	WHERE RecId = @RecId
END
GO
/****** Object:  StoredProcedure [dbo].[Win_DeleteUser]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <02 July 2019>
-- =============================================
-- Execute Win_DeleteUser
CREATE PROCEDURE [dbo].[Win_DeleteUser]
@RecId bigint
AS
BEGIN
	DELETE dbo.UserMaster
	WHERE RecId = @RecId
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetAllHosptBEDS]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <12 Oct 2019>
-- Description:	<Get/Save Allocation Of Hospital BEDS.>
-- =============================================
-- EXECUTE [Win_GetAllHosptBEDS] 1,1,'OMIT-1-PC',10,2019,150
CREATE PROCEDURE [dbo].[Win_GetAllHosptBEDS]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int
AS
BEGIN
SELECT HM.SrNo AS RecId
		,0 AS SMRecId
		,DepartMent As ServiceName
		,HB.Beds
		,HB.Cradles
		,HB.Cots
		,HB.Incubator
		,(isnull(HB.Beds,0) + isnull(HB.Cradles,0) + isnull(HB.Cots,0) + isnull(HB.Incubator,0)) AS Total
		,HB.Admission
		,HB.Dicharge
		,HB.Deaths
	FROM dbo.HospitalBedMaster AS HM
	LEFT OUTER JOIN dbo.HospitalBeds   AS HB
	ON HB.RefSrNo = HM.SrNo 
	AND (HB.CompanyId = @CompanyId)
	--And (HB.StateId = @StateId)
	--And (HB.Machine = @Machine)
	--AND (HM.DepartMent<>'TOTAL')
	And (HB.CMonth = @CMonth)
	And (HB.CYear = @CYear)
	AND (HM.DepartMent<>'TOTAL')
	AND (HB.Htype = @Htype) 
	UNION ALL 
	SELECT 8 AS RecId
		,0 AS SMRecId
		,'TOTAL' As ServiceName
		,SUM(isnull(HB.Beds,0)) AS Beds
		,SUM(isnull(HB.Cradles,0)) AS Cradles
		,SUM(isnull(HB.Cots,0)) AS Cots
		,SUM(isnull(HB.Incubator,0)) AS Incubator
		,SUM(isnull(HB.Beds,0) + isnull(HB.Cradles,0) + isnull(HB.Cots,0) + isnull(HB.Incubator,0)) AS Total
		,SUM(isnull(HB.Admission,0)) AS Admission
		,SUM(isnull(HB.Dicharge,0)) AS Dicharge
		,SUM(isnull(HB.Deaths,0)) AS Deaths
		
	FROM dbo.HospitalBeds   AS HB
	WHERE (HB.CompanyId = @CompanyId)
	--And (HB.StateId = @StateId)
	--And (HB.Machine = @Machine)
	And (HB.CMonth = @CMonth)
	And (HB.CYear = @CYear)	
	AND (HB.Htype = @Htype)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetBlindnessPrevProg]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <12 Oct 2019>
-- Description:	<Get Blindess Patient Details.>
-- =============================================
-- execute Web_GetBlindnessPrevProg 1,1,'OMIT-1-PC',10,2019
CREATE PROCEDURE [dbo].[Win_GetBlindnessPrevProg]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int
AS
BEGIN
		SELECT BM.SrNo AS RecId
			,INTERVENSIONS AS ServiceName
			,B.M019
			,B.F019
			,B.M2039
			,B.F2039
			,B.M4059
			,B.F4059
			,B.M6079
			,B.F6079
			,B.M80
			,B.F80
			,(Isnull(B.M019,0)+Isnull(B.M2039,0)+Isnull(B.M4059,0)+Isnull(B.M6079,0)+Isnull(B.M80,0)) AS MTOTAL
			,(Isnull(B.F019,0)+Isnull(B.F2039,0)+Isnull(B.F4059,0)+Isnull(B.F6079,0)+Isnull(B.F80,0)) AS FTOTAL
			,(Isnull(B.M019,0)+Isnull(B.F019,0)+Isnull(B.M2039,0)+Isnull(B.F2039,0)+Isnull(B.M4059,0)+Isnull(B.F4059,0)+Isnull(B.M6079,0)+Isnull(B.F6079,0)+Isnull(B.M80,0)+Isnull(B.F80,0)) AS TOTAL
		FROM dbo.BlindnessMaster AS BM
		LEFT OUTER JOIN dbo.Blindness   AS B
		ON B.RefSrNo = BM.SrNo 
		AND(B.COMPANTID = @CompanyId)
		--AND(B.StateId = @StateId)
		--And (HB.Machine = @Machine)
		AND(B.CMonth = @CMonth)
		AND(B.CYear = @CYear)
		AND(B.Htype = @Htype)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetCaseDetail]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Win_GetCaseDetail 1,7,2019,1,1,1,4,7,'A'
CREATE PROCEDURE [dbo].[Win_GetCaseDetail]
	@GroupId int,
	@CMonth int,
	@CYear int,
	@HType int,
	@CaseType int,
	@Gender int,
	@StateId bigint,
	@CompanyId bigint,
	@SearchVal nvarchar(5)
AS
BEGIN
	if(@HType<101)
	BEGIN
		SET @SearchVal=''
	END	
	DECLARE @DayDate as datetime
	SELECT @DayDate= convert(nvarchar(4),@CYear) +'-'+ convert(nvarchar(4),@CMonth) + '-1'
	Declare @NoOfDay as int
	SELECT @NoOfDay=Day(DATEADD(day,-1,DATEADD(month,1,@DayDate)))

	SELECT SM.RecId AS OrderId
		  ,0 AS SMRecId
		  ,9999 AS SMParentId
		  ,'TOTAL' AS ServiceName
		  ,0 AS CDRecId
		  ,0 AS CDServiceId
		  ,0 AS Gender
		  ,0 AS CMonth
		  ,0 AS CYear
		  ,0 AS StateId
		  ,0 AS Date1
		  ,0 AS Date2
		  ,0 AS Date3
		  ,0 AS Date4
		  ,0 AS Date5
		  ,0 AS Date6
		  ,0 AS Date7
		  ,0 AS Date8
		  ,0 AS Date9
		  ,0 AS Date10
		  ,0 AS Date11
		  ,0 AS Date12
		  ,0 AS Date13
		  ,0 AS Date14
		  ,0 AS Date15
		  ,0 AS Date16
		  ,0 AS Date17
		  ,0 AS Date18
		  ,0 AS Date19
		  ,0 AS Date20
		  ,0 AS Date21
		  ,0 AS Date22
		  ,0 AS Date23
		  ,0 AS Date24
		  ,0 AS Date25
		  ,0 AS Date26
		  ,0 AS Date27
		  ,0 AS Date28
		  ,0 AS Date29
		  ,0 AS Date30
		  ,0 AS Date31
		  ,NULL AS RowTotal
		  ,0 AS CreatedBy
		  ,0 AS CreateDate
		  ,(Case when @NoOfDay>28 then '' else 'd-none' end) AS VDate29
		  ,(Case when @NoOfDay>29 then '' else 'd-none' end) AS VDate30
		  ,(Case when @NoOfDay>30 then '' else 'd-none' end) AS VDate31
		  ,@NoOfDay+2 as TotDay
	FROM dbo.ServicesMaster AS SM
	LEFT OUTER JOIN dbo.CaseDetail AS CD
	ON SM.RecId = CD.ServiceId
	AND CD.HType=@HType
	AND CD.CaseType = @CaseType
	AND CD.Gender = @Gender
	AND CD.CMonth = @CMonth
	AND CD.CYear = @CYear
	--AND CD.StateId = @StateId
	And CD.CompanyId=@CompanyId
	WHERE (SM.ParentId = 0)
	AND (SM.IsActive = 1)
	AND SM.GroupId=@GroupId
	AND (SM.ServiceName like @SearchVal + '%' OR @SearchVal='')
	
	UNION ALL
	
	SELECT (CASE WHEN SM.ParentId = 0 THEN SM.RecId ELSE SM.ParentId END) AS OrderId
		  ,SM.RecId AS SMRecId
		  ,SM.ParentId AS SMParentId
		  ,SM.ServiceName
		  ,CD.RecId AS CDRecId
		  ,CD.ServiceId AS CDServiceId
		  ,CD.Gender
		  ,CD.CMonth
		  ,CD.CYear
		  ,CD.StateId
		  ,CD.Date1
		  ,CD.Date2
		  ,CD.Date3
		  ,CD.Date4
		  ,CD.Date5
		  ,CD.Date6
		  ,CD.Date7
		  ,CD.Date8
		  ,CD.Date9
		  ,CD.Date10
		  ,CD.Date11
		  ,CD.Date12
		  ,CD.Date13
		  ,CD.Date14
		  ,CD.Date15
		  ,CD.Date16
		  ,CD.Date17
		  ,CD.Date18
		  ,CD.Date19
		  ,CD.Date20
		  ,CD.Date21
		  ,CD.Date22
		  ,CD.Date23
		  ,CD.Date24
		  ,CD.Date25
		  ,CD.Date26
		  ,CD.Date27
		  ,CD.Date28
		  ,CD.Date29
		  ,CD.Date30
		  ,CD.Date31
		  ,NULL AS RowTotal
		  ,CD.CreatedBy
		  ,CD.CreateDate
		  ,(Case when @NoOfDay>28 then '' else 'd-none' end) AS VDate29
		  ,(Case when @NoOfDay>29 then '' else 'd-none' end) AS VDate30
		  ,(Case when @NoOfDay>30 then '' else 'd-none' end) AS VDate31
		  ,@NoOfDay+2 as TotDay
	FROM dbo.ServicesMaster AS SM
	LEFT OUTER JOIN dbo.CaseDetail AS CD
	ON SM.RecId = CD.ServiceId
	AND CD.HType=@HType
	AND CD.CaseType = @CaseType
	AND CD.Gender = @Gender
	AND CD.CMonth = @CMonth
	AND CD.CYear = @CYear
	--AND CD.StateId = @StateId
	And CD.CompanyId=@CompanyId
	WHERE (SM.IsActive = 1)
	AND SM.GroupId=@GroupId 
	AND (SM.ServiceName like @SearchVal + '%' OR @SearchVal='')
	ORDER BY OrderId,SMParentId
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetCausesDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute [Win_GetCausesDrp]
CREATE PROCEDURE [dbo].[Win_GetCausesDrp]
AS
BEGIN
	--SELECT 0 AS RecId,'--All--' AS Causes
	--UNION ALL
		SELECT DISTINCT UM.CausesDeath AS RecId
			  ,UM.CausesDeath AS Causes
		FROM dbo.DeathsDetails AS UM
		
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetCompanyMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <02 July 2019>
-- =============================================
-- Execute GetCompanyMaster
CREATE PROCEDURE [dbo].[Win_GetCompanyMaster]
@RecId bigint
AS
BEGIN
	SELECT CM.RecId
		  ,CM.CName
		  ,CM.City
		  ,CM.State
		  ,CM.Logo
		  ,CM.Contact
		  ,CM.Email
		  ,CM.CreatedBy
		  ,CM.CreateDate
		  ,CM.Header1
		  ,CM.Header2
		  ,CM.Header3
	FROM dbo.CompanyMaster AS CM
	WHERE CM.RecId = @RecId
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetDeathsList]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Dadu Kamaliya>
-- Create date: <03 August 2019>
-- =============================================
-- Execute Win_GetDeathsList '',22,1,1
CREATE PROCEDURE [dbo].[Win_GetDeathsList]
	@SearchText nvarchar(200),
	@Htype int,
	@StateId bigint,
	@CompanyId bigint
AS
BEGIN
	SELECT UM.RecId
		  ,UM.Decease
		  ,(CASE WHEN UM.Sex = 1 THEN 'Male' WHEN UM.Sex = 2 THEN 'Female' ELSE '' END)AS Sex
		  ,UM.RefNo
		  --,CONVERT(nvarchar,UM.Age,10) + ' Age' AS Age 
		  ,UM.Age
		  ,UM.Address
		  ,CONVERT(NVARCHAR(10),UM.DOA,101) AS DOA
		  ,CONVERT(NVARCHAR(10),UM.DOD,101) AS DOD
		  ,UM.CausesDeath As CausesDeath
		  ,UM.CreatedBy
		  ,UM.CreateDate
		  
			FROM dbo.DeathsDetails AS UM
			WHERE (@SearchText = '' OR UM.Decease LIKE '%' + @SearchText + '%')
			AND
				(@Htype = 0 OR UM.Htype = @Htype)
			AND
				(UM.StateId = @StateId)
			AND
				(UM.CompanyId = @CompanyId)	 
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetDeathsMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Win_GetDeathsMaster 1
CREATE PROCEDURE [dbo].[Win_GetDeathsMaster]
@RecId bigint
AS
BEGIN
	SELECT UM.RecId
		  ,UM.Htype
		  ,UM.Decease
		  ,UM.Age
		  ,UM.Sex
		  ,UM.RefNo
		  ,CONVERT(NVARCHAR(10),UM.DOA,101) AS DOA
		  ,CONVERT(NVARCHAR(10),UM.DOD,101) AS DOD
		  ,UM.Address
		  ,UM.CompanyId
		  ,UM.StateId
		  ,UM.CausesDeath
		  ,UM.CreatedBy
		  ,UM.CreateDate
	FROM [dbo].[DeathsDetails] AS UM
	WHERE (UM.RecId = @RecId)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetDentalProcedure]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <14 Oct 2019>
-- Description:	<GET DENTAL PROCEDURE>
-- =============================================
-- execute [Win_GetDentalProcedure] 1,1,'OMIT-1-PC',10,2019,160
CREATE PROCEDURE [dbo].[Win_GetDentalProcedure]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int
AS
BEGIN
	SELECT DM.SrNo As RecId
	   ,[DProcedure] As ServiceName
       ,D.[M012]
       ,D.[F012]
       ,D.[M1359]
       ,D.[F1359]
       ,D.[M60]
       ,D.[F60]
       ,(IsNull(D.[M012],0) +IsNull(D.[M1359],0)+IsNull(D.[M60],0)) AS [Mtot]
       ,(IsNull(D.[F012],0)+IsNull(D.[F1359],0)+IsNull(D.[F60],0)) AS [Ftot]
       --,(IsNull(D.[M012],0) +IsNull(D.[F012],0)+IsNull(D.[M1359],0)+IsNull(D.[F1359],0)+IsNull(D.[M60],0)+IsNull(D.[F60],0)) AS Total
    FROM dbo.DentalMaster AS DM
    LEFT OUTER JOIN Dental AS D
    ON D.RefSrNo = DM.SrNo
    AND(D.CompanyId = @CompanyId)
	--AND(D.StateId = @StateId)
	--And (D.Machine = @Machine)
	AND(D.CMonth = @CMonth)
	AND(D.CYear = @CYear)
	AND(D.Htype = @Htype)
	 
	UNION ALL
	SELECT 25 As RecId
	   ,'TOTAL' As ServiceName
       ,SUM(isnull(D.[M012],0)) AS M012 
       ,SUM(isnull(D.[F012],0)) AS F012
       ,SUM(isnull(D.[M1359],0)) AS M1359
       ,SUM(isnull(D.[F1359],0)) AS F1359 
       ,SUM(isnull(D.[M60],0)) AS M60
       ,SUM(isnull(D.[F60],0)) AS F60
       ,SUM(IsNull(D.[M012],0) +IsNull(D.[M1359],0)+IsNull(D.[M60],0)) AS [Mtot]
       ,SUM(IsNull(D.[F012],0)+IsNull(D.[F1359],0)+IsNull(D.[F60],0)) AS [Ftot]
       --,SUM(IsNull(D.[M012],0) +IsNull(D.[F012],0)+IsNull(D.[M1359],0)+IsNull(D.[F1359],0)+IsNull(D.[M60],0)+IsNull(D.[F60],0)) AS Total
     FROM Dental AS D
     WHERE (D.CompanyId = @CompanyId)
	 --AND(D.StateId = @StateId)
	 --And (D.Machine = @Machine)
	 AND(D.CMonth = @CMonth)
	 AND(D.CYear = @CYear)
	 AND(D.Htype = @Htype)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetHospitalDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Web_GetHospitalDrp 1
CREATE PROCEDURE [dbo].[Win_GetHospitalDrp]
@UserId Bigint
AS
BEGIN
	Declare @CompanyId as bigint
	SELECT @CompanyId=CompanyId From dbo.UserMaster Where RecId =@UserId 
	--if(@CompanyId=-1)
	--	BEGIN
			--SET @CompanyId=-1	
				SELECT 0 AS RecId,'--SELECT--' AS CName
				UNION ALL
				SELECT UM.RecId
					  ,UM.CName
				FROM dbo.CompanyMaster AS UM
				WHERE UM.IsActive=1 AND (@CompanyId=-1 OR @CompanyId=UM.RecId)
	--	END
	--ELSE
	--	BEGIN
	--		SELECT UM.RecId
	--			  ,UM.CName
	--			FROM dbo.CompanyMaster AS UM
	--			WHERE UM.IsActive=1 AND (@CompanyId=UM.RecId)
	--	END
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetHospitalDrpReport]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Win_GetHospitalDrpReport
CREATE PROCEDURE [dbo].[Win_GetHospitalDrpReport]
@CompanyId Bigint,
@userType Bigint
AS
BEGIN
	if(@userType=3)  SET @CompanyId=0
	if(@CompanyId>0)
	BEGIN
		SELECT UM.RecId
			  ,UM.CName
		FROM dbo.CompanyMaster AS UM
		WHERE UM.IsActive=1 AND RecId =@CompanyId 
	END
	ELSE
	BEGIN		
		SELECT UM.RecId
			  ,UM.CName
		FROM dbo.CompanyMaster AS UM
		WHERE UM.IsActive=1
	END
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetHospitalList]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Win_GetHospitalList ''
CREATE PROCEDURE [dbo].[Win_GetHospitalList]
@SearchText nvarchar(200)
AS
BEGIN
	SELECT UM.RecId
		  ,UM.CName
		  ,UM.City
		  ,UM.State
		  ,(select StateName FROM dbo.StateMaster WHERE RecId = UM.State) As StateName
		  ,UM.Contact
		  ,UM.Email
		  ,UM.CGuid
		  ,UM.Logo
		  ,UM.IsActive
		  ,(Case When UM.IsActive =1 THEN 'Active' Else 'DeActive' End) AS IsActive_W
		  ,(Case When UM.IsActive = 1 THEN 'far fa-check-circle mr-1' Else 'far fa-times-circle mr-1' END) AS IsActiveCss_W
	FROM dbo.CompanyMaster AS UM
	WHERE (@SearchText = ''
	OR UM.CName LIKE '%' + @SearchText + '%'
	OR UM.Contact LIKE '%' + @SearchText + '%'
	OR UM.CGuid LIKE '%' + @SearchText + '%'
	OR UM.City LIKE '%' + @SearchText + '%'
	--OR UM.State LIKE '%' + @SearchText + '%'
	OR UM.Email LIKE '%' + @SearchText + '%')
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetLiveBirthWeight]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <28 Sept 2019>
-- Description:	<Get Live Birth Weight Data.>
-- =============================================
-- execute Win_GetLiveBirthWeight 1,1,'OMIT-2',10,2019,170
CREATE PROCEDURE [dbo].[Win_GetLiveBirthWeight]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int
AS
BEGIN
		SELECT LM.SrNo As RecId
			,LM.LiveBirthWeight As ServiceName
			,LW.Male
			,LW.Female 
		FROM dbo.LiveBirthWeightMaster AS LM
		LEFT OUTER JOIN LiveBirthWeight AS LW
		ON LW.RefSrno = LM.SrNo
		AND(LW.CompanyId = @CompanyId)
		--AND(LW.StateId = @StateId)
		--And (HB.Machine = @Machine)
		AND(LW.CMonth = @CMonth)
		AND(LW.CYear = @CYear)
		AND(LW.Htype = @Htype) 
	UNION ALL
		SELECT 14 As RecId
		,'TOTAL' As ServiceName
		,SUM(isnull(LW.Male,0)) AS Male
		,SUM(isnull(LW.Female,0)) AS Female
		FROM dbo.LiveBirthWeight AS LW
		WHERE (LW.CompanyId = @CompanyId)
		--AND(LW.StateId = @StateId)
		AND(LW.CMonth = @CMonth)
		AND(LW.CYear = @CYear)
		AND(LW.Htype = @Htype)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetLogin]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Win_GetLogin 'admin','admin'
-- Execute Win_GetLogin 'superadmin','superadmin'
CREATE PROCEDURE [dbo].[Win_GetLogin]
@UserId nvarchar(50),
@PWD nvarchar(50)
AS
BEGIN
	DECLARE @StateId AS BIGINT
	DECLARE @StateName AS NVARCHAR(200)
	
	SELECT TOP 1 @StateId = CM.State FROM dbo.CompanyMaster AS CM 
	SELECT TOP 1 @StateName = SM.StateName FROM dbo.StateMaster AS SM WHERE SM.RecId = @StateId
	
	SELECT UM.RecId
		  ,UM.UserId
		  ,UM.PWD
		  ,UM.UserName
		  --,@StateId AS StateId
		  ,UM.State AS StateId -- Chnage by Jaydip : As Per Web(sp).
		  ,@StateName AS StateName
		  ,CONVERT(NVARCHAR(10),UM.DOB,101) AS DOB
		  ,(CASE WHEN UM.Gender = 1 THEN 'Male' WHEN UM.Gender = 2 THEN 'Female' ELSE '' END)AS Gender
		  ,UM.EmailId
		  ,UM.Contact
		  ,UM.UserType
		  ,UM.IsActive
		  ,UM.CompanyId
	FROM dbo.UserMaster AS UM
	WHERE (UM.UserId = @UserId)
		   AND
		  (UM.PWD = @PWD)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetMaternalHealth]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <28 Sept 2019>
-- Description:	<Get Maternal Health Data.>
-- =============================================
-- execute [Web_GetMaternalHealth] 1,1,'',10,2019,165
CREATE PROCEDURE [dbo].[Win_GetMaternalHealth]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int
AS
BEGIN
	SELECT MM.[SrNo] As RecId
	  ,CASE WHEN MM.[SrNo] in (40) THEN REPLACE(MM.[Description],' ','&nbsp;')
			WHEN MM.[SrNo] in (41,42,43) THEN '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + REPLACE(MM.[Description],' ','&nbsp;')
			ELSE MM.[Description] END AS ServiceName
      ,MH.[Result]
    FROM [dbo].[MaternalHealthMaster] AS MM
    LEFT OUTER JOIN  MaternalHealth AS MH
    ON MH.RefSrNo = MM.SrNo
    AND(MH.CompanyId = @CompanyId)
	--AND(MH.StateId = @StateId)
	--And (HB.Machine = @Machine)
	AND(MH.CMonth = @CMonth)
	AND(MH.CYear = @CYear)
	AND(MH.Htype = @Htype)
	UNION ALL
	SELECT 33 As RecId
	  ,'Total' AS ServiceName
      ,SUM(isnull(MH.[Result],0)) AS Result
    FROM MaternalHealth AS MH    
    WHERE (MH.CompanyId = @CompanyId)
	--AND(MH.StateId = @StateId)	
	AND(MH.CMonth = @CMonth)
	AND(MH.CYear = @CYear)
	AND(MH.Htype = @Htype)
	order by RecId
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetMonthDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <30 June 2019>
-- =============================================
-- Execute Win_GetMonthDrp
CREATE PROCEDURE [dbo].[Win_GetMonthDrp]

AS
BEGIN	
	SELECT 'January' AS MontName,1 AS MonthId
	UNION ALL
	SELECT 'February' AS MontName,2 AS MonthId
	UNION ALL
	SELECT 'March' AS MontName,3 AS MonthId
	UNION ALL
	SELECT 'April' AS MontName,4 AS MonthId
	UNION ALL
	SELECT 'May' AS MontName,5 AS MonthId
	UNION ALL
	SELECT 'June' AS MontName,6 AS MonthId
	UNION ALL
	SELECT 'July' AS MontName,7 AS MonthId
	UNION ALL
	SELECT 'August' AS MontName,8 AS MonthId
	UNION ALL
	SELECT 'September' AS MontName,9 AS MonthId
	UNION ALL
	SELECT 'October' AS MontName,10 AS MonthId
	UNION ALL
	SELECT 'November' AS MontName,11 AS MonthId
	UNION ALL
	SELECT 'December' AS MontName,12 AS MonthId	
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetPatientAdmitOutcomes]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <12 OCt 2019>
-- Description:	<Patient Hospital InCome - Outcome>
-- =============================================
-- execute [Win_GetPatientAdmitOutcomes] 1,1,'',10,2019,150
CREATE PROCEDURE [dbo].[Win_GetPatientAdmitOutcomes]
	@CompanyId bigint,
	@StateId bigint,
	@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@Htype int
AS
BEGIN
	SELECT IM.SRNO AS RecId
		  ,0 AS SMRecId	
		  ,IM.BEDCOMPLEMENT As ServiceName
		  ,IC.MALE
		  ,IC.FEMALE
		  ,(isnull(IC.MALE,0) + isnull(IC.FEMALE,0)) AS TOTAL 
	FROM dbo.IPDOutcomeMaster AS IM
	LEFT OUTER JOIN dbo.IPDOutcome AS IC
	ON IC.RefSrNo = IM.SrNo 
	AND (IC.CompanyId = @CompanyId)
	--And (IC.StateId = @StateId)
	--And (HB.Machine = @Machine)
	And (IC.CMonth = @CMonth)
	And (IC.CYear = @CYear)
	AND (IC.Htype = @Htype)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetPermission]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <10 Aug 2019>
-- =============================================
-- Execute Win_GetPermission 0
-- Execute Win_GetPermission 1
-- Execute Win_GetPermission 2
CREATE PROCEDURE [dbo].[Win_GetPermission]
@TypeId bigint
AS
BEGIN
	SELECT PM.MenuId,isnull(MM.PMenuId,0) AS PMenuId
	FROM dbo.PermissionMaster AS PM
	INNER JOIN DBO.MenuMaster AS MM
	ON MM.MenuId =PM.MenuId 
	WHERE PM.TypeId = @TypeId AND PM.IsActive =1
	--and PM.MenuId =65
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetQuarterlyDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <30 June 2019>
-- =============================================
-- Execute Win_GetQuarterlyDrp
CREATE PROCEDURE [dbo].[Win_GetQuarterlyDrp]

AS
BEGIN
	SELECT '1st Quarter' AS QuarterName,1 AS QuarterId
	UNION ALL
	SELECT '2nd Quarter' AS QuarterName,2 AS QuarterId
	UNION ALL
	SELECT '3rd Quarterly' AS QuarterName,3 AS QuarterId
	
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetServicesDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Win_GetServicesDrp
CREATE PROCEDURE [dbo].[Win_GetServicesDrp]

AS
BEGIN
	SELECT 0 AS RecId,'--Select--' AS ServiceName
	UNION ALL
	SELECT RecId,ServiceName
	FROM dbo.ServicesMaster
	WHERE (IsActive = 1)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetServicesList]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Win_GetServicesList ''
CREATE PROCEDURE [dbo].[Win_GetServicesList]
@SearchText nvarchar(200)
AS
BEGIN
	SELECT SM.RecId
		  ,SM.ParentId
		  ,SM.ServiceName
		  ,ISNULL((SELECT SM1.ServiceName
		   FROM dbo.ServicesMaster AS SM1
		   WHERE SM1.RecId = SM.ParentId),'') AS ParentServiceName
		  ,SM.Description
		  ,SM.SortOrd
		  ,SM.IsActive
		  ,SM.CreatedBy
		  ,SM.CreateDate
		  ,(Case When SM.IsActive =1 THEN 'Active' Else 'DeActive' End) AS IsActive_W
		  ,(Case When SM.IsActive = 1 THEN 'far fa-check-circle mr-1' Else 'far fa-times-circle mr-1' END) AS IsActiveCss_W
	FROM dbo.ServicesMaster AS SM
	WHERE (@SearchText = ''
	OR SM.ServiceName LIKE '%' + @SearchText + '%'
	OR SM.Description LIKE '%' + @SearchText + '%')
	ORDER BY SM.SortOrd
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetServicesMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Win_GetServicesMaster 1
CREATE PROCEDURE [dbo].[Win_GetServicesMaster]
@RecId bigint
AS
BEGIN
	SELECT SM.RecId
		  ,SM.ParentId
		  ,SM.ServiceName
		  ,SM.Description
		  ,SM.SortOrd
		  ,SM.IsActive
		  ,SM.CreatedBy
		  ,SM.CreateDate
	FROM dbo.ServicesMaster AS SM
	WHERE SM.RecId = @RecId
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetStateDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Win_GetStateDrp
CREATE PROCEDURE [dbo].[Win_GetStateDrp]

AS
BEGIN
	SELECT 0 AS RecId,'--Select--' AS StateName
	UNION ALL
	SELECT RecId,StateName
	FROM dbo.StateMaster
	WHERE (IsActive = 1)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetStateList]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Win_GetStateList ''
CREATE PROCEDURE [dbo].[Win_GetStateList]
@SearchText nvarchar(200)
AS
BEGIN
	SELECT ST.RecId
		  ,ST.StateName
		  ,ST.Description
		  ,ST.IsActive
		  ,ST.CreatedBy
		  ,(Case When ST.IsActive =1 THEN 'Active' Else 'DeActive' End) AS IsActive_W
		  ,(Case When ST.IsActive = 1 THEN 'far fa-check-circle mr-1' Else 'far fa-times-circle mr-1' END) AS IsActiveCss_W
		  ,ST.CreateDate
	FROM dbo.StateMaster AS ST
	WHERE (@SearchText = ''
	OR ST.StateName LIKE '%' + @SearchText + '%'
	OR ST.Description LIKE '%' + @SearchText + '%')
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetStateMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Win_GetStateMaster 1
CREATE PROCEDURE [dbo].[Win_GetStateMaster]
@RecId bigint
AS
BEGIN
	SELECT ST.RecId
		  ,ST.StateName
		  ,ST.Description
		  ,ST.IsActive
		  ,ST.CreatedBy
		  ,ST.CreateDate
	FROM dbo.StateMaster AS ST
	WHERE ST.RecId = @RecId
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetUserList]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Win_GetUserList '',1
CREATE PROCEDURE [dbo].[Win_GetUserList]
@SearchText nvarchar(200),
@UserId Bigint
AS
BEGIN
	
	Declare @CompanyId as bigint
	Declare @UserType as bigint
	SELECT @UserType=UserType,@CompanyId=CompanyId From dbo.UserMaster Where RecId =@UserId 
	if(@UserType=1)
	BEGIN
		SET @CompanyId=-1	
	END

	SELECT UM.RecId
		  ,UM.UserId
		  ,UM.PWD
		  ,UM.UserName
		  ,CONVERT(NVARCHAR(10),UM.DOB,101) AS DOB
		  ,(CASE WHEN UM.Gender = 1 THEN 'Male' WHEN UM.Gender = 2 THEN 'Female' ELSE '' END)AS Gender
		  ,UM.EmailId
		  ,UM.Contact
		  ,UM.Address
		  ,UM.City
		  ,UM.State
		  ,UM.ZipCode
		  ,UM.ProfilePic
		  ,UM.UserType
		  ,(SELECT TOP 1 UTM.TypeName FROM dbo.UserTypeMaster AS UTM WHERE UTM.TypeId = UM.UserType) AS UserTypeName
		  ,UM.IsActive
		  ,UM.CompanyId
		  --,(select CName from dbo.CompanyMaster where RecId=UM.CompanyId) As CompanyName
		  ,(CASE WHEN UM.CompanyId = 0 THEN 'All' ELSE (select CName from dbo.CompanyMaster where RecId=UM.CompanyId) END) AS CompanyName
		  ,UM.CreatedBy
		  ,UM.CreateDate
		  
	FROM dbo.UserMaster AS UM
	WHERE (@SearchText = ''
	OR UM.UserId LIKE '%' + @SearchText + '%'
	OR UM.UserName LIKE '%' + @SearchText + '%'
	OR UM.EmailId LIKE '%' + @SearchText + '%'
	OR UM.Contact LIKE '%' + @SearchText + '%'
	OR UM.Address LIKE '%' + @SearchText + '%'
	OR UM.City LIKE '%' + @SearchText + '%'
	OR UM.State LIKE '%' + @SearchText + '%'
	OR UM.ZipCode LIKE '%' + @SearchText + '%')
	AND (@CompanyId=-1 OR @CompanyId=UM.CompanyId)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetUserMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <29 June 2019>
-- =============================================
-- Execute Win_GetUserMaster 1
CREATE PROCEDURE [dbo].[Win_GetUserMaster]
@RecId bigint
AS
BEGIN
	SELECT UM.RecId
		  ,UM.UserId
		  ,UM.PWD
		  ,UM.UserName
		  ,CONVERT(NVARCHAR(10),UM.DOB,101) AS DOB
		  ,UM.Gender
		  ,UM.EmailId
		  ,UM.Contact
		  ,UM.Address
		  ,UM.City
		  ,UM.State
		  ,UM.ZipCode
		  ,UM.CompanyId
		  ,UM.ProfilePic
		  ,UM.UserType
		  ,UM.IsActive
		  ,UM.CreatedBy
		  ,UM.CreateDate
	FROM dbo.UserMaster AS UM
	WHERE (UM.RecId = @RecId)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetUserPermission]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <14 Aug 2019>
-- =============================================
-- Execute Win_GetUserPermission 0
-- Execute Win_GetUserPermission 1
-- Execute Win_GetUserPermission 2
-- Execute Win_GetUserPermission 3
-- Execute Win_GetUserPermission 4
CREATE PROCEDURE [dbo].[Win_GetUserPermission]
@TypeId bigint
AS
BEGIN
	SELECT MM.MenuName
		  ,MM.MenuId
		  ,ISNULL(PM.IsActive,0) AS PMIsActive
		  ,PM.IsActive AS PMIsActive
		  ,MM.RecId AS MMRecId
		  ,ISNULL(PM.RecId,0) AS PMRecId
	FROM dbo.MenuMaster AS MM
	LEFT OUTER JOIN dbo.PermissionMaster AS PM
	ON MM.MenuId = PM.MenuId AND PM.TypeId = @TypeId 
	WHERE @TypeId <> 0 
	and MM.isactive=1
	order by Case when MenuName like 'REPORT%' then 100 else 1 end 
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetUserTypeDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <10 Aug 2019>
-- =============================================
-- Execute Win_GetUserTypeDrp 2
CREATE PROCEDURE [dbo].[Win_GetUserTypeDrp]
@TypeId bigint
AS
BEGIN
	SELECT 0 AS TypeId,'-- Select --' AS TypeName
	UNION ALL
	SELECT UT.TypeId,UT.TypeName
	FROM dbo.UserTypeMaster AS UT
	WHERE UT.IsActive = 1
	AND ((@TypeId=2 AND (UT.TypeId=2 OR UT.TypeId =4))
	OR (@TypeId=3 AND UT.TypeId=3)
	OR (@TypeId=1 AND (UT.TypeId =1 OR UT.TypeId =2 OR UT.TypeId =3 OR UT.TypeId =4))
	OR (UT.TypeId = @TypeId))
	
END
GO
/****** Object:  StoredProcedure [dbo].[Win_GetYearDrp]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <30 June 2019>
-- =============================================
-- Execute Win_GetYearDrp
CREATE PROCEDURE [dbo].[Win_GetYearDrp]

AS
BEGIN
	;WITH CTE
	AS
	(
		SELECT YearID = 2018
		UNION ALL
		SELECT YearID = YearID + 1
		FROM CTE WHERE YearID < YEAR(GETDATE())
	)
	SELECT YearID AS YearName,YearID
	FROM CTE
END
GO
/****** Object:  StoredProcedure [dbo].[Win_SaveBlindnessPrevProg]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <12 Oct 2019>
-- =============================================
-- execute [Win_SaveBlindnessPrevProg] 1,0,1,1,9,2019,'Cradles',7,2
CREATE PROCEDURE [dbo].[Win_SaveBlindnessPrevProg]
	@RecId bigint,
	@ServiceId bigint,
	@CompanyId bigint,
	@StateId bigint,
	--@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@CDay nvarchar(100),
	@CVal int,
	@CreatedBy bigint,
	@Htype int
	
AS
BEGIN

	DECLARE @COMID AS BIGINT
	SELECT @COMID=CompanyId FROM dbo.UserMaster WHERE RecId =@CreatedBy
	DECLARE @MACHINE AS NVARCHAR(120)
	SELECT @MACHINE=HOST_NAME()
	DECLARE @Q AS NVARCHAR(Max)
	IF (@RecId > 0)
	/*BEGIN
	   SELECT @Q=N'Update [dbo].[HospitalBeds] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE SrNo ='+ convert(nvarchar(10),@RecId) +'and CompanyId='+convert(nvarchar(10),@COMID) 
	END*/
	--AND CD.StateId=@StateId 
	IF EXISTS(SELECT 1 FROM DBO.Blindness AS CD WHERE CD.RefSrNo =@RecId AND CD.CYear =@CYear AND CD.CMonth =@CMonth AND CD.COMPANTID=@COMID AND CD.Htype = @Htype)
	BEGIN
	--+ ' AND StateId=' + convert(nvarchar(10),@StateId) 
	SELECT @Q=N'Update [dbo].[Blindness] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE RefSrNo =' + convert(nvarchar(10),@RecId) + ' AND CYear = ' + convert(nvarchar(10),@CYear) + ' AND CMonth = ' + convert(nvarchar(10),@CMonth) + ' AND COMPANTID=' + convert(nvarchar(10),@COMID) + 'AND Htype = ' + convert(nvarchar(10),@Htype) 
	END
	ELSE
	BEGIN
	   SELECT @Q=N'INSERT INTO [dbo].[Blindness]([RefSrNo],[ServiceId],[COMPANTID],[StateId],[CMonth],[CYear],['+ @CDay +'],[CreatedBy],[Machine],[Htype])VALUES ('+ convert(nvarchar(10),@RecId) +','+ convert(nvarchar(10),@ServiceId) +','+ convert(nvarchar(10),@CompanyId) +','+ convert(nvarchar(10),@StateId) + ',' + convert(nvarchar(10),@CMonth) +','+ convert(nvarchar(10),@CYear) + ',' + convert(nvarchar(10),@CVal) + ',' + convert(nvarchar(10),@CreatedBy) + ',''' + @MACHINE + ''',' + CONVERT(nvarchar(10),@Htype) +')'	
	END
	EXECUTE(@Q)
	--PRINT(@Q)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_SaveCaseDetail]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <01 July 2019>
-- =============================================
-- Execute Win_SaveCaseDetail 0,2,1,1,07,2019,'Date1',1,1,1
/*
Execute Web_SaveCaseDetail 0,1,1,1,1,7,2019,'Date13',0,4,1
{"RecId":0,"ServiceId":1,"HType":1,"CaseType":1,"Gender":1,"CMonth":7,"CYear":2019,"CDay":13,"CVal":0,"CreatedBy":4,"StateId":1}
*/
CREATE PROCEDURE [dbo].[Win_SaveCaseDetail]
@RecId bigint,
@ServiceId bigint,
@CaseType int,
@HType int,
@Gender int,
@CMonth int,
@CYear int,
@CDay nvarchar(100),
@CVal int,
@CreatedBy bigint,
@StateId bigint
AS
BEGIN

	DECLARE @COMID AS BIGINT
	SELECT @COMID=CompanyId FROM dbo.UserMaster WHERE RecId =@CreatedBy
	DECLARE @MACHINE AS NVARCHAR(120)
	SELECT @MACHINE=HOST_NAME()
	DECLARE @Q AS NVARCHAR(Max)
	IF (@RecId > 0)
	BEGIN
		SELECT @Q=N'Update [dbo].[CaseDetail] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE RecId ='+ convert(nvarchar(10),@RecId) +'and CompanyId='+convert(nvarchar(10),@COMID) 
	END
	--AND CD.StateId=@StateId
	ELSE IF EXISTS(SELECT 1 FROM DBO.CaseDetail AS CD WHERE CD.ServiceId =@ServiceId AND CD.CYear =@CYear AND CD.CMonth =@CMonth AND CD.HType =@HType AND CD.CaseType=@CaseType AND CD.Gender=@Gender AND CD.CompanyId=@COMID)
	BEGIN
		--+ ' AND StateId=' + convert(nvarchar(10),@StateId) 
		SELECT @Q=N'Update [dbo].[CaseDetail] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE ServiceId =' + convert(nvarchar(10),@ServiceId) + ' AND CYear = ' + convert(nvarchar(10),@CYear) + ' AND CMonth = ' + convert(nvarchar(10),@CMonth) + ' AND CaseType=' + convert(nvarchar(10),@CaseType) +' AND Gender=' + convert(nvarchar(10),@Gender) + ' AND HType=' + convert(nvarchar(10),@HType) + ' AND CompanyId=' + convert(nvarchar(10),@COMID)
	END
	ELSE
	BEGIN
		SELECT @Q=N'INSERT INTO [dbo].[CaseDetail]([ServiceId],[HType],[CaseType],[Gender],[CMonth],[CYear],[CreatedBy],['+ @CDay +'],[StateId],[CompanyId],[Machine])VALUES ('+ convert(nvarchar(10),@ServiceId) +','+ convert(nvarchar(10),@HType) +','+ convert(nvarchar(10),@CaseType) + ',' + convert(nvarchar(10),@Gender) + ',' + convert(nvarchar(10),@CMonth) +','+ convert(nvarchar(10),@CYear) + ',' + convert(nvarchar(10),@CreatedBy) + ',' + convert(nvarchar(10),@CVal) + ',' + convert(nvarchar(10),@StateId) +',' + CONVERT(nvarchar(20),@COMID) + ',''' + @MACHINE + ''')'
	END
	EXECUTE(@Q)
	--PRINT(@Q)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_SaveCompanyMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <02 July 2019>
-- =============================================
-- Execute Win_SaveCompanyMaster 3,'sdsdffsdf-ABCD','sdfsfdsfsf@gmail.com',17,'1234567890','sdfsfdsfsf@gmail.com',1,'',1,'test1','test2','test3'
CREATE PROCEDURE [dbo].[Win_SaveCompanyMaster]
	@RecId bigint,
	@CName nvarchar(100),
	@City nvarchar(100),
	@State bigint,
	@Contact nvarchar(50),
	@Email nvarchar(50),
	@IsActive int,
	@LogoString ntext,
	@CreatedBy bigint,
	@ReportTitle1 nvarchar(500),
	@ReportTitle2 nvarchar(500),
	@ReportTitle3 nvarchar(500)
AS
BEGIN
	IF(@RecId = 0)
		BEGIN
			INSERT INTO [dbo].[CompanyMaster]
					   ([CName]
					   ,[City]
					   ,[State]
					   ,[Contact]
					   ,[Email]
					   ,[Logo]
					   ,[IsActive]
					   ,[CreatedBy]
					   ,[CreateDate]
					   ,[Header1]
					   ,[Header2]
					   ,[Header3])
				 VALUES
					   (@CName
					   ,@City
					   ,@State
					   ,@Contact
					   ,@Email
					   ,@LogoString
					   ,@IsActive
					   ,@CreatedBy
					   ,GETDATE()
					   ,@ReportTitle1
					   ,@ReportTitle2
					   ,@ReportTitle3)
			SELECT @RecId = SCOPE_IDENTITY()
		END	
	 ELSE
		BEGIN
			if(@LogoString is null or convert(nvarchar(10),@LogoString)='')
			BEGIN
				SELECT @LogoString=LOGO FROM [dbo].[CompanyMaster] WHERE RecId =@RecId 
			END
			
			UPDATE [dbo].[CompanyMaster]
				SET [CName] = @CName
				  ,[City] = @City
				  ,[State] = @State
				  ,[Contact] = @Contact
				  ,[Email] = @Email
				  ,[Logo] = @LogoString
				  ,[Header1]=@ReportTitle1
				  ,[Header2]=@ReportTitle2
			      ,[Header3]=@ReportTitle3
			 WHERE [RecId] = @RecId
			 
			 UPDATE DBO.UserMaster 
			 SET State =@State
			 WHERE CompanyId =@RecId 
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Win_SaveDeathsDetails]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <02 July 2019>
-- =============================================
-- Execute Win_SaveDeathsDetails
CREATE PROCEDURE [dbo].[Win_SaveDeathsDetails]
@RecId bigint,
@Htype int,
@StateId bigint,
@CompanyId bigint,
@Decease nvarchar(200),
@Sex int,
@Age int,
@Address nvarchar(250),
@DOA datetime,
@DOD datetime,
@CausesDeath nvarchar(500),
@CreatedBy bigint,
@RefNo nvarchar(150),
@Machine nvarchar(250)
AS
BEGIN
	
	IF(@RecId = 0)
		BEGIN
			INSERT INTO [dbo].[DeathsDetails]
					   ([Htype]
					   ,[StateId]
					   ,[CompanyId]
					   ,[Decease]
					   ,[Sex]
					   ,[Age]
					   ,[RefNo]
					   ,[Address]
					   ,[DOA]
					   ,[DOD]
					   ,[CausesDeath]
					   ,[CreatedBy]
					   ,[CreateDate]
					   ,[Machine] )
				 VALUES
					   (@Htype
					   ,@StateId
					   ,@CompanyId
					   ,@Decease
					   ,@Sex
					   ,@Age
					   ,@RefNo
					   ,@Address
					   ,@DOA
					   ,@DOD
					   ,@CausesDeath
					   ,@CreatedBy
					   ,GETDATE()
					   ,@Machine)
			--SELECT @RecId = SCOPE_IDENTITY()	   
		END
	ELSE
		BEGIN
			UPDATE [dbo].[DeathsDetails]
			   SET [Htype] = @Htype
				  ,[Decease] =  @Decease
				  ,[Sex] = @Sex
				  ,[Age] = @Age
				  ,[RefNo] = @RefNo
				  ,[Address] = @Address
				  ,[DOA] = @DOA
				  ,[DOD] = @DOD
				  ,[CausesDeath] = @CausesDeath
				  ,[CreatedBy] = @CreatedBy
				  ,[Machine] = @Machine 
			 WHERE [RecId] = @RecId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Win_SaveDentalProcedure]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <14 Oct 2019>
-- =============================================
-- execute Win_SaveDentalProcedure 1,0,1,1,9,2019,'Cradles',7,2
CREATE PROCEDURE [dbo].[Win_SaveDentalProcedure]
	@RecId bigint,
	@ServiceId bigint,
	@CompanyId bigint,
	@StateId bigint,
	--@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@CDay nvarchar(100),
	@CVal int,
	@CreatedBy bigint,
	@Htype int
	
AS
BEGIN

	DECLARE @COMID AS BIGINT
	SELECT @COMID=CompanyId FROM dbo.UserMaster WHERE RecId =@CreatedBy
	DECLARE @MACHINE AS NVARCHAR(120)
	SELECT @MACHINE=HOST_NAME()
	DECLARE @Q AS NVARCHAR(Max)
	IF (@RecId > 0)
	/*BEGIN
	   SELECT @Q=N'Update [dbo].[HospitalBeds] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE SrNo ='+ convert(nvarchar(10),@RecId) +'and CompanyId='+convert(nvarchar(10),@COMID) 
	END*/
	--CD.StateId=@StateId AND 
	IF EXISTS(SELECT 1 FROM DBO.Dental AS CD WHERE CD.RefSrNo =@RecId AND CD.CYear =@CYear AND CD.CMonth =@CMonth AND CD.CompanyId=@COMID AND CD.Htype = @Htype)
	BEGIN
	--+ ' AND StateId=' + convert(nvarchar(10),@StateId) 
	SELECT @Q=N'Update [dbo].[Dental] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE RefSrNo =' + convert(nvarchar(10),@RecId) + ' AND CYear = ' + convert(nvarchar(10),@CYear) + ' AND CMonth = ' + convert(nvarchar(10),@CMonth) + ' AND CompanyId=' + convert(nvarchar(10),@COMID) + 'AND Htype=' +CONVERT(nvarchar(10),@Htype)
	END
	ELSE
	BEGIN
	   SELECT @Q=N'INSERT INTO [dbo].[Dental]([RefSrNo],[ServiceId],[CompanyId],[StateId],[CMonth],[CYear],['+ @CDay +'],[CreatedBy],[Machine],[Htype])VALUES ('+ convert(nvarchar(10),@RecId) +','+ convert(nvarchar(10),@ServiceId) +','+ convert(nvarchar(10),@CompanyId) +','+ convert(nvarchar(10),@StateId) + ',' + convert(nvarchar(10),@CMonth) +','+ convert(nvarchar(10),@CYear) + ',' + convert(nvarchar(10),@CVal) + ',' + convert(nvarchar(10),@CreatedBy) + ',''' + @MACHINE + ''',' + CONVERT(nvarchar(10),@Htype) +')'	
	END
	EXECUTE(@Q)
	--PRINT(@Q)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_SaveHospitalBedsDetails]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <28 Sept 2019>
-- =============================================
-- execute [Win_SaveHospitalBedsDetails] 1,0,1,1,9,2019,'Beds',7,2,150
CREATE PROCEDURE [dbo].[Win_SaveHospitalBedsDetails]
	@RecId bigint,
	@ServiceId bigint,
	@CompanyId bigint,
	@StateId bigint,
	--@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@CDay nvarchar(100),
	@CVal int,
	@CreatedBy bigint,
	@Htype int
AS
BEGIN

	DECLARE @COMID AS BIGINT
	SELECT @COMID=CompanyId FROM dbo.UserMaster WHERE RecId =@CreatedBy
	DECLARE @MACHINE AS NVARCHAR(120)
	SELECT @MACHINE=HOST_NAME()
	DECLARE @Q AS NVARCHAR(Max)
	IF (@RecId > 0)
	--AND CD.StateId=@StateId 
	IF EXISTS(SELECT 1 FROM DBO.HospitalBeds AS CD WHERE CD.RefSrNo =@RecId AND CD.CYear =@CYear AND CD.CMonth =@CMonth AND CD.CompanyId=@COMID AND CD.Htype = @Htype) 
		BEGIN	
		--+ ' AND StateId=' + convert(nvarchar(10),@StateId) 
			SELECT @Q=N'Update [dbo].[HospitalBeds] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE RefSrNo =' + convert(nvarchar(10),@RecId) + ' AND CYear = ' + convert(nvarchar(10),@CYear) + ' AND CMonth = ' + convert(nvarchar(10),@CMonth) + ' AND CompanyId=' + convert(nvarchar(10),@COMID) + ' AND Htype='+ convert(nvarchar(10),@Htype)		
		END
	ELSE
		BEGIN
			SELECT @Q=N'INSERT INTO [dbo].[HospitalBeds]([RefSrNo],[ServiceId],[CompanyId],[StateId],[CMonth],[CYear],['+ @CDay +'],[CreatedBy],[Machine],[Htype])VALUES ('+ convert(nvarchar(10),@RecId) +','+ convert(nvarchar(10),@ServiceId) +','+ convert(nvarchar(10),@CompanyId) +','+ convert(nvarchar(10),@StateId) + ',' + convert(nvarchar(10),@CMonth) +','+ convert(nvarchar(10),@CYear) + ',' + convert(nvarchar(10),@CVal) + ',' + convert(nvarchar(10),@CreatedBy) + ',''' + @MACHINE + ''',' +  convert(nvarchar(10),@Htype) +')'	
		END
	EXECUTE(@Q)
	--PRINT(@Q)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_SaveLiveBirthWeight]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <01 Oct 2019>
-- =============================================
-- execute [Web_SaveLiveBirthWeight] 1,0,1,1,9,2019,'Cradles',7,2
CREATE PROCEDURE [dbo].[Win_SaveLiveBirthWeight]
	@RecId bigint,
	@ServiceId bigint,
	@CompanyId bigint,
	@StateId bigint,
	--@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@CDay nvarchar(100),
	@CVal int,
	@CreatedBy bigint,
	@Htype int
	
AS
BEGIN

	DECLARE @COMID AS BIGINT
	SELECT @COMID=CompanyId FROM dbo.UserMaster WHERE RecId =@CreatedBy
	DECLARE @MACHINE AS NVARCHAR(120)
	SELECT @MACHINE=HOST_NAME()
	DECLARE @Q AS NVARCHAR(Max)
	IF (@RecId > 0)
	/*BEGIN
	   SELECT @Q=N'Update [dbo].[HospitalBeds] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE SrNo ='+ convert(nvarchar(10),@RecId) +'and CompanyId='+convert(nvarchar(10),@COMID) 
	END*/
	-- AND CD.StateId=@StateId 
	IF EXISTS(SELECT 1 FROM DBO.LiveBirthWeight AS CD WHERE CD.RefSrNo =@RecId AND CD.CYear =@CYear AND CD.CMonth =@CMonth AND CD.CompanyId=@COMID AND CD.Htype = @Htype)
	BEGIN
	SELECT @Q=N'Update [dbo].[LiveBirthWeight] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE RefSrNo =' + convert(nvarchar(10),@RecId) + ' AND CYear = ' + convert(nvarchar(10),@CYear) + ' AND CMonth = ' + convert(nvarchar(10),@CMonth) + ' AND StateId=' + convert(nvarchar(10),@StateId) + ' AND CompanyId=' + convert(nvarchar(10),@COMID) + 'AND Htype=' + CONVERT(nvarchar(10),@Htype)
	END
	ELSE
	BEGIN
	   SELECT @Q=N'INSERT INTO [dbo].[LiveBirthWeight]([RefSrNo],[ServiceId],[CompanyId],[StateId],[CMonth],[CYear],['+ @CDay +'],[CreatedBy],[Machine],[Htype])VALUES ('+ convert(nvarchar(10),@RecId) +','+ convert(nvarchar(10),@ServiceId) +','+ convert(nvarchar(10),@CompanyId) +','+ convert(nvarchar(10),@StateId) + ',' + convert(nvarchar(10),@CMonth) +','+ convert(nvarchar(10),@CYear) + ',' + convert(nvarchar(10),@CVal) + ',' + convert(nvarchar(10),@CreatedBy) + ',''' + @MACHINE + ''',' + CONVERT(nvarchar(10),@Htype) +')'	
	END
	EXECUTE(@Q)
	--PRINT(@Q)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_SaveMaternalHealth]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <01 Oct 2019>
-- =============================================
-- execute [Web_SaveMaternalHealth] 1,0,1,1,10,2019,'M60',7,2
CREATE PROCEDURE [dbo].[Win_SaveMaternalHealth]
	@RecId bigint,
	@ServiceId bigint,
	@CompanyId bigint,
	@StateId bigint,
	--@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@CDay nvarchar(100),
	@CVal int,
	@CreatedBy bigint,
	@Htype int
	
AS
BEGIN

	DECLARE @COMID AS BIGINT
	SELECT @COMID=CompanyId FROM dbo.UserMaster WHERE RecId =@CreatedBy
	DECLARE @MACHINE AS NVARCHAR(120)
	SELECT @MACHINE=HOST_NAME()
	DECLARE @Q AS NVARCHAR(Max)
	IF (@RecId > 0)
	/*BEGIN
	   SELECT @Q=N'Update [dbo].[HospitalBeds] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE SrNo ='+ convert(nvarchar(10),@RecId) +'and CompanyId='+convert(nvarchar(10),@COMID) 
	END*/
	--AND CD.StateId=@StateId 
	IF EXISTS(SELECT 1 FROM DBO.MaternalHealth AS CD WHERE CD.RefSrNo =@RecId AND CD.CYear =@CYear AND CD.CMonth =@CMonth AND CD.CompanyId=@COMID AND CD.Htype = @Htype)
	BEGIN
	--+ ' AND StateId=' + convert(nvarchar(10),@StateId) 
	SELECT @Q=N'Update [dbo].[MaternalHealth] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE RefSrNo =' + convert(nvarchar(10),@RecId) + ' AND CYear = ' + convert(nvarchar(10),@CYear) + ' AND CMonth = ' + convert(nvarchar(10),@CMonth) + ' AND CompanyId=' + convert(nvarchar(10),@COMID) + ' AND Htype=' + CONVERT(nvarchar(10),@Htype)
	END
	ELSE
	BEGIN
	   SELECT @Q=N'INSERT INTO [dbo].[MaternalHealth]([RefSrNo],[ServiceId],[CompanyId],[StateId],[CMonth],[CYear],['+ @CDay +'],[CreatedBy],[Machine],[Htype])VALUES ('+ convert(nvarchar(10),@RecId) +','+ convert(nvarchar(10),@ServiceId) +','+ convert(nvarchar(10),@CompanyId) +','+ convert(nvarchar(10),@StateId) + ',' + convert(nvarchar(10),@CMonth) +','+ convert(nvarchar(10),@CYear) + ',' + convert(nvarchar(10),@CVal) + ',' + convert(nvarchar(10),@CreatedBy) + ',''' + @MACHINE + ''',' + CONVERT(nvarchar(10),@Htype)+ ')'	
	END
	EXECUTE(@Q)
	--PRINT(@Q)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_SavePatientAdmitOutcomes]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Jaydip Joshi>
-- Create date: <12 Oct 2019>
-- =============================================
-- execute [Win_SavePatientAdmitOutcomes] 1,0,1,1,9,2019,'Cradles',7,2,151
CREATE PROCEDURE [dbo].[Win_SavePatientAdmitOutcomes]
	@RecId bigint,
	@ServiceId bigint,
	@CompanyId bigint,
	@StateId bigint,
	--@Machine nvarchar(120),
	@CMonth int,
	@CYear int,
	@CDay nvarchar(100),
	@CVal int,
	@CreatedBy bigint,
	@Htype int
AS
BEGIN

	DECLARE @COMID AS BIGINT
	SELECT @COMID=CompanyId FROM dbo.UserMaster WHERE RecId =@CreatedBy
	DECLARE @MACHINE AS NVARCHAR(120)
	SELECT @MACHINE=HOST_NAME()
	DECLARE @Q AS NVARCHAR(Max)
	IF (@RecId > 0)
	IF EXISTS(SELECT 1 FROM DBO.IPDOutcome AS CD WHERE CD.RefSrNo =@RecId AND CD.CYear =@CYear AND CD.CMonth =@CMonth --AND CD.StateId=@StateId 
	AND CD.CompanyId=@COMID AND CD.Htype = @Htype)
		BEGIN
			SELECT @Q=N'Update [dbo].[IPDOutcome] SET '+ @CDay +' ='+ convert(nvarchar(10),@CVal) +' WHERE RefSrNo =' + convert(nvarchar(10),@RecId) + ' AND CYear = ' + convert(nvarchar(10),@CYear) + ' AND CMonth = ' + convert(nvarchar(10),@CMonth) + ' AND StateId=' + convert(nvarchar(10),@StateId) + ' AND CompanyId=' + convert(nvarchar(10),@COMID) + ' AND Htype=' + convert(nvarchar(10),@Htype)
		END
	ELSE
		BEGIN
			SELECT @Q=N'INSERT INTO [dbo].[IPDOutcome]([RefSrNo],[ServiceId],[CompanyId],[StateId],[CMonth],[CYear],['+ @CDay +'],[CreatedBy],[Machine],[Htype])VALUES ('+ convert(nvarchar(10),@RecId) +','+ convert(nvarchar(10),@ServiceId) +','+ convert(nvarchar(10),@CompanyId) +','+ convert(nvarchar(10),@StateId) + ',' + convert(nvarchar(10),@CMonth) +','+ convert(nvarchar(10),@CYear) + ',' + convert(nvarchar(10),@CVal) + ',' + convert(nvarchar(10),@CreatedBy) + ',''' + @MACHINE + ''',' + convert(nvarchar(10),@Htype) + ')'	
		END
	EXECUTE(@Q)
	--PRINT(@Q)
END
GO
/****** Object:  StoredProcedure [dbo].[Win_SavePermissionMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <14 Aug 2019>
-- =============================================
-- Execute Win_SavePermissionMaster
CREATE PROCEDURE [dbo].[Win_SavePermissionMaster]
@RecId bigint output,
@MenuId bigint,
@TypeId bigint,
@IsActive int,
@CreatedBy bigint
AS
BEGIN
	IF NOT EXISTS(SELECT 1 FROM dbo.PermissionMaster WHERE RecId = @RecId AND TypeId = @TypeId)
		BEGIN
			INSERT INTO [dbo].[PermissionMaster]
					   ([MenuId]
					   ,[TypeId]
					   ,[IsActive]
					   ,[CreatedBy]
					   ,[CreateDate])
				 VALUES
					   (@MenuId
					   ,@TypeId
					   ,@IsActive
					   ,@CreatedBy
					   ,GETDATE())
			SELECT @RecId = SCOPE_IDENTITY()
		END
	ELSE
		BEGIN
			UPDATE [dbo].[PermissionMaster]
			   SET [IsActive] = @IsActive
			 WHERE RecId = @RecId AND TypeId = @TypeId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Win_SaveServicesMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Win_SaveServicesMaster
CREATE PROCEDURE [dbo].[Win_SaveServicesMaster]
@RecId bigint output,
@ParentId bigint,
@ServiceName nvarchar(100),
@Description nvarchar(500),
@IsActive int,
@CreatedBy bigint
AS
BEGIN
	IF(@RecId = 0)
		BEGIN
			DECLARE @MaxSortOrd AS INT
			SELECT @MaxSortOrd = ISNULL(MAX(SortOrd),0) + 1 FROM dbo.ServicesMaster
			
			INSERT INTO [dbo].[ServicesMaster]
					   ([ParentId]
					   ,[ServiceName]
					   ,[Description]
					   ,[SortOrd]
					   ,[IsActive]
					   ,[CreatedBy]
					   ,[CreateDate])
				 VALUES
					   (@ParentId
					   ,@ServiceName
					   ,@Description
					   ,@MaxSortOrd
					   ,@IsActive
					   ,@CreatedBy
					   ,GETDATE())
			SELECT @RecId = SCOPE_IDENTITY()
		END
	ELSE
		BEGIN
			UPDATE [dbo].[ServicesMaster]
			   SET [ParentId] = @ParentId
				  ,[ServiceName] = @ServiceName
				  ,[Description] = @Description
			 WHERE [RecId] = @RecId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Win_SaveStateMaster]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Win_SaveStateMaster
CREATE PROCEDURE [dbo].[Win_SaveStateMaster]
@RecId bigint output,
@StateName nvarchar(200),
@Description nvarchar(500),
@IsActive int,
@CreatedBy bigint
AS
BEGIN
	IF(@RecId = 0)
		BEGIN
			INSERT INTO [dbo].[StateMaster]
					   ([StateName]
					   ,[Description]
					   ,[IsActive]
					   ,[CreatedBy]
					   ,[CreateDate])
				 VALUES
					   (@StateName
					   ,@Description
					   ,@IsActive
					   ,@CreatedBy
					   ,GETDATE())
			SELECT @RecId = SCOPE_IDENTITY()
		END
	ELSE
		BEGIN
			UPDATE [dbo].[StateMaster]
			   SET [StateName] = @StateName
				  ,[Description] = @Description
			 WHERE [RecId] = @RecId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Win_SaveUser]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik Joshi>
-- Create date: <02 July 2019>
-- =============================================
-- Execute Win_SaveUser
CREATE PROCEDURE [dbo].[Win_SaveUser]
@RecId bigint output,
@UserId nvarchar(50),
@PWD nvarchar(50),
@UserName nvarchar(100),
@DOB datetime,
@Gender int,
@EmailId nvarchar(50),
@Contact nvarchar(50),
@Address nvarchar(500),
@City nvarchar(50),
@State nvarchar(50),
@ZipCode nvarchar(10),
@ProfilePic nvarchar(100),
@UserType int,
@IsActive int,
@CreatedBy bigint,
@CompanyId int
AS
BEGIN

	SELECT TOP 1 @State =State FROM DBO.CompanyMaster WHERE RecId=@CompanyId 
	
	IF(@RecId = 0)
		BEGIN
			INSERT INTO [dbo].[UserMaster]
					   ([UserId]
					   ,[PWD]
					   ,[UserName]
					   ,[DOB]
					   ,[Gender]
					   ,[EmailId]
					   ,[Contact]
					   ,[Address]
					   ,[City]
					   ,[State]
					   ,[ZipCode]
					   ,[ProfilePic]
					   ,[UserType]
					   ,[IsActive]
					   ,[CompanyId]
					   ,[CreatedBy]
					   ,[CreateDate])
				 VALUES
					   (@UserId
					   ,@PWD
					   ,@UserName
					   ,@DOB
					   ,@Gender
					   ,@EmailId
					   ,@Contact
					   ,@Address
					   ,@City
					   ,@State
					   ,@ZipCode
					   ,@ProfilePic
					   ,@UserType
					   ,@IsActive
					   ,(case when @UserType=1 or @UserType=3 then -1 else @CompanyId end)
					   ,@CreatedBy
					   ,GETDATE())
			SELECT @RecId = SCOPE_IDENTITY()	   
		END
	ELSE
		BEGIN
			UPDATE [dbo].[UserMaster]
			   SET [UserId] = @UserId
				  ,[PWD] = @PWD
				  ,[UserName] = @UserName
				  ,[DOB] = @DOB
				  ,[Gender] = @Gender
				  ,[EmailId] = @EmailId
				  ,[Contact] = @Contact
				  ,[Address] = @Address
				  ,[City] = @City
				  ,[State] = @State
				  ,[ZipCode] = @ZipCode
				  ,[ProfilePic] = @ProfilePic
				  ,[UserType] = @UserType
				  ,[CompanyId]=(case when @UserType=1 or @UserType=3 then -1 else @CompanyId end)
			 WHERE [RecId] = @RecId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Win_UpdateHospitalIsActive]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Win_UpdateHospitalIsActive 26
CREATE PROCEDURE [dbo].[Win_UpdateHospitalIsActive]
	@RecId bigint
AS
BEGIN
	DECLARE @IsActive int
	SELECT @IsActive = IsActive FROM CompanyMaster WHERE RecId = @RecId
	SELECT @IsActive
	IF(@IsActive = 0)
		BEGIN
			UPDATE dbo.CompanyMaster
			SET IsActive = 1
			WHERE RecId = @RecId
		END
	IF(@IsActive = 1)
		BEGIN
			UPDATE dbo.CompanyMaster
			SET IsActive = 0
			WHERE RecId = @RecId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Win_UpdateServicesIsActive]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Win_UpdateServicesIsActive 26
CREATE PROCEDURE [dbo].[Win_UpdateServicesIsActive]
	@RecId bigint
AS
BEGIN
	DECLARE @IsActive int
	SELECT @IsActive = IsActive FROM ServicesMaster WHERE RecId = @RecId
	SELECT @IsActive
	IF(@IsActive = 0)
		BEGIN
			UPDATE dbo.ServicesMaster
			SET IsActive = 1
			WHERE RecId = @RecId
		END
	IF(@IsActive = 1)
		BEGIN
			UPDATE dbo.ServicesMaster
			SET IsActive = 0
			WHERE RecId = @RecId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Win_UpdateStateIsActive]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Win_UpdateStateIsActive 26
CREATE PROCEDURE [dbo].[Win_UpdateStateIsActive]
	@RecId bigint
AS
BEGIN
	DECLARE @IsActive int
	SELECT @IsActive = IsActive FROM StateMaster WHERE RecId = @RecId
	SELECT @IsActive
	IF(@IsActive = 0)
		BEGIN
			UPDATE dbo.StateMaster
			SET IsActive = 1
			WHERE RecId = @RecId
		END
	IF(@IsActive = 1)
		BEGIN
			UPDATE dbo.StateMaster
			SET IsActive = 0
			WHERE RecId = @RecId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[Win_UpdateUserIsActive]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <06 July 2019>
-- =============================================
-- Execute Win_UpdateUserIsActive 26
CREATE PROCEDURE [dbo].[Win_UpdateUserIsActive]
	@RecId bigint
AS
BEGIN
	DECLARE @IsActive int
	SELECT @IsActive = IsActive FROM UserMaster WHERE RecId = @RecId
	SELECT @IsActive
	IF(@IsActive = 0)
		BEGIN
			UPDATE dbo.UserMaster
			SET IsActive = 1
			WHERE RecId = @RecId
		END
	IF(@IsActive = 1)
		BEGIN
			UPDATE dbo.UserMaster
			SET IsActive = 0
			WHERE RecId = @RecId
		END
END
GO
/****** Object:  StoredProcedure [dbo].[WS_GetCompany]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik>
-- Create date: <27 July 2019>
-- =============================================
-- Execute WS_GetCompany '8E436CD2-D412-49E3-BD0E-EDEC7B5651C3'
-- Execute WS_GetCompany 'F9B5FC7E-52CD-4663-A6B2-78D394DBF5F7'
CREATE PROCEDURE [dbo].[WS_GetCompany]
@CGuid AS Nvarchar(50)
AS
BEGIN
	SELECT C.RecId
		  ,C.CName
		  ,C.City
		  ,C.State
		  ,C.Contact
		  ,C.Email
		  ,C.CGuid
		  ,C.Logo
		  ,C.IsActive
		  ,C.CreatedBy
		  ,C.CreateDate
	FROM dbo.CompanyMaster AS C
	WHERE (C.CGuid = @CGuid)
	AND (C.IsActive = 1)
	AND (C.RecId IN (SELECT CompanyId FROM dbo.UserMaster WHERE IsActive = 1))
END
GO
/****** Object:  StoredProcedure [dbo].[WS_GetUser]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Rasik>
-- Create date: <27 July 2019>
-- =============================================
-- Execute WS_GetUser '8E436CD2-D412-49E3-BD0E-EDEC7B5651C3'
CREATE PROCEDURE [dbo].[WS_GetUser]
@CGuid AS Nvarchar(50)
AS
BEGIN
	SELECT U.RecId
		  ,U.UserId
		  ,U.PWD
		  ,U.UserName
		  ,U.DOB
		  ,U.Gender
		  ,U.EmailId
		  ,U.Contact
		  ,U.Address
		  ,U.City
		  ,U.State
		  ,U.ZipCode
		  ,U.ProfilePic
		  ,U.UserType
		  ,U.CompanyId
		  ,U.IsActive
		  ,U.RecId AS CreatedBy
		  ,U.CreateDate
	FROM dbo.UserMaster AS U
	INNER JOIN dbo.CompanyMaster AS C
	ON U.CompanyId = C.RecId
	WHERE C.CGuid = @CGuid
END
GO
/****** Object:  StoredProcedure [dbo].[WS_SaveCaseDetail]    Script Date: 04/02/2021 10:27:37 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
-- =============================================
-- Author:		<Ashish>
-- Create date: <27 July 2019>
-- =============================================
-- Execute WS_SaveCaseDetail
CREATE PROCEDURE [dbo].[WS_SaveCaseDetail]
@XMLData ntext
AS
BEGIN
	DECLARE @hDoc INT
	DECLARE @Trans_Name VARCHAR(10)
	SET @Trans_Name = 'XMLOrder'
	
	EXEC sp_xml_preparedocument @hDoc OUTPUT, @XMLData
	
	IF EXISTS(SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'#CaseDetailRecs') )
		DROP TABLE #CaseDetailRecs
		
	CREATE TABLE #CaseDetailRecs
	(
		RefRecId bigint,
		RefMachine nvarchar(120)
	)
	
	INSERT INTO #CaseDetailRecs
	(
		RefRecId
	   ,RefMachine
	)
	SELECT
		  RecId AS RefRecId
		 ,Machine AS RefMachine
	FROM OPENXML(@hdoc, '/Data/CaseDetail',2)
	WITH
	(
		RecId bigint
	   ,Machine nvarchar(120)
	) CaseDetailRecord
	
	BEGIN TRANSACTION @Trans_Name
	
	DELETE FROM dbo.CaseDetail
	WHERE EXISTS(SELECT * FROM #CaseDetailRecs WHERE dbo.CaseDetail.RefRecId = #CaseDetailRecs.RefRecId AND dbo.CaseDetail.Machine = #CaseDetailRecs.RefMachine)
	
	INSERT INTO [dbo].[CaseDetail]
			   ([ServiceId]
			   ,[HType]
			   ,[CaseType]
			   ,[Gender]
			   ,[CMonth]
			   ,[CYear]
			   ,[StateId]
			   ,[Date1]
			   ,[Date2]
			   ,[Date3]
			   ,[Date4]
			   ,[Date5]
			   ,[Date6]
			   ,[Date7]
			   ,[Date8]
			   ,[Date9]
			   ,[Date10]
			   ,[Date11]
			   ,[Date12]
			   ,[Date13]
			   ,[Date14]
			   ,[Date15]
			   ,[Date16]
			   ,[Date17]
			   ,[Date18]
			   ,[Date19]
			   ,[Date20]
			   ,[Date21]
			   ,[Date22]
			   ,[Date23]
			   ,[Date24]
			   ,[Date25]
			   ,[Date26]
			   ,[Date27]
			   ,[Date28]
			   ,[Date29]
			   ,[Date30]
			   ,[Date31]
			   ,[CreatedBy]
			   ,[CreateDate]
			   ,[CompanyId]
			   ,[Machine]
			   ,[RefRecId])
		 SELECT
			    ServiceId
			   ,HType
			   ,CaseType
			   ,Gender
			   ,CMonth
			   ,CYear
			   ,StateId
			   ,Date1
			   ,Date2
			   ,Date3
			   ,Date4
			   ,Date5
			   ,Date6
			   ,Date7
			   ,Date8
			   ,Date9
			   ,Date10
			   ,Date11
			   ,Date12
			   ,Date13
			   ,Date14
			   ,Date15
			   ,Date16
			   ,Date17
			   ,Date18
			   ,Date19
			   ,Date20
			   ,Date21
			   ,Date22
			   ,Date23
			   ,Date24
			   ,Date25
			   ,Date26
			   ,Date27
			   ,Date28
			   ,Date29
			   ,Date30
			   ,Date31
			   ,CreatedBy
			   ,CreateDate
			   ,CompanyId
			   ,Machine
			   ,RecId AS RefRecId
	FROM OPENXML(@hdoc, '/Data/CaseDetail',2)
	WITH
	(
		ServiceId bigint
	   ,HType int
	   ,CaseType int
	   ,Gender int
	   ,CMonth int
	   ,CYear int
	   ,StateId bigint
	   ,Date1 int
	   ,Date2 int
	   ,Date3 int
	   ,Date4 int
	   ,Date5 int
	   ,Date6 int
	   ,Date7 int
	   ,Date8 int
	   ,Date9 int
	   ,Date10 int
	   ,Date11 int
	   ,Date12 int
	   ,Date13 int
	   ,Date14 int
	   ,Date15 int
	   ,Date16 int
	   ,Date17 int
	   ,Date18 int
	   ,Date19 int
	   ,Date20 int
	   ,Date21 int
	   ,Date22 int
	   ,Date23 int
	   ,Date24 int
	   ,Date25 int
	   ,Date26 int
	   ,Date27 int
	   ,Date28 int
	   ,Date29 int
	   ,Date30 int
	   ,Date31 int
	   ,CreatedBy bigint
	   ,CreateDate datetime
	   ,CompanyId bigint
	   ,Machine nvarchar(120)
	   ,RecId bigint
	) CaseDetailTable
	INNER JOIN #CaseDetailRecs
	ON CaseDetailTable.RecId = #CaseDetailRecs.RefRecId
	
	COMMIT TRANSACTION XMLOrder
	
	SELECT CD.RefRecId AS RecId
	FROM dbo.CaseDetail AS CD
	INNER JOIN #CaseDetailRecs AS CDR
	ON CD.RefRecId = CDR.RefRecId AND CD.Machine = CDR.RefMachine

	DROP TABLE #CaseDetailRecs

	EXEC sp_xml_removedocument @hDoc
END
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPane1', @value=N'[0E232FF0-B466-11cf-A24F-00AA00A3EFFF, 1.00]
Begin DesignProperties = 
   Begin PaneConfigurations = 
      Begin PaneConfiguration = 0
         NumPanes = 4
         Configuration = "(H (1[40] 4[20] 2[20] 3) )"
      End
      Begin PaneConfiguration = 1
         NumPanes = 3
         Configuration = "(H (1 [50] 4 [25] 3))"
      End
      Begin PaneConfiguration = 2
         NumPanes = 3
         Configuration = "(H (1 [50] 2 [25] 3))"
      End
      Begin PaneConfiguration = 3
         NumPanes = 3
         Configuration = "(H (4 [30] 2 [40] 3))"
      End
      Begin PaneConfiguration = 4
         NumPanes = 2
         Configuration = "(H (1 [56] 3))"
      End
      Begin PaneConfiguration = 5
         NumPanes = 2
         Configuration = "(H (2 [66] 3))"
      End
      Begin PaneConfiguration = 6
         NumPanes = 2
         Configuration = "(H (4 [50] 3))"
      End
      Begin PaneConfiguration = 7
         NumPanes = 1
         Configuration = "(V (3))"
      End
      Begin PaneConfiguration = 8
         NumPanes = 3
         Configuration = "(H (1[56] 4[18] 2) )"
      End
      Begin PaneConfiguration = 9
         NumPanes = 2
         Configuration = "(H (1 [75] 4))"
      End
      Begin PaneConfiguration = 10
         NumPanes = 2
         Configuration = "(H (1[66] 2) )"
      End
      Begin PaneConfiguration = 11
         NumPanes = 2
         Configuration = "(H (4 [60] 2))"
      End
      Begin PaneConfiguration = 12
         NumPanes = 1
         Configuration = "(H (1) )"
      End
      Begin PaneConfiguration = 13
         NumPanes = 1
         Configuration = "(V (4))"
      End
      Begin PaneConfiguration = 14
         NumPanes = 1
         Configuration = "(V (2))"
      End
      ActivePaneConfig = 0
   End
   Begin DiagramPane = 
      Begin Origin = 
         Top = 0
         Left = 0
      End
      Begin Tables = 
      End
   End
   Begin SQLPane = 
   End
   Begin DataPane = 
      Begin ParameterDefaults = ""
      End
   End
   Begin CriteriaPane = 
      Begin ColumnWidths = 11
         Column = 1440
         Alias = 900
         Table = 1170
         Output = 720
         Append = 1400
         NewValue = 1170
         SortType = 1350
         SortOrder = 1410
         GroupBy = 1350
         Filter = 1350
         Or = 1350
         Or = 1350
         Or = 1350
      End
   End
End
' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'CaseDetailDateWise'
GO
EXEC sys.sp_addextendedproperty @name=N'MS_DiagramPaneCount', @value=1 , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'VIEW',@level1name=N'CaseDetailDateWise'
GO
